{"version":3,"sources":["uni-app:///main.js","webpack:///D:/代码/小程序/新欣火1/pages/admin-teacher-schedule/admin-teacher-schedule.vue?6458","webpack:///D:/代码/小程序/新欣火1/pages/admin-teacher-schedule/admin-teacher-schedule.vue?fbb9","webpack:///D:/代码/小程序/新欣火1/pages/admin-teacher-schedule/admin-teacher-schedule.vue?7896","webpack:///D:/代码/小程序/新欣火1/pages/admin-teacher-schedule/admin-teacher-schedule.vue?15f7","uni-app:///pages/admin-teacher-schedule/admin-teacher-schedule.vue","webpack:///D:/代码/小程序/新欣火1/pages/admin-teacher-schedule/admin-teacher-schedule.vue?7e48","webpack:///D:/代码/小程序/新欣火1/pages/admin-teacher-schedule/admin-teacher-schedule.vue?4d0e"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","allTeacherList","teacherIndex","searchKeyword","selectedTeacher","allCourses","isLoading","isImageClicked","periods","days","currentDate","now","isTeacher","isSelf","imageStartX","imageStartY","imageTranslateX","imageTranslateY","isImageDragging","showBubble","greetingText","computed","bubbleStyle","offsetX","offsetY","isBubbleBelow","currentWeek","currentMonth","filteredTeacherList","teacher","userInfo","featureList","hasSchedulePermission","coursesByDay","coursesData","start","end","console","name","date","start_period","end_period","start_time","end_time","startTimeIndex","endTimeIndex","actualDuration","top","height","startTime","endTime","dayIndex","style","course","location","class","teacher_name","type","remark","onLoad","_id","teacherName","onShow","methods","getMondayOfWeek","getDayOfWeek","generateWeekData","day","fullDate","getWeekRangeText","sunday","changeWeek","monday","returnToCurrentWeek","isToday","today","formatDate","initImagePosition","goBack","uni","url","fetchTeachers","uniCloud","action","params","role","res","username","nickname","title","icon","onTeacherChange","onSearchInput","onSearchFocus","onSearchBlur","searchTeachers","fetchWeekCourses","teacher_id","startDate","endDate","getCourseColor","isFutureCourse","courseDate","goToApplyChange","timeStr","courseId","courseName","time","className","toggleImage","canApplyChange","handleCourseClick","content","showCancel","cancelText","confirmText","success","saveSchedule","handleImageTouchStart","e","handleImageTouchMove","newX","newY","handleImageTouchEnd","goToScheduleArrange"],"mappings":";;;;;;;;;;;;;AAAA;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,6BAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+I;AAC/I;AAC0E;AACL;AACqC;;;AAG1G;AACgL;AAChL,gBAAgB,uLAAU;AAC1B,EAAE,4FAAM;AACR,EAAE,6GAAM;AACR,EAAE,sHAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,iHAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACxCA;AAAA;AAAA;AAAA;AAAorB,CAAgB,krBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;AC+IxsB;AAAA;AAAA;AAAA,eACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MAAA;MACAC;MACAC;MAAA;MACAC,UACA,QACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,QACA;MAAA;MACAC;MAAA;MACAC;QACA;QACAC;QACA;QACA;QACAA;QACA;MACA;MACAC;MAAA;MACAC;MAAA;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACA;MACA;MACA;MACA;;MAEA;MACA;MACA;;MAEA;MACA;MACA;;MAEA;MACA;MACA;QACAC;MACA;MACA;MACA;QACAA;MACA;MACA;MACA;QACAC;MACA;MACA;MACA;QACAA;MACA;;MAEA;IACA;IACAC;MACA;MACA;MACA;MACA;MAEA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MAAA;MACA;QACA;MACA;MACA;QAAA,OACAC;MAAA,EACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;MACA;;MAEA;MACA;QACA;MACA;;MAEA;MACA;IACA;IACAC;MAAA;MACA;MACA;QACAC;MACA;;MAEA;MACA;MACA;QACA;UAAAC;UAAAC;QAAA;QAAA;QACA;UAAAD;UAAAC;QAAA;QAAA;QACA;UAAAD;UAAAC;QAAA;QAAA;QACA;UAAAD;UAAAC;QAAA;QAAA;QACA;UAAAD;UAAAC;QAAA;QAAA;QACA;UAAAD;UAAAC;QAAA;MACA;;MAEA;MACAC;MACAA;MAEA;QACA;QACAA;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;QACA;;QAEA;QACA;UACAN;UACA;QACA;QAEA;QACA;;QAEA;UACA;UACA;UAEA;YACA;YACA;;YAEA;YACA;;YAEA;YACA;YACA;YACA;YACA;;YAEA;YACAA;cACAO;cACAC;cACAC;cACAC;cACAC;cACAC;cACAC;YACA;;YAEA;YACAb;cACAc;cACAP;cACAC;cACAC;cACAC;cACAC;cACAI;cACA5C;cACAyC;cACAC;YACA;YAEAhB,2DACAmB;cAAA;cACAf;cACAgB;cACAC;cACAH;cACAI;cACAC;cACAC;YAAA,GACA;UACA;QACA;MACA;;MACA;IACA;EACA;EACAC;IACA;IAEA;MACA;MACA;MACA;QACAC;QACAC;MACA;MACA;MACA;IACA;MACA;MACA;MACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;EACA;EACAC;IACA;IACA;EACA;EACAC;IACAC;MAAA;MACA;MACArD;MACA;MACA;MACAA;MACA;IACA;IACAsD;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;QACA;QACAC;QACA;QACA;UACA7B;UACAC;UACA6B;QACA;MACA;MACA/B;QAAA;MAAA;MACA;QACA;MACA;IACA;IACA;IACAgC;MACA;MACA;MACAC;MACA;IACA;IACA;IACAC;MACA;MACAC;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;MACA,qDACAC,wCACAA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MAAA;MACA;MACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;MACA;IACA;IACAC;MACA;MACA;MACA;QACA;QACAC;UAAAC;QAAA;MACA;QACAD;MACA;IACA;IACAE;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA;gBAAA;gBAAA;gBAAA,OAEAC;kBACA5C;kBACAtC;oBACAmF;oBACAC;sBACAC;oBACA;kBACA;gBACA;cAAA;gBARAC;gBASA;kBACA;oBAAA;sBACA1B;sBACA2B;sBACAC;sBACA3B;oBACA;kBAAA;;kBACA;oBACA;oBACA;oBACA;oBACA;kBACA;oBACA;kBACA;gBACA;kBACAkB;oBACAU;oBACAC;kBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEArD;gBACA0C;kBACAU;kBACAC;gBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACAC;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACA;IACAC;MACAxD;IACA;IACA;IACAyD;MACAzD;IACA;IACA;IACA0D;MAAA;MACA;QACA;QACA;MACA;;MAEA;MACA;QAAA,OACAlE;MAAA,EACA;;MAEA;MACA;QACA;QACA;QACA;UAAA,OACAA;QAAA,EACA;QACA;QACA;MACA;QACA;QACAkD;UACAU;UACAC;QACA;MACA;IACA;IACAM;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBACA;gBACA;gBAAA;gBAEA;gBACAxB;gBACAF;gBACAA;gBAAA;gBAAA,OACAY;kBACA5C;kBACAtC;oBACAmF;oBACAC;sBACAa;sBACAC;sBACAC;oBACA;kBACA;gBACA;cAAA;gBAVAb;gBAWA;kBACA;oBAAA,uCACAjC;sBACAO;oBAAA;kBAAA,CACA;;kBAEA;kBACAvB;kBACAA;oBAAA;kBAAA;kBAEA;gBACA;kBACA0C;oBACAU;oBACAC;kBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEArD;gBACA0C;kBACAU;kBACAC;gBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACAU;MACA;IACA;IACAC;MACA;MACA1B;MACA;MACA2B;MACA;IACA;IACAC;MACA;MACA;QACA;QACA;QACA;QACA;QAEA;QACA;MACA;MACA;MACA;QACAC;MACA;QACAA;MACA;MACA;QACAC;QACAC;QACAnE;QACAoE;QACArD;QACAsD;MACA;MACAvE;MACA0C;QACAC;MACA;IACA;IACA;IACA6B;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MAAA;MACA;MACAhC;QACAU;QACAuB,6FACA3D,oDACAA,gDACAA,4CACAA;QACA4D;MACA;;MAEA;MACA;QACAlC;UACAU;UACAuB;UACAC;UACAC;UACAC;UACAC;YACA;cACA;YACA;UACA;QACA;MACA;IACA;IACAC;MACAtC;QACAU;QACAC;MACA;IACA;IACA;IACA4B;MACA;MACA;MACA;MACA;MACA;MACAC;MACAA;IACA;IACA;IACAC;MACA;;MAEA;MACAD;MACAA;MAEA;MACA;;MAEA;MACA;MACA;;MAEA;MACA;MACA;;MAEA;MACA;MACA;MACA;;MAEA;MACA;;MAEA;MACAE;;MAEA;MACAC;;MAEA;MACA;MACA;;MAEA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACAJ;MACAA;IACA;IACAK;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA7C;QAAAC;MAAA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACrxBA;AAAA;AAAA;AAAA;AAAy/B,CAAgB,m9BAAG,EAAC,C;;;;;;;;;;;ACA7gC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/admin-teacher-schedule/admin-teacher-schedule.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/admin-teacher-schedule/admin-teacher-schedule.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./admin-teacher-schedule.vue?vue&type=template&id=18c29074&scoped=true&\"\nvar renderjs\nimport script from \"./admin-teacher-schedule.vue?vue&type=script&lang=js&\"\nexport * from \"./admin-teacher-schedule.vue?vue&type=script&lang=js&\"\nimport style0 from \"./admin-teacher-schedule.vue?vue&type=style&index=0&id=18c29074&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"18c29074\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/admin-teacher-schedule/admin-teacher-schedule.vue\"\nexport default component.exports","export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./admin-teacher-schedule.vue?vue&type=template&id=18c29074&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 = _vm.__map(_vm.days, function (day, dayIndex) {\n    var $orig = _vm.__get_orig(day)\n    var m0 = _vm.isToday(day.fullDate)\n    return {\n      $orig: $orig,\n      m0: m0,\n    }\n  })\n  var l2 = _vm.__map(_vm.days, function (day, dayIndex) {\n    var $orig = _vm.__get_orig(day)\n    var l1 = _vm.__map(_vm.coursesByDay[dayIndex], function (course, cIndex) {\n      var $orig = _vm.__get_orig(course)\n      var m1 = !_vm.isLoading ? _vm.canApplyChange(course, day.fullDate) : null\n      return {\n        $orig: $orig,\n        m1: m1,\n      }\n    })\n    return {\n      $orig: $orig,\n      l1: l1,\n    }\n  })\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0,\n        l2: l2,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./admin-teacher-schedule.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./admin-teacher-schedule.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"page-container\">\n\t\t<!-- <view style=\"font-size:32rpx;color:#1976D2;font-weight:bold;margin:40rpx 0 30rpx 0;text-align:center;\">这里是教师课程表页面</view> -->\n\t\t<!-- 状态栏, 用于适配刘海屏 -->\n\t\t<view class=\"status-bar\"></view>\n\t\t<!-- 顶部导航栏 -->\n\t\t<view class=\"top-bar\">\n\t\t\t<view class=\"top-nav\">\n\t\t\t\t<view class=\"back-btn\" @click=\"goBack\">\n\t\t\t\t\t<text class=\"back-icon\">‹</text>\n\t\t\t\t\t<text class=\"back-text\">返回</text>\n\t\t\t\t</view>\n\t\t\t\t<view v-if=\"!isSelf && !isTeacher\" class=\"teacher-selector\">\n\t\t\t\t\t<picker @change=\"onTeacherChange\" :value=\"teacherIndex\" :range=\"filteredTeacherList\" range-key=\"teacherName\">\n\t\t\t\t\t\t<view class=\"picker-display\">\n\t\t\t\t\t\t\t<text class=\"page-title\">{{ selectedTeacher ? selectedTeacher.teacherName : '选择教师' }}</text>\n\t\t\t\t\t\t\t<text class=\"dropdown-arrow-title\">▼</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</picker>\n\t\t\t\t</view>\n\t\t\t\t<view v-else class=\"teacher-selector\">\n\t\t\t\t\t<view class=\"picker-display\">\n\t\t\t\t\t\t<text class=\"page-title\">{{ selectedTeacher ? selectedTeacher.teacherName : '' }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<!-- 右上角搜索区域 -->\n\t\t\t\t<view class=\"search-container\">\n\t\t\t\t\t<view class=\"search-input-wrapper\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\tclass=\"search-input\" \n\t\t\t\t\t\t\tv-model=\"searchKeyword\" \n\t\t\t\t\t\t\tplaceholder=\"搜索教师姓名\"\n\t\t\t\t\t\t\t@input=\"onSearchInput\"\n\t\t\t\t\t\t\t@focus=\"onSearchFocus\"\n\t\t\t\t\t\t\t@blur=\"onSearchBlur\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<text class=\"search-icon\">🔍</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<!-- 周选择 -->\n\t\t\t<view class=\"week-selector-bar\">\n\t\t\t\t<button class=\"week-btn prev-btn\" @click=\"changeWeek(-1)\">\n\t\t\t\t\t<text class=\"week-btn-icon\">◀</text>\n\t\t\t\t\t<text class=\"week-btn-text\">上一周</text>\n\t\t\t\t</button>\n\t\t\t\t<button class=\"week-btn next-btn\" @click=\"changeWeek(1)\">\n\t\t\t\t\t<text class=\"week-btn-text\">下一周</text>\n\t\t\t\t\t<text class=\"week-btn-icon\">▶</text>\n\t\t\t\t</button>\n\t\t\t\t<button class=\"today-btn\" @click=\"returnToCurrentWeek\">今天</button>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 课程表容器 -->\n\t\t<view class=\"schedule-container\">\n\t\t\t<!-- 固定的头部行 -->\n\t\t\t<view class=\"fixed-header\">\n\t\t\t\t<!-- 月份单元格 -->\n\t\t\t\t<view class=\"month-cell\">{{ currentMonth }}月</view>\n\t\t\t\t<!-- 日期头部 -->\n\t\t\t\t<view class=\"day-header\" v-for=\"(day, dayIndex) in days\" :key=\"dayIndex\" :class=\"{ 'is-today': isToday(day.fullDate) }\">\n\t\t\t\t\t<view class=\"day-name\">{{ day.name }}</view>\n\t\t\t\t\t<view class=\"day-date\">{{ day.date }}</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 可滚动的内容区域 -->\n\t\t\t<view class=\"scrollable-content\">\n\t\t\t\t<!-- 时间和课程网格 -->\n\t\t\t\t<view class=\"schedule-grid\">\n\t\t\t\t\t<!-- 时间列 -->\n\t\t\t\t\t<view class=\"time-column\">\n\t\t\t\t\t\t<view v-for=\"(period, index) in periods\" :key=\"period\" class=\"time-slot\">\n\t\t\t\t\t\t\t{{ period }}\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<!-- 课程列 -->\n\t\t\t\t\t<view class=\"days-container\">\n\t\t\t\t\t\t<view class=\"day-column\" v-for=\"(day, dayIndex) in days\" :key=\"dayIndex\">\n\t\t\t\t\t\t\t<!-- 课程格子和课程块部分 -->\n\t\t\t\t\t\t\t<view class=\"course-slots-container\">\n\t\t\t\t\t\t\t\t<view class=\"course-placeholder\" v-for=\"(p, index) in periods\" :key=\"index\"></view>\n\t\t\t\t\t\t\t\t<view\n\t\t\t\t\t\t\t\t\tv-if=\"!isLoading\"\n\t\t\t\t\t\t\t\t\tv-for=\"(course, cIndex) in coursesByDay[dayIndex]\"\n\t\t\t\t\t\t\t\t\t:key=\"cIndex\"\n\t\t\t\t\t\t\t\t\t:style=\"course.style\"\n\t\t\t\t\t\t\t\t\tclass=\"course-block\"\n\t\t\t\t\t\t\t\t\t:class=\"{ 'can-apply': canApplyChange(course, day.fullDate) }\"\n\t\t\t\t\t\t\t\t\t@click=\"handleCourseClick(course, day.fullDate, dayIndex)\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<view>\n\t\t\t\t\t\t\t\t\t\t<span style=\"color:#333;\">\n\t\t\t\t\t\t\t\t\t\t\t{{ course.name }}-{{ course.teacher_name || selectedTeacher.teacherName || '' }}@{{ course.location || '' }}教室\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<view v-if=\"course.remark\" class=\"course-remark-show\">备注：{{ course.remark }}</view>\n\t\t\t\t\t\t\t\t\t\t<span style=\"display:block;font-size:13px;font-weight:500;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:2px;\">\n\t\t\t\t\t\t\t\t\t\t\t{{ course.course_type || course.type || '' }}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t<!-- 加载动画 -->\n\t\t<view v-if=\"isLoading\" class=\"loading-overlay\">\n\t\t\t<view class=\"loading-text\">课程加载中...</view>\n\t\t</view>\n\t\t\n\t\t<!-- 可点击图片 -->\n\t\t<image \n\t\t\t:src=\"isImageClicked ? '/static/机器1.gif' : '/static/机器.png'\" \n\t\t\tclass=\"clickable-image\" \n\t\t\t:style=\"{ transform: `translate(${imageTranslateX}px, ${imageTranslateY}px)` }\"\n\t\t\t@click=\"toggleImage\"\n\t\t\t@touchstart=\"handleImageTouchStart\"\n\t\t\t@touchmove=\"handleImageTouchMove\"\n\t\t\t@touchend=\"handleImageTouchEnd\"\n\t\t\tmode=\"aspectFit\"\n\t\t></image>\n\t\t<!-- 机器人对话气泡 -->\n\t\t<view v-if=\"showBubble\" class=\"assistant-bubble pretty\" :class=\"{ 'bubble-below': isBubbleBelow }\" :style=\"bubbleStyle\">\n\t\t\t<text class=\"bubble-text\">{{ greetingText }}</text>\n\t\t\t<view v-if=\"hasSchedulePermission\" style=\"margin-top: 12rpx;\">\n\t\t\t\t<text class=\"quick-action\" @click=\"goToScheduleArrange\">一键排课</text>\n\t\t\t</view>\n\t\t\t<view class=\"pretty-tail pretty-tail-1\"></view>\n\t\t\t<view class=\"pretty-tail pretty-tail-2\"></view>\n\t\t</view>\n\t\t<!-- 悬浮保存排课按钮 -->\n\t\t<!-- <button class=\"save-schedule-btn\" @click=\"saveSchedule\">�� 保存排课</button> -->\n\t\t<!-- 悬浮保存排课按钮，始终固定底部 -->\n\t\t<!-- <view class=\"bottom-btn-bar\">\n\t\t\t<button class=\"bottom-btn\" @click=\"saveSchedule\">保存排课</button>\n\t\t</view> -->\n\t</view>\n</template>\n\n<script>\n\timport { getCourseColor } from '../../utils/courseColor.js';\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tallTeacherList: [],\n\t\t\t\tteacherIndex: -1,\n\t\t\t\tsearchKeyword: '',\n\t\t\t\tselectedTeacher: null,\n\t\t\t\tallCourses: [], // 存储当周所有课程\n\t\t\t\tisLoading: true,\n\t\t\t\tisImageClicked: false, // 控制图片是否被点击\n\t\t\t\tperiods: [\n\t\t\t\t\t'8:00',   \n\t\t\t\t\t'10:00',  \n\t\t\t\t\t'10:10',  \n\t\t\t\t\t'12:10',  \n\t\t\t\t\t'14:00',  \n\t\t\t\t\t'16:00',  \n\t\t\t\t\t'16:10',  \n\t\t\t\t\t'18:10',  \n\t\t\t\t\t'18:00',  \n\t\t\t\t\t'20:00',  \n\t\t\t\t\t'20:00',\n\t\t\t\t\t'22:00'   \n\t\t\t\t], // 课表时间段\n\t\t\t\tdays: [], // 周一到周日\n\t\t\t\tcurrentDate: (function() {\n\t\t\t\t\tconst now = new Date();\n\t\t\t\t\tnow.setHours(0,0,0,0);\n\t\t\t\t\tlet dayOfWeek = now.getDay();\n\t\t\t\t\tlet day = dayOfWeek === 0 ? 6 : dayOfWeek - 1;\n\t\t\t\t\tnow.setDate(now.getDate() - day);\n\t\t\t\t\treturn now;\n\t\t\t\t})(),\n\t\t\t\tisTeacher: false, // 新增\n\t\t\t\tisSelf: false, // 新增\n\t\t\t\t// 图片拖动相关变量\n\t\t\t\timageStartX: 0,\n\t\t\t\timageStartY: 0,\n\t\t\t\timageTranslateX: 0,\n\t\t\t\timageTranslateY: 0,\n\t\t\t\tisImageDragging: false,\n\t\t\t\tshowBubble: false,\n\t\t\t\tgreetingText: ''\n\t\t\t};\n\t\t},\n\t\tcomputed: {\n\t\t\tbubbleStyle() {\n\t\t\t\t// 获取屏幕尺寸\n\t\t\t\tconst windowInfo = uni.getWindowInfo ? uni.getWindowInfo() : uni.getSystemInfoSync();\n\t\t\t\tconst windowWidth = windowInfo.windowWidth;\n\t\t\t\tconst windowHeight = windowInfo.windowHeight;\n\t\t\t\t\n\t\t\t\t// 气泡尺寸（估算）\n\t\t\t\tconst bubbleWidth = windowWidth * 0.68; // 68vw\n\t\t\t\tconst bubbleHeight = 120; // 估算高度\n\t\t\t\t\n\t\t\t\t// 计算气泡的理想位置（机器人正上方）\n\t\t\t\tlet offsetX = this.imageTranslateX - 20;\n\t\t\t\tlet offsetY = this.imageTranslateY - 120;\n\t\t\t\t\n\t\t\t\t// 边界检测和调整\n\t\t\t\t// 确保气泡不超出左边界\n\t\t\t\tif (offsetX < 10) {\n\t\t\t\t\toffsetX = 10;\n\t\t\t\t}\n\t\t\t\t// 确保气泡不超出右边界\n\t\t\t\tif (offsetX + bubbleWidth > windowWidth - 10) {\n\t\t\t\t\toffsetX = windowWidth - bubbleWidth - 10;\n\t\t\t\t}\n\t\t\t\t// 确保气泡不超出上边界\n\t\t\t\tif (offsetY < 10) {\n\t\t\t\t\toffsetY = 10;\n\t\t\t\t}\n\t\t\t\t// 确保气泡不超出下边界（如果机器人太靠上，气泡显示在机器人下方）\n\t\t\t\tif (offsetY + bubbleHeight > windowHeight - 10) {\n\t\t\t\t\toffsetY = this.imageTranslateY + 120; // 显示在机器人下方\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn `transform: translate(${offsetX}px, ${offsetY}px)`;\n\t\t\t},\n\t\t\tisBubbleBelow() {\n\t\t\t\t// 判断气泡是否显示在机器人下方\n\t\t\t\tconst windowInfo = uni.getWindowInfo ? uni.getWindowInfo() : uni.getSystemInfoSync();\n\t\t\t\tconst windowHeight = windowInfo.windowHeight;\n\t\t\t\tconst bubbleHeight = 120;\n\t\t\t\t\n\t\t\t\tlet idealY = this.imageTranslateY - 120;\n\t\t\t\treturn idealY + bubbleHeight > windowHeight - 10;\n\t\t\t},\n\t\t\tcurrentWeek() {\n\t\t\t\tconst startOfYear = new Date(this.currentDate.getFullYear(), 0, 1);\n\t\t\t\tconst pastDaysOfYear = (this.currentDate - startOfYear) / 86400000;\n\t\t\t\treturn Math.ceil((pastDaysOfYear + startOfYear.getDay() + 1) / 7);\n\t\t\t},\n\t\t\tcurrentMonth() {\n\t\t\t\t// 获取当前周的周一的月份\n\t\t\t\tconst monday = this.getMondayOfWeek(this.currentDate);\n\t\t\t\treturn monday.getMonth() + 1;\n\t\t\t},\n\t\t\tfilteredTeacherList() {\n\t\t\t\tif (!this.searchKeyword) {\n\t\t\t\t\treturn this.allTeacherList;\n\t\t\t\t}\n\t\t\t\treturn this.allTeacherList.filter(teacher =>\n\t\t\t\t\tteacher.teacherName && teacher.teacherName.toLowerCase().includes(this.searchKeyword.toLowerCase())\n\t\t\t\t);\n\t\t\t},\n\t\t\tuserInfo() {\n\t\t\t\treturn uni.getStorageSync('userInfo') || {};\n\t\t\t},\n\t\t\tfeatureList() {\n\t\t\t\treturn this.userInfo.featureList || [];\n\t\t\t},\n\t\t\thasSchedulePermission() {\n\t\t\t\t// 检查用户是否有\"教师排课\"权限\n\t\t\t\tconst userInfo = this.userInfo;\n\t\t\t\tconst featureList = this.featureList;\n\t\t\t\t\n\t\t\t\t// 超级管理员直接拥有所有权限\n\t\t\t\tif (userInfo.role === '超级管理员' || userInfo.permission === 'superadmin') {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 检查是否包含\"教师排课\"功能\n\t\t\t\treturn featureList.includes('schedule') || featureList.includes('教师排课');\n\t\t\t},\n\t\t\tcoursesByDay() {\n\t\t\t\tconst coursesData = {};\n\t\t\t\tfor (let i = 0; i < 7; i++) {\n\t\t\t\t\tcoursesData[i] = [];\n\t\t\t\t}\n\n\t\t\t\t// 定义每个课程节数对应的开始和结束时间索引\n\t\t\t\t// 格式：{课程节数: {start: 开始时间索引, end: 结束时间索引}}\n\t\t\t\tconst periodTimeMapping = {\n\t\t\t\t\t1: {start: 0, end: 1},   // 第1节课：8:00-10:00 (periods[0]到periods[1])\n\t\t\t\t\t2: {start: 2, end: 3},   // 第2节课：10:10-12:10 (periods[2]到periods[3])\n\t\t\t\t\t3: {start: 4, end: 5},   // 第3节课：14:00-16:00 (periods[4]到periods[5])\n\t\t\t\t\t4: {start: 6, end: 7},   // 第4节课：16:10-18:10 (periods[6]到periods[8])\n\t\t\t\t\t5: {start: 8, end: 9},   // 第5节课：18:00-20:00 (periods[7]到periods[9])\n\t\t\t\t\t6: {start: 10, end: 11}   // 第6节课：20:00-22:00 (periods[9]到periods[10])\n\t\t\t\t};\n\n\t\t\t\t// 调试：打印时间段数组和映射关系\n\t\t\t\tconsole.log('时间段数组:', this.periods);\n\t\t\t\tconsole.log('课程节数映射:', periodTimeMapping);\n\n\t\t\t\tthis.allCourses.forEach(course => {\n\t\t\t\t\t// 调试：打印每个课程的详细信息\n\t\t\t\t\tconsole.log('处理课程:', {\n\t\t\t\t\t\tname: course.course_name,\n\t\t\t\t\t\tdate: course.date,\n\t\t\t\t\t\tstart_period: course.start_period,\n\t\t\t\t\t\tend_period: course.end_period,\n\t\t\t\t\t\tstart_time: course.start_time,\n\t\t\t\t\t\tend_time: course.end_time\n\t\t\t\t\t});\n\n\t\t\t\t\t// 过滤掉无效的课程节数，防止显示第0节课\n\t\t\t\t\tif (course.start_period < 1 || course.start_period > 7 || course.end_period < 1 || course.end_period > 7) {\n\t\t\t\t\t\tconsole.warn('跳过无效的课程节数:', course);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst dayOfWeek = new Date(course.date).getDay();\n\t\t\t\t\tconst dayIndex = dayOfWeek === 0 ? 6 : dayOfWeek - 1; // 周一为0\n\n\t\t\t\t\tif (dayIndex >= 0 && dayIndex < 7) {\n\t\t\t\t\t\t// 获取课程开始和结束的时间索引\n\t\t\t\t\t\tconst periodMapping = periodTimeMapping[course.start_period];\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (periodMapping) {\n\t\t\t\t\t\t\tconst startTimeIndex = periodMapping.start;\n\t\t\t\t\t\t\tconst endTimeIndex = periodMapping.end;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 计算实际的课程时长（跨越的时间段数量）\n\t\t\t\t\t\t\tconst actualDuration = endTimeIndex - startTimeIndex + 1;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 计算每个时间段的像素高度\n\t\t\t\t\t\t\t// 每个时间段固定80px高度\n\t\t\t\t\t\t\tconst slotHeight = 80; // 每个单元格80px\n\t\t\t\t\t\t\tconst top = startTimeIndex * slotHeight;\n\t\t\t\t\t\t\tconst height = actualDuration * slotHeight;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 调试：打印高度计算详情\n\t\t\t\t\t\t\tconsole.log(`高度计算详情:`, {\n\t\t\t\t\t\t\t\tstartTimeIndex,\n\t\t\t\t\t\t\t\tendTimeIndex,\n\t\t\t\t\t\t\t\tactualDuration,\n\t\t\t\t\t\t\t\ttop: `${top}px`,\n\t\t\t\t\t\t\t\theight: `${height}px`,\n\t\t\t\t\t\t\t\tstartTime: this.periods[startTimeIndex],\n\t\t\t\t\t\t\t\tendTime: this.periods[endTimeIndex]\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t// 添加调试信息\n\t\t\t\t\t\t\tconsole.log(`课程 ${course.course_name} (第${course.start_period}节课) 显示在:`, {\n\t\t\t\t\t\t\t\tdayIndex,\n\t\t\t\t\t\t\t\tstartTimeIndex,\n\t\t\t\t\t\t\t\tendTimeIndex,\n\t\t\t\t\t\t\t\tactualDuration,\n\t\t\t\t\t\t\t\ttop: `${top}px`,\n\t\t\t\t\t\t\t\theight: `${height}px`,\n\t\t\t\t\t\t\t\tstyle: `top: ${top}px; height: ${height}px; ${getCourseColor(course.course_type, course.course_name)}`,\n\t\t\t\t\t\t\t\tperiods: this.periods,\n\t\t\t\t\t\t\t\tstartTime: this.periods[startTimeIndex],\n\t\t\t\t\t\t\t\tendTime: this.periods[endTimeIndex]\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tcoursesData[dayIndex].push({\n\t\t\t\t\t\t\t\t...course, // 展开原始对象，带上_id等所有字段\n\t\t\t\t\t\t\t\tname: course.course_name,\n\t\t\t\t\t\t\t\tlocation: course.location,\n\t\t\t\t\t\t\t\tclass: course.class_name,\n\t\t\t\t\t\t\t\tstyle: `top: ${top}px; height: ${height}px; ${getCourseColor(course.course_type, course.course_name)}`,\n\t\t\t\t\t\t\t\tteacher_name: course.teacher_name || this.selectedTeacher.teacherName || '',\n\t\t\t\t\t\t\t\ttype: course.course_type || course.type || '',\n\t\t\t\t\t\t\t\tremark: course.remark // 添加备注字段\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn coursesData;\n\t\t\t}\n\t\t},\n\t\t\tonLoad(options) {\n\t\t\tconst userInfo = uni.getStorageSync('userInfo') || {};\n\t\t\t\n\t\t\tif (options && options.isSelf === 'true') {\n\t\t\t\tthis.isSelf = true;\n\t\t\t\tthis.isTeacher = true;\n\t\t\t\tthis.selectedTeacher = {\n\t\t\t\t\t_id: userInfo._id,\n\t\t\t\t\tteacherName: userInfo.teacherName || userInfo.username\n\t\t\t\t};\n\t\t\t\tthis.currentDate = this.getMondayOfWeek(new Date());\n\t\t\t\tthis.generateWeekData();\n\t\t\t} else {\n\t\t\t\t// 统一放开，所有人都能查所有老师\n\t\t\t\tthis.isTeacher = false;\n\t\t\t\tthis.fetchTeachers();\n\t\t\t}\n\t\t\t// 初始化图片位置\n\t\t\tthis.initImagePosition();\n\t\t\t// 生成问候语\n\t\t\tconst name = userInfo.realName || userInfo.teacherName || userInfo.nickname || userInfo.username || '';\n\t\t\tconst first = name ? name.charAt(0) : '';\n\t\t\tthis.greetingText = `你好，${first}老师，我是你的智能小助手小言。请问我有什么可以帮助你的？`;\n\t\t},\n\t\tonShow() {\n\t\t\t// 页面显示时重新初始化图片位置\n\t\t\tthis.initImagePosition();\n\t\t},\n\t\tmethods: {\n\t\t\tgetMondayOfWeek(date = this.currentDate) {\n\t\t\t\tconst now = new Date(date);\n\t\t\t\tnow.setHours(0,0,0,0);\n\t\t\t\tlet dayOfWeek = now.getDay();\n\t\t\t\tlet day = dayOfWeek === 0 ? 6 : dayOfWeek - 1;\n\t\t\t\tnow.setDate(now.getDate() - day);\n\t\t\t\treturn now;\n\t\t\t},\n\t\t\tgetDayOfWeek(dateStr) {\n\t\t\t\tconst dayNames = ['周一', '周二', '周三', '周四', '周五', '周六', '周日'];\n\t\t\t\tconst date = new Date(dateStr);\n\t\t\t\tlet day = date.getDay();\n\t\t\t\treturn dayNames[day === 0 ? 6 : day - 1];\n\t\t\t},\n\t\t\tgenerateWeekData() {\n\t\t\t\tconst monday = this.getMondayOfWeek(this.currentDate);\n\t\t\t\tthis.days = [];\n\t\t\t\tfor (let i = 0; i < 7; i++) {\n\t\t\t\t\tconst day = new Date(monday);\n\t\t\t\t\tday.setDate(monday.getDate() + i);\n\t\t\t\t\tconst fullDate = this.formatDate(day);\n\t\t\t\t\tthis.days.push({\n\t\t\t\t\t\tname: this.getDayOfWeek(fullDate),\n\t\t\t\t\t\tdate: day.getDate(),\n\t\t\t\t\t\tfullDate: fullDate\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tconsole.log('days:', this.days.map(d => d.fullDate + ' ' + d.name));\n\t\t\t\tif (this.selectedTeacher) {\n\t\t\t\t\tthis.fetchWeekCourses();\n\t\t\t\t}\n\t\t\t},\n\t\t\t// 周区间文本（本周一~本周日）\n\t\t\tgetWeekRangeText() {\n\t\t\t\tconst monday = this.getMondayOfWeek();\n\t\t\t\tconst sunday = new Date(monday);\n\t\t\t\tsunday.setDate(monday.getDate() + 6);\n\t\t\t\treturn `${this.formatDate(monday)} ~ ${this.formatDate(sunday)}`;\n\t\t\t},\n\t\t\t// 上一周/下一周切换\n\t\t\tchangeWeek(offset) {\n\t\t\t\tconst monday = this.getMondayOfWeek(this.currentDate);\n\t\t\t\tmonday.setDate(monday.getDate() + offset * 7);\n\t\t\t\tthis.currentDate = this.getMondayOfWeek(monday); // 强制为新周一\n\t\t\t\tthis.generateWeekData();\n\t\t\t},\n\t\t\t// 回到本周\n\t\t\treturnToCurrentWeek() {\n\t\t\t\tthis.currentDate = this.getMondayOfWeek(new Date());\n\t\t\t\tthis.generateWeekData();\n\t\t\t},\n\t\t\tisToday(dateString) {\n\t\t\t\tconst today = new Date();\n\t\t\t\tconst date = new Date(dateString);\n\t\t\t\treturn today.getFullYear() === date.getFullYear() &&\n\t\t\t\t\ttoday.getMonth() === date.getMonth() &&\n\t\t\t\t\ttoday.getDate() === date.getDate();\n\t\t\t},\n\t\t\tformatDate(date) {\n\t\t\t\tconst year = date.getFullYear();\n\t\t\t\tconst month = ('0' + (date.getMonth() + 1)).slice(-2);\n\t\t\t\tconst day = ('0' + date.getDate()).slice(-2);\n\t\t\t\treturn `${year}-${month}-${day}`;\n\t\t\t},\n\t\t\t// 初始化图片位置\n\t\t\tinitImagePosition() {\n\t\t\t\t// 使用 nextTick 确保 DOM 已经渲染\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t// 获取页面可视区域尺寸\n\t\t\t\t\tconst windowInfo = uni.getWindowInfo ? uni.getWindowInfo() : uni.getSystemInfoSync();\n\t\t\t\t\tconst windowWidth = windowInfo.windowWidth;\n\t\t\t\t\tconst windowHeight = windowInfo.windowHeight;\n\t\t\t\t\t\n\t\t\t\t\t// 图片尺寸（220rpx = 110px）\n\t\t\t\t\tconst imageSize = 110;\n\t\t\t\t\t\n\t\t\t\t\t// 计算图片在右下角时的translate值\n\t\t\t\t\t// 右下角位置：left = windowWidth - imageSize - 10, top = windowHeight - imageSize - 10\n\t\t\t\t\t// 10px = 20rpx\n\t\t\t\t\tthis.imageTranslateX = windowWidth - imageSize - 10;\n\t\t\t\t\tthis.imageTranslateY = windowHeight - imageSize - 10;\n\t\t\t\t});\n\t\t\t},\n\t\t\tgoBack() {\n\t\t\t\t// 判断是否为tabBar入口\n\t\t\t\tconst pages = getCurrentPages();\n\t\t\t\tif (pages.length === 1) {\n\t\t\t\t\t// 只有一个页面，说明是tabBar入口，跳转首页\n\t\t\t\t\tuni.switchTab({ url: '/pages/home/home' });\n\t\t\t\t} else {\n\t\t\t\t\tuni.navigateBack();\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync fetchTeachers() {\n\t\t\t\tthis.isLoading = true;\n\t\t\t\ttry {\n\t\t\t\t\tconst res = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'user-center',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'getAllUsersByRole',\n\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\trole: 'teacher'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (res.result && res.result.data) {\n\t\t\t\t\tthis.allTeacherList = res.result.data.map(t => ({\n\t\t\t\t\t\t_id: t._id,\n\t\t\t\t\t\tusername: t.username,\n\t\t\t\t\t\tnickname: t.nickname,\n\t\t\t\t\t\tteacherName: t.nickname || t.teacherName || t.username // 使用 nickname 作为教师名字, 如果没有则使用 username\n\t\t\t\t\t}));\n\t\t\t\t\t\tif (this.allTeacherList.length > 0) {\n\t\t\t\t\t\t\tthis.teacherIndex = 0;\n\t\t\t\t\t\t\tthis.selectedTeacher = this.filteredTeacherList[0];\n\t\t\t\t\t\t\tthis.currentDate = this.getMondayOfWeek(new Date());\n\t\t\t\t\t\t\tthis.generateWeekData();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: (res.result && res.result.errMsg) || '获取教师列表失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(\"获取教师列表失败\", e);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '教师加载失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t}\n\t\t\t},\n\t\t\tonTeacherChange(e) {\n\t\t\t\tthis.teacherIndex = e.detail.value;\n\t\t\t\tthis.selectedTeacher = this.filteredTeacherList[this.teacherIndex];\n\t\t\t\tthis.currentDate = this.getMondayOfWeek(new Date());\n\t\t\t\tthis.generateWeekData(); // 切换教师时回到本周\n\t\t\t},\n\t\t\t// 搜索输入处理\n\t\t\tonSearchInput(e) {\n\t\t\t\tthis.searchKeyword = e.detail.value;\n\t\t\t\t// 实时搜索教师\n\t\t\t\tthis.searchTeachers();\n\t\t\t},\n\t\t\t// 搜索框获得焦点\n\t\t\tonSearchFocus() {\n\t\t\t\tconsole.log('搜索框获得焦点');\n\t\t\t},\n\t\t\t// 搜索框失去焦点\n\t\t\tonSearchBlur() {\n\t\t\t\tconsole.log('搜索框失去焦点');\n\t\t\t},\n\t\t\t// 搜索教师\n\t\t\tsearchTeachers() {\n\t\t\t\tif (!this.searchKeyword.trim()) {\n\t\t\t\t\t// 如果搜索关键词为空，不进行任何操作\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 根据关键词过滤教师列表\n\t\t\t\tconst filteredTeachers = this.allTeacherList.filter(teacher => \n\t\t\t\t\tteacher.teacherName && teacher.teacherName.toLowerCase().includes(this.searchKeyword.toLowerCase())\n\t\t\t\t);\n\t\t\t\t\n\t\t\t\t// 如果找到匹配的教师，自动选择第一个并显示课程\n\t\t\t\tif (filteredTeachers.length > 0) {\n\t\t\t\t\tthis.selectedTeacher = filteredTeachers[0];\n\t\t\t\t\t// 更新教师选择器的索引\n\t\t\t\t\tthis.teacherIndex = this.allTeacherList.findIndex(teacher => \n\t\t\t\t\t\tteacher._id === filteredTeachers[0]._id\n\t\t\t\t\t);\n\t\t\t\t\tthis.currentDate = this.getMondayOfWeek(new Date());\n\t\t\t\t\tthis.generateWeekData();\n\t\t\t\t} else {\n\t\t\t\t\t// 没有找到匹配的教师，显示提示\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '未找到匹配的教师',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync fetchWeekCourses() {\n\t\t\t\tif (!this.selectedTeacher) return;\n\t\t\t\tthis.isLoading = true;\n\t\t\t\tthis.allCourses = [];\n\t\t\t\ttry {\n\t\t\t\t\t// 以本周一为起点\n\t\t\t\t\tconst monday = this.getMondayOfWeek(this.currentDate);\n\t\t\t\t\tconst sunday = new Date(monday);\n\t\t\t\t\tsunday.setDate(monday.getDate() + 6);\n\t\t\t\t\tconst res = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'schedule-center',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'getSchedulesByTeacher',\n\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\tteacher_id: this.selectedTeacher._id,\n\t\t\t\t\t\t\t\tstartDate: this.formatDate(monday),\n\t\t\t\t\t\t\t\tendDate: this.formatDate(sunday)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (res.result && res.result.data) {\n\t\t\t\t\t\tthis.allCourses = res.result.data.map(course => ({\n\t\t\t\t\t\t\t...course,\n\t\t\t\t\t\t\t_id: course._id\n\t\t\t\t\t\t}));\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 添加调试信息\n\t\t\t\t\t\tconsole.log('加载的课程数据:', this.allCourses);\n\t\t\t\t\t\tconsole.log('第4节课数据:', this.allCourses.filter(c => c.start_period === 4));\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: (res.result && res.result.errMsg) || '获取课程失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('获取课程失败', e);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '课程加载失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetCourseColor(type, className) {\n\t\t\t\treturn getCourseColor(type, className);\n\t\t\t},\n\t\t\tisFutureCourse(dateString) {\n\t\t\t\tconst today = new Date();\n\t\t\t\ttoday.setHours(0, 0, 0, 0); // 设置为当天0点\n\t\t\t\tconst courseDate = new Date(dateString);\n\t\t\t\tcourseDate.setHours(0, 0, 0, 0); // 设置为课程日期0点\n\t\t\t\treturn courseDate >= today;\n\t\t\t},\n\t\t\tgoToApplyChange(course, date) {\n\t\t\t\t// slot 对应时间段映射\n\t\t\t\tconst slotToTime = {\n\t\t\t\t\t1: '8:00-10:00',\n\t\t\t\t\t2: '10:10-12:10',\n\t\t\t\t\t3: '14:00-16:00',\n\t\t\t\t\t4: '16:10-18:10',\n\t\t\t\t\t\n\t\t\t\t\t5: '18:00-20:00',\n\t\t\t\t\t6: '20:00-22:00'\n\t\t\t\t};\n\t\t\t\tlet timeStr = '';\n\t\t\t\tif (course.start_period) {\n\t\t\t\t\ttimeStr = slotToTime[course.start_period] || course.start_time || course.time || course.originalTime || '8:00';\n\t\t\t\t} else {\n\t\t\t\t\ttimeStr = course.start_time || course.time || course.originalTime || '8:00';\n\t\t\t\t}\n\t\t\t\tconst courseInfo = {\n\t\t\t\t\tcourseId: course._id,\n\t\t\t\t\tcourseName: course.name,\n\t\t\t\t\tdate: date,\n\t\t\t\t\ttime: timeStr,\n\t\t\t\t\tlocation: course.location,\n\t\t\t\t\tclassName: course.class\n\t\t\t\t};\n\t\t\t\tconsole.log('goToApplyChange 传递 courseId', course._id, 'time:', timeStr);\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '/pages/apply-change-course/apply-change-course?courseInfo=' + encodeURIComponent(JSON.stringify(courseInfo))\n\t\t\t\t});\n\t\t\t},\n\t\t\t// 切换图片/显示气泡\n\t\t\ttoggleImage() {\n\t\t\t\tthis.isImageClicked = !this.isImageClicked;\n\t\t\t\tthis.showBubble = !this.showBubble;\n\t\t\t},\n\t\t\t// 判断课程是否可调课\n\t\t\tcanApplyChange(course, date) {\n\t\t\t\tconst now = new Date();\n\t\t\t\tconst courseDate = new Date(date);\n\t\t\t\t// 新增：必须大于今天+5天\n\t\t\t\tconst minDate = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 6); // 今天+6天\n\t\t\t\tif (courseDate < minDate) return false;\n\t\t\t\t// 课程日期晚于今天+5天，可以调课\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\thandleCourseClick(course, date, dayIndex) {\n\t\t\t\t// 所有课程都可以查看详情\n\t\t\t\tuni.showModal({\n\t\t\t\t\ttitle: '课程详情',\n\t\t\t\t\tcontent: `课程名称：${course.name}\n教师：${course.teacher_name}\n教室：${course.location}\n类型：${course.type}\n备注：${course.remark || ''}`,\n\t\t\t\t\tshowCancel: false\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// 周五到周日的课程还可以调课（如果是本人查看自己的课表且满足调课条件）\n\t\t\t\tif (dayIndex >= 4 && this.isSelf && this.canApplyChange(course, date)) {\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: '操作选择',\n\t\t\t\t\t\tcontent: '您要查看课程详情还是申请调课？',\n\t\t\t\t\t\tshowCancel: true,\n\t\t\t\t\t\tcancelText: '查看详情',\n\t\t\t\t\t\tconfirmText: '申请调课',\n\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\t\tthis.goToApplyChange(course, date);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tsaveSchedule() {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '排课保存成功!',\n\t\t\t\t\ticon: 'success'\n\t\t\t\t});\n\t\t\t},\n\t\t\t// 图片拖动开始\n\t\t\thandleImageTouchStart(e) {\n\t\t\t\t// 保存触摸起始点\n\t\t\t\tthis.imageStartX = e.touches[0].clientX;\n\t\t\t\tthis.imageStartY = e.touches[0].clientY;\n\t\t\t\tthis.isImageDragging = true;\n\t\t\t\t// 阻止页面滚动\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t},\n\t\t\t// 图片拖动中\n\t\t\thandleImageTouchMove(e) {\n\t\t\t\tif (!this.isImageDragging) return;\n\t\t\t\t\n\t\t\t\t// 阻止页面滚动\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\t\n\t\t\t\tconst touchX = e.touches[0].clientX;\n\t\t\t\tconst touchY = e.touches[0].clientY;\n\t\t\t\t\n\t\t\t\t// 计算移动距离\n\t\t\t\tconst deltaX = touchX - this.imageStartX;\n\t\t\t\tconst deltaY = touchY - this.imageStartY;\n\t\t\t\t\n\t\t\t\t// 计算新的位置（当前图片位置 + 移动距离）\n\t\t\t\tlet newX = this.imageTranslateX + deltaX;\n\t\t\t\tlet newY = this.imageTranslateY + deltaY;\n\t\t\t\t\n\t\t\t\t// 获取页面可视区域尺寸（使用新的API）\n\t\t\t\tconst windowInfo = uni.getWindowInfo ? uni.getWindowInfo() : uni.getSystemInfoSync();\n\t\t\t\tconst windowWidth = windowInfo.windowWidth;\n\t\t\t\tconst windowHeight = windowInfo.windowHeight;\n\t\t\t\t\n\t\t\t\t// 图片尺寸（220rpx = 110px）\n\t\t\t\tconst imageSize = 110;\n\t\t\t\t\n\t\t\t\t// 限制X轴移动范围（左边距0，右边距不超出页面）\n\t\t\t\tnewX = Math.max(0, Math.min(newX, windowWidth - imageSize));\n\t\t\t\t\n\t\t\t\t// 限制Y轴移动范围（上边距0，下边距不超出页面）\n\t\t\t\tnewY = Math.max(0, Math.min(newY, windowHeight - imageSize));\n\t\t\t\t\n\t\t\t\t// 更新图片位置（通过数据驱动）\n\t\t\t\tthis.imageTranslateX = newX;\n\t\t\t\tthis.imageTranslateY = newY;\n\t\t\t\t\n\t\t\t\t// 更新起始点，以便连续移动\n\t\t\t\tthis.imageStartX = touchX;\n\t\t\t\tthis.imageStartY = touchY;\n\t\t\t},\n\t\t\t// 图片拖动结束\n\t\t\thandleImageTouchEnd(e) {\n\t\t\t\tthis.isImageDragging = false;\n\t\t\t\t// 保持图片在当前位置，不自动回去\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t},\n\t\t\tgoToScheduleArrange() {\n\t\t\t\t// 跳转到排课页面，并传递当前教师与日期，便于在排课页直接加载一致数据\n\t\t\t\tconst teacher = this.selectedTeacher || {};\n\t\t\t\tconst userInfo = uni.getStorageSync('userInfo') || {};\n\t\t\t\tconst uid = teacher._id || userInfo._id || '';\n\t\t\t\t// 这里必须传真实 username，服务端用 username/uid 查询\n\t\t\t\tconst username = teacher.username || userInfo.username || '';\n\t\t\t\tconst date = this.formatDate(new Date(), 'yyyy-MM-dd');\n\t\t\t\tconst query = `uid=${encodeURIComponent(uid)}&username=${encodeURIComponent(username)}&date=${encodeURIComponent(date)}`;\n\t\t\t\tuni.navigateTo({ url: `/pages/schedule-manage/schedule-manage?${query}` });\n\t\t\t}\n\t\t}\n\t};\n</script>\n\n<style scoped>\n\t/* 基本样式重置和页面容器 */\n\t.schedule-page-container {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\theight: 100vh;\n\t\tbackground-color: #f8f9fa;\n\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n\t}\n\n\t.status-bar {\n\t\theight: var(--status-bar-height);\n\t\twidth: 100%;\n\t\tbackground-color: #FFFFFF;\n\t}\n\n\t/* 顶部区域 */\n\t.top-bar {\n\t\tbackground-color: #6B55D3;\n\t\tcolor: white;\n\t\tflex-shrink: 0;\n\t}\n\n\t.top-nav {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: space-between;\n\t\tpadding: 10px 15px;\n\t\tbackground-color: #FFFFFF;\n\t\tcolor: #000;\n\t}\n\n\t.back-btn {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t\tpadding: 8px 12px;\n\t\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n\t\tborder-radius: 20px;\n\t\tcolor: white;\n\t\tfont-size: 14px;\n\t\tbox-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n\t\ttransition: all 0.3s ease;\n\t}\n\n\t.back-btn:active {\n\t\ttransform: translateY(1px);\n\t\tbox-shadow: 0 1px 4px rgba(102, 126, 234, 0.3);\n\t}\n\n\t.back-icon {\n\t\tfont-size: 18px;\n\t\tfont-weight: bold;\n\t}\n\n\t.back-text {\n\t\tfont-size: 14px;\n\t\tfont-weight: 500;\n\t}\n\n\t.teacher-selector {\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t}\n\n\t.picker-display {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tgap: 8px;\n\t}\n\n\t.page-title {\n\t\tfont-size: 18px;\n\t\tfont-weight: bold;\n\t\tcolor: #333;\n\t}\n\n\t.dropdown-arrow-title {\n\t\tfont-size: 14px;\n\t\tmargin-left: 8px;\n\t}\n\n\t/* 搜索区域样式 */\n\t.search-container {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 10px;\n\t\tflex-shrink: 0;\n\t}\n\n\t.teacher-name-display {\n\t\tbackground-color: #f5f5f5;\n\t\tpadding: 6px 12px;\n\t\tborder-radius: 15px;\n\t\tborder: 1px solid #e0e0e0;\n\t\tmin-width: 80px;\n\t\ttext-align: center;\n\t}\n\n\t.teacher-name-text {\n\t\tfont-size: 14px;\n\t\tcolor: #666;\n\t\tfont-weight: 500;\n\t}\n\n\t.search-input-wrapper {\n\t\tposition: relative;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\n\t.search-input {\n\t\twidth: 120px;\n\t\theight: 32px;\n\t\tpadding: 0 30px 0 12px;\n\t\tborder: 1px solid #e0e0e0;\n\t\tborder-radius: 16px;\n\t\tfont-size: 14px;\n\t\tbackground-color: #f9f9f9;\n\t\ttransition: all 0.3s ease;\n\t}\n\n\t.search-input:focus {\n\t\tborder-color: #667eea;\n\t\tbackground-color: #fff;\n\t\tbox-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n\t}\n\n\t.search-icon {\n\t\tposition: absolute;\n\t\tright: 8px;\n\t\tfont-size: 14px;\n\t\tcolor: #999;\n\t\tpointer-events: none;\n\t}\n\n\t/* 周选择器 */\n\t.week-selector-bar {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tpadding: 12px 15px;\n\t\tgap: 20px;\n\t}\n\n\t.week-btn {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 25px;\n\t\tpadding: 12px 20px;\n\t\tfont-size: 14px;\n\t\tfont-weight: 500;\n\t\tbox-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n\t\ttransition: all 0.2s ease-in-out;\n\t\tjustify-content: center;\n\t}\n\n\t.week-btn:active {\n\t\ttransform: translateY(2px);\n\t\tbox-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\n\t}\n\n\t.prev-btn {\n\t\tbackground: #6D6AEC;\n\t}\n\n\t.next-btn {\n\t\tbackground: linear-gradient(135deg, #F87D9A 0%, #F5576C 100%);\n\t}\n\n\t.week-btn-icon {\n\t\tfont-size: 12px;\n\t\tfont-weight: bold;\n\t}\n\n\t.week-btn-text {\n\t\tfont-size: 14px;\n\t\tfont-weight: 500;\n\t}\n\n\t.today-btn {\n\t\tbackground: linear-gradient(135deg, #44E5FC 0%, #00D7FF 100%);\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 50%;\n\t\tfont-size: 16px;\n\t\tfont-weight: 500;\n\t\tbox-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n\t\ttransition: all 0.2s ease-in-out;\n\t\twidth: 60px;\n\t\theight: 60px;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tpadding: 0;\n\t}\n\n\t.today-btn:active {\n\t\ttransform: translateY(2px);\n\t\tbox-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\n\t}\n\n\t/* 课程表容器 */\n\t.schedule-container {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tflex-grow: 1;\n\t\tmin-height: 0;\n\t\theight: 100%;\n\t}\n\n\t/* 固定的头部行 */\n\t.fixed-header {\n\t\tdisplay: flex;\n\t\tflex-shrink: 0;\n\t\tbackground-color: #fff;\n\t\tborder-bottom: 1px solid #EAEAEA;\n\t\tz-index: 10;\n\t}\n\n\t/* 可滚动的内容区域 */\n\t.scrollable-content {\n\t\tflex: 1;\n\t\tmin-height: 0;\n\t\toverflow-y: auto;\n\t}\n\n\t/* 课程表网格 */\n\t.schedule-grid {\n\t\tdisplay: flex;\n\t\theight: 100%;\n\t}\n\n\t/* 时间和月份列 */\n\t.time-column {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\twidth: 40px;\n\t\tflex-shrink: 0;\n\t\tbackground-color: #fff;\n\t\theight: 100%;\n\t\tborder-right: 1px solid #EAEAEA; /* 添加右边框，与日期列分隔 */\n\t\tjustify-content: flex-start; /* 确保从顶部开始排列 */\n\t}\n\n\t.month-cell {\n\t\theight: 50px;\n\t\tline-height: 50px;\n\t\tfont-size: 16px;\n\t\tcolor: #333;\n\t\tbackground-color: #6B55D3;\n\t\tcolor: white;\n\t\tbox-sizing: border-box;\n\t\tflex-shrink: 0; /* 防止压缩 */\n\t\ttext-align: center;\n\t\twidth: 40px;\n\t}\n\n\t/* 固定头部中的月份单元格 */\n\t.fixed-header .month-cell {\n\t\twidth: 40px;\n\t\tflex-shrink: 0;\n\t}\n\n\t/* 固定头部中的日期头部 */\n\t.fixed-header .day-header {\n\t\tflex: 1;\n\t\ttext-align: center;\n\t\tpadding: 8px 0;\n\t\tfont-size: 14px;\n\t\theight: 50px;\n\t\tbox-sizing: border-box;\n\t\tbackground-color: #6B55D3;\n\t\tcolor: white;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tborder-left: 1px solid #EAEAEA;\n\t}\n\n\t.fixed-header .day-header:first-child {\n\t\tborder-left: none;\n\t}\n\n\t.fixed-header .day-header.is-today {\n\t\tbackground-color: #18B5A5;\n\t}\n\n\t.time-slot {\n\t\tflex: 1 1 0%;\n\t\tdisplay: flex;\n\t\talign-items: center; /* 改为居中对齐，让时间标签显示在单元格中央 */\n\t\tjustify-content: center;\n\t\tborder-top: 1px solid #EAEAEA;\n\t\tbox-sizing: border-box;\n\t\theight: 80px; /* 固定每个时间段的高度，避免表格过高 */\n\t\tpadding: 0; /* 移除顶部内边距，让时间标签完全居中 */\n\t\tposition: relative; /* 添加相对定位，确保子元素定位正确 */\n\t\tmin-height: 80px; /* 确保最小高度，与课程列保持一致 */\n\t\tmax-height: 80px; /* 确保最大高度，与课程列保持一致 */\n\t}\n\n\t.days-container {\n\t\tdisplay: flex;\n\t\tflex-grow: 1;\n\t\theight: 100%;\n\t}\n\n\t/* 星期列 */\n\t.day-column {\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tborder-left: 1px solid #EAEAEA;\n\t\theight: 100%;\n\t\tmin-width: 0; /* 确保列可以正确收缩 */\n\t}\n\t.day-column:first-child {\n\t\tborder-left: none;\n\t}\n\n\t.day-name {\n\t\tfont-size: 15px;\n\t}\n\n\t.day-date {\n\t\tfont-size: 12px;\n\t}\n\n\t.course-slots-container {\n\t\tposition: relative;\n\t\theight: 100%;\n\t\tflex-grow: 1;\n\t\tmin-height: 0;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: flex-start; /* 确保从顶部开始排列，与时间列保持一致 */\n\t}\n\n\t.course-placeholder {\n\t\tflex: 1 1 0%;\n\t\tborder-top: 1px solid #EAEAEA;\n\t\tborder-right: 1px solid #EAEAEA; /* 添加垂直分割线 */\n\t\tbox-sizing: border-box;\n\t\tbackground: transparent;\n\t\theight: 80px; /* 固定每个时间段的高度，与时间列保持一致 */\n\t\tposition: relative; /* 添加相对定位，确保课程块定位正确 */\n\t\tmin-height: 80px; /* 确保最小高度，与时间列保持一致 */\n\t\tmax-height: 80px; /* 确保最大高度，与时间列保持一致 */\n\t}\n\n\t/* 最后一列不需要右边框 */\n\t.day-column:last-child .course-placeholder {\n\t\tborder-right: none;\n\t}\n\n\t/* 课程块 */\n\t.course-block {\n\t\tposition: absolute;\n\t\tleft: 1px; /* 减少左边距，确保不超出单元格 */\n\t\tright: 1px; /* 减少右边距，确保不超出单元格 */\n\t\tmargin: 0;\n\t\tpadding: 4px; /* 减少内边距，确保内容不超出 */\n\t\tborder-radius: 4px; /* 减少圆角，与减少的内边距匹配 */\n\t\tfont-size: 12px;\n\t\toverflow: hidden;\n\t\ttext-align: center;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tbox-sizing: border-box;\n\t\tfont-weight: bold;\n\t\tbox-shadow: 0 2px 8px rgba(0,0,0,0.1);\n\t\tmin-height: 0; /* 移除固定最小高度，让课程块完全根据计算的高度显示 */\n\t\tborder: 1px solid rgba(0,0,0,0.15); /* 减少边框厚度，避免超出 */\n\t\tbackground: rgba(255,255,255,0.95); /* 半透明背景 */\n\t\tz-index: 5; /* 确保课程块在网格之上 */\n\t\t/* 移除默认的top值，让课程块根据计算的位置显示 */\n\t}\n\n\n\n\t/* 调课申请按钮 */\n\t.change-course-btn {\n\t\tbackground-color: #ff9800;\n\t\tcolor: white;\n\t\tfont-size: 10px;\n\t\tpadding: 2px 6px;\n\t\tborder-radius: 10px;\n\t\tmargin-top: 4px;\n\t\tcursor: pointer;\n\t\ttransition: background-color 0.3s;\n\t}\n\n\t.change-course-btn:hover {\n\t\tbackground-color: #f57c00;\n\t}\n\n\t/* 加载状态 */\n\t.loading-overlay {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground-color: rgba(255, 255, 255, 0.8);\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tz-index: 10;\n\t}\n\n\t.loading-text {\n\t\tfont-size: 16px;\n\t\tcolor: #6B55D3;\n\t}\n\n\t/* 悬浮保存排课按钮样式 */\n\t.save-schedule-btn {\n\t\tposition: fixed;\n\t\tleft: 0;\n\t\tbottom: 0;\n\t\twidth: 100vw;\n\t\theight: 60px;\n\t\tbackground: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);\n\t\tcolor: #fff;\n\t\tfont-size: 18px;\n\t\tz-index: 9999;\n\t\tborder-radius: 0;\n\t\tborder: none;\n\t\tmargin: 0;\n\t\tbox-shadow: 0 -2px 8px rgba(0,0,0,0.08);\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t/* 预留底部空间，避免内容被按钮遮挡 */\n\t.page-container {\n\t\theight: 100vh;\n\t\tmin-height: 100vh;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tpadding-bottom: 0 !important;\n\t\tmargin-bottom: 0 !important;\n\t\tbox-sizing: border-box;\n\t}\n\n\t/* 页面容器高度拉满 */\n\tpage, .uni-page-body, .uni-app-view, .uni-page {\n\t\theight: 100vh;\n\t\tmin-height: 100vh;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\n\t.schedule-grid {\n\t\tflex: 1;\n\t\tmin-height: 0;\n\t\theight: 100%;\n\t\tdisplay: flex;\n\t\tpadding-bottom: 0 !important;\n\t\tmargin-bottom: 0 !important;\n\t\tbox-sizing: border-box;\n\t}\n\n\t/* 整体滚动条样式 */\n\t.scrollable-content::-webkit-scrollbar {\n\t\twidth: 8px;\n\t}\n\n\t.scrollable-content::-webkit-scrollbar-track {\n\t\tbackground: #f1f1f1;\n\t\tborder-radius: 4px;\n\t}\n\n\t.scrollable-content::-webkit-scrollbar-thumb {\n\t\tbackground: #c1c1c1;\n\t\tborder-radius: 4px;\n\t}\n\n\t.scrollable-content::-webkit-scrollbar-thumb:hover {\n\t\tbackground: #a8a8a8;\n\t}\n\n\t/* 删除底部保存排课按钮样式和结构 */\n\t/* .bottom-btn-bar, .bottom-btn { display: none !important; } */\n\t.course-remark-show {\n\t\tcolor: #333;\n\t\tfont-size: 11px;\n\t\tmargin: 2px 0 0 0;\n\t\tline-height: 1.4;\n\t\tword-break: break-all;\n\t}\n\t\n\t/* 可点击图片样式 */\n\t.clickable-image {\n\t\tposition: fixed;\n\t\tleft: 0;\n\t\ttop: 0;\n\t\twidth: 220rpx;\n\t\theight: 220rpx;\n\t\tz-index: 999;\n\t\tcursor: pointer;\n\t\ttransform: translate(0, 0);\n\t\t-webkit-user-select: none;\n\t\t-moz-user-select: none;\n\t\t-ms-user-select: none;\n\t\tuser-select: none;\n\t\t-webkit-touch-callout: none;\n\t\t-webkit-tap-highlight-color: transparent;\n\t}\n\n\t/* 机器人对话气泡样式 */\n\t.assistant-bubble {\n\t\tposition: fixed;\n\t\tleft: 0;\n\t\ttop: 0;\n\t\tmax-width: 68vw;\n\t\tbackground: linear-gradient(135deg,#ffffff 0%,#f6fbff 100%);\n\t\tborder: 1rpx solid #e0f0ff;\n\t\tbox-shadow: 0 10rpx 26rpx rgba(25,118,210,0.08);\n\t\tborder-radius: 22rpx;\n\t\tpadding: 22rpx 26rpx;\n\t\tz-index: 1000;\n\t\tcolor: #333;\n\t\tfont-size: 28rpx;\n\t\tline-height: 1.6;\n\t\ttransform: translate(0,0);\n\t}\n\n\t/* 新的卡通圆角对话框样式（非长方） */\n\t.assistant-bubble.pretty {\n\t\tborder-radius: 26rpx 26rpx 10rpx 26rpx; /* 左下角收尖，气泡在机器人上方 */\n\t}\n\t.pretty-tail {\n\t\tposition: absolute;\n\t\tbottom: -8rpx;\n\t\tleft: 36rpx;\n\t\twidth: 18rpx; height: 18rpx;\n\t\tbackground: #ffffff;\n\t\tborder-right: 1rpx solid #e0f0ff;\n\t\tborder-bottom: 1rpx solid #e0f0ff;\n\t\ttransform: rotate(45deg);\n\t\tbox-shadow: 2rpx 2rpx 6rpx rgba(25,118,210,0.06);\n\t}\n\t.pretty-tail-2 {\n\t\tbottom: -14rpx;\n\t\tleft: 22rpx;\n\t\twidth: 12rpx; height: 12rpx;\n\t\topacity: 0.8;\n\t}\n\n\t/* 气泡在机器人下方时的样式 */\n\t.assistant-bubble.bubble-below {\n\t\tborder-radius: 10rpx 26rpx 26rpx 26rpx; /* 左上角收尖，气泡在机器人下方 */\n\t}\n\t.assistant-bubble.bubble-below .pretty-tail {\n\t\ttop: -8rpx;\n\t\tbottom: auto;\n\t\tleft: 36rpx;\n\t\twidth: 18rpx; height: 18rpx;\n\t\tbackground: #ffffff;\n\t\tborder-right: 1rpx solid #e0f0ff;\n\t\tborder-top: 1rpx solid #e0f0ff;\n\t\tborder-bottom: none;\n\t\ttransform: rotate(-45deg);\n\t\tbox-shadow: 2rpx -2rpx 6rpx rgba(25,118,210,0.06);\n\t}\n\t.assistant-bubble.bubble-below .pretty-tail-2 {\n\t\ttop: -14rpx;\n\t\tbottom: auto;\n\t\tleft: 22rpx;\n\t\twidth: 12rpx; height: 12rpx;\n\t\topacity: 0.8;\n\t}\n\n\t.bubble-text {\n\t\tdisplay: block;\n\t\tz-index: 1;\n\t}\n\n\t.quick-action {\n\t\tcolor: #1976D2;\n\t\tfont-weight: 600;\n\t\tfont-size: 28rpx;\n\t\tline-height: 1.6;\n\t}\n</style>\n\n","import mod from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./admin-teacher-schedule.vue?vue&type=style&index=0&id=18c29074&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./admin-teacher-schedule.vue?vue&type=style&index=0&id=18c29074&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1759362723428\n      var cssReload = require(\"D:/hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}