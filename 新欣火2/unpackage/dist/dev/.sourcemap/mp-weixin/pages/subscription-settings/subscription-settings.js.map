{"version":3,"sources":["uni-app:///main.js","webpack:///D:/ä»£ç /å°ç¨‹åº/æ–°æ¬£ç«1/pages/subscription-settings/subscription-settings.vue?0528","webpack:///D:/ä»£ç /å°ç¨‹åº/æ–°æ¬£ç«1/pages/subscription-settings/subscription-settings.vue?4b9b","webpack:///D:/ä»£ç /å°ç¨‹åº/æ–°æ¬£ç«1/pages/subscription-settings/subscription-settings.vue?4362","webpack:///D:/ä»£ç /å°ç¨‹åº/æ–°æ¬£ç«1/pages/subscription-settings/subscription-settings.vue?0303","uni-app:///pages/subscription-settings/subscription-settings.vue","webpack:///D:/ä»£ç /å°ç¨‹åº/æ–°æ¬£ç«1/pages/subscription-settings/subscription-settings.vue?24de","webpack:///D:/ä»£ç /å°ç¨‹åº/æ–°æ¬£ç«1/pages/subscription-settings/subscription-settings.vue?48f6"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","isSubscribed","isSubscribing","hasOpenid","isBinding","isTesting","templateId","onMounted","console","onShow","methods","goBack","uni","checkUserStatus","localStatus","openid","onSubscriptionToggle","isOn","enableSubscription","tmplIds","authResult","status","lastUpdate","cacheExpiry","uniCloud","name","action","syncResult","title","icon","content","showCancel","confirmText","disableSubscription","handleWechatBinding","success","bindWechat","provider","loginResult","userInfo","params","code","userId","res","errorMsg","sendTestMessage","statusResult","now","tomorrow","year","month","date","formattedDateTime","uniqueId","messageData","courseName","classTime","remark","studentName","page","result","cloudResult","msgid","method","note","originalError","isLocalSubscribed","localSubscribed","errorCode"],"mappings":"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","file":"pages/subscription-settings/subscription-settings.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/subscription-settings/subscription-settings.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./subscription-settings.vue?vue&type=template&id=2075e12e&scoped=true&\"\nvar renderjs\nimport script from \"./subscription-settings.vue?vue&type=script&lang=js&\"\nexport * from \"./subscription-settings.vue?vue&type=script&lang=js&\"\nimport style0 from \"./subscription-settings.vue?vue&type=style&index=0&id=2075e12e&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2075e12e\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/subscription-settings/subscription-settings.vue\"\nexport default component.exports","export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./subscription-settings.vue?vue&type=template&id=2075e12e&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./subscription-settings.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./subscription-settings.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"page-container\">\r\n\t\t<!-- çŠ¶æ€æ  -->\r\n\t\t<view class=\"status-bar\"></view>\r\n\t\t\r\n\t\t<!-- é¡¶éƒ¨å¯¼èˆªæ  -->\r\n\t\t<view class=\"top-bar\">\r\n\t\t\t<view class=\"top-nav\">\r\n\t\t\t\t<view class=\"back-btn\" @click=\"goBack\">\r\n\t\t\t\t\t<text class=\"back-icon\">â†</text>\r\n\t\t\t\t\t<text>è¿”å›</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"page-title\">è®¢é˜…é€šçŸ¥è®¾ç½®</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- ä¸»è¦å†…å®¹ -->\r\n\t\t<view class=\"content\">\r\n\t\t\t<!-- è®¢é˜…é€šçŸ¥å¼€å…³åŒºåŸŸ -->\r\n\t\t\t<view class=\"subscription-section\">\r\n\t\t\t\t<view class=\"section-title\">ğŸ“¨ è®¢é˜…é€šçŸ¥</view>\r\n\t\t\t\t<view class=\"section-desc\">å¼€å¯è®¢é˜…é€šçŸ¥ï¼ŒåŠæ—¶æ¥æ”¶è¯¾ç¨‹å®‰æ’ä¿¡æ¯</view>\r\n\t\t\t\t\r\n\t\t\t\t<!-- è®¢é˜…å¼€å…³ -->\r\n\t\t\t\t<view class=\"switch-container\">\r\n\t\t\t\t\t<view class=\"switch-label\">\r\n\t\t\t\t\t\t<text class=\"switch-text\">è®¢é˜…æ¶ˆæ¯é€šçŸ¥</text>\r\n\t\t\t\t\t\t<text class=\"switch-status\">{{ isSubscribed ? 'å·²å¼€å¯' : 'å·²å…³é—­' }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<switch \r\n\t\t\t\t\t\t:checked=\"isSubscribed\" \r\n\t\t\t\t\t\t@change=\"onSubscriptionToggle\"\r\n\t\t\t\t\t\tcolor=\"#667eea\" \r\n\t\t\t\t\t\tclass=\"subscription-switch\" />\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- å¾®ä¿¡ç»‘å®šåŒºåŸŸ -->\r\n\t\t\t<view class=\"wechat-section\">\r\n\t\t\t\t<view class=\"section-title\">ğŸ”— å¾®ä¿¡ç»‘å®š</view>\r\n\t\t\t\t<view class=\"section-desc\">{{ hasOpenid ? 'å¾®ä¿¡å·²ç»‘å®šï¼Œå¯ä»¥æ¥æ”¶æ¶ˆæ¯' : 'ç»‘å®šå¾®ä¿¡è´¦å·ä»¥æ¥æ”¶è®¢é˜…æ¶ˆæ¯' }}</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"wechat-action\">\r\n\t\t\t\t\t<button \r\n\t\t\t\t\t\tclass=\"wechat-btn\" \r\n\t\t\t\t\t\t:class=\"{ 'bound': hasOpenid }\"\r\n\t\t\t\t\t\t@click=\"handleWechatBinding\"\r\n\t\t\t\t\t\t:loading=\"isBinding\">\r\n\t\t\t\t\t\t{{ isBinding ? 'ç»‘å®šä¸­...' : (hasOpenid ? 'âœ“ å·²ç»‘å®šå¾®ä¿¡' : 'ç»‘å®šå¾®ä¿¡') }}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- æµ‹è¯•æ¶ˆæ¯åŒºåŸŸ -->\r\n\t\t\t<view class=\"test-section\" v-if=\"isSubscribed && hasOpenid\">\r\n\t\t\t\t<view class=\"section-title\">ğŸ§ª æµ‹è¯•æ¶ˆæ¯</view>\r\n\t\t\t\t<view class=\"section-desc\">å‘é€ä¸€æ¡æµ‹è¯•è®¢é˜…æ¶ˆæ¯ï¼ŒéªŒè¯åŠŸèƒ½æ˜¯å¦æ­£å¸¸</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"test-action\">\r\n\t\t\t\t\t<button \r\n\t\t\t\t\t\tclass=\"test-btn\" \r\n\t\t\t\t\t\t@click=\"sendTestMessage\"\r\n\t\t\t\t\t\t:loading=\"isTesting\">\r\n\t\t\t\t\t\t{{ isTesting ? 'å‘é€ä¸­...' : 'ğŸ“¤ å‘é€æµ‹è¯•æ¶ˆæ¯' }}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\t// è®¢é˜…çŠ¶æ€\r\n\t\t\tisSubscribed: false,\r\n\t\t\tisSubscribing: false,\r\n\t\t\t\r\n\t\t\t// å¾®ä¿¡ç»‘å®šçŠ¶æ€ï¼ˆéµå¾ªé¡¹ç›®è§„èŒƒå¢åŠ çŠ¶æ€ç®¡ç†ï¼‰\r\n\t\t\thasOpenid: false,\r\n\t\t\tisBinding: false,\r\n\t\t\t\r\n\t\t\t// æµ‹è¯•æ¶ˆæ¯çŠ¶æ€\r\n\t\t\tisTesting: false,\r\n\t\t\t\r\n\t\t\t// å¾®ä¿¡è®¢é˜…æ¶ˆæ¯é…ç½®\r\n\t\t\ttemplateId: 'sOwar1Xkzk4ApC2eQvvc4SZFH6UbFz_ZA8DZjHHPZf4' // æ’è¯¾é€šçŸ¥æ¨¡æ¿ID\r\n\t\t};\r\n\t},\r\n\t\r\n\t// é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ\r\n\tonMounted() {\r\n\t\tconsole.log('ğŸš€ è®¢é˜…è®¾ç½®é¡µé¢åŠ è½½å®Œæˆ');\r\n\t\tthis.checkUserStatus();\r\n\t},\r\n\t\r\n\t// é¡µé¢æ˜¾ç¤ºæ—¶æ‰§è¡Œ\r\n\tonShow() {\r\n\t\tconsole.log('ğŸ‘ï¸ è®¢é˜…è®¾ç½®é¡µé¢æ˜¾ç¤º');\r\n\t\tthis.checkUserStatus();\r\n\t},\r\n\t\r\n\tmethods: {\r\n\t\tgoBack() {\r\n\t\t\tuni.navigateBack();\r\n\t\t},\r\n\t\t\r\n\t\t// æ£€æŸ¥ç”¨æˆ·çŠ¶æ€ï¼ˆè®¢é˜…çŠ¶æ€å’Œå¾®ä¿¡ç»‘å®šçŠ¶æ€ï¼‰\r\n\t\tasync checkUserStatus() {\r\n\t\t\ttry {\r\n\t\t\t\t// æ£€æŸ¥è®¢é˜…çŠ¶æ€\r\n\t\t\t\tconst localStatus = uni.getStorageSync('subscriptionStatus');\r\n\t\t\t\tif (localStatus && localStatus.isSubscribed) {\r\n\t\t\t\t\tthis.isSubscribed = true;\r\n\t\t\t\t\tconsole.log('âœ… æœ¬åœ°è®¢é˜…çŠ¶æ€ï¼šå·²è®¢é˜…');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.isSubscribed = false;\r\n\t\t\t\t\tconsole.log('âŒ æœ¬åœ°è®¢é˜…çŠ¶æ€ï¼šæœªè®¢é˜…');\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// æ£€æŸ¥å¾®ä¿¡ç»‘å®šçŠ¶æ€\r\n\t\t\t\tconst openid = uni.getStorageSync('openid');\r\n\t\t\t\tif (openid) {\r\n\t\t\t\t\tthis.hasOpenid = true;\r\n\t\t\t\t\tconsole.log('âœ… å¾®ä¿¡å·²ç»‘å®š:', openid);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.hasOpenid = false;\r\n\t\t\t\t\tconsole.log('âŒ å¾®ä¿¡æœªç»‘å®š');\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('æ£€æŸ¥ç”¨æˆ·çŠ¶æ€å¤±è´¥:', error);\r\n\t\t\t\tthis.isSubscribed = false;\r\n\t\t\t\tthis.hasOpenid = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// è®¢é˜…å¼€å…³åˆ‡æ¢å¤„ç†\r\n\t\tasync onSubscriptionToggle(event) {\r\n\t\t\tconst isOn = event.detail.value;\r\n\t\t\tconsole.log(`ğŸ”„ è®¢é˜…å¼€å…³åˆ‡æ¢: ${isOn ? 'å¼€å¯' : 'å…³é—­'}`);\r\n\t\t\t\r\n\t\t\tif (isOn) {\r\n\t\t\t\t// å¼€å¯è®¢é˜…\r\n\t\t\t\tawait this.enableSubscription();\r\n\t\t\t} else {\r\n\t\t\t\t// å…³é—­è®¢é˜…\r\n\t\t\t\tthis.disableSubscription();\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// å¼€å¯è®¢é˜…\r\n\t\tasync enableSubscription() {\r\n\t\t\tthis.isSubscribing = true;\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log('ğŸ” è¯·æ±‚è®¢é˜…æ¶ˆæ¯æˆæƒ...');\r\n\t\t\t\t\r\n\t\t\t\t// è°ƒç”¨å¾®ä¿¡è®¢é˜…æ¶ˆæ¯æˆæƒæ¥å£\r\n\t\t\t\tconst authResult = await uni.requestSubscribeMessage({\r\n\t\t\t\t\ttmplIds: [this.templateId]\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tconsole.log('ğŸ“± å¾®ä¿¡æˆæƒç»“æœ:', authResult);\r\n\t\t\t\t\r\n\t\t\t\tif (authResult[this.templateId] === 'accept') {\r\n\t\t\t\t\tconsole.log('âœ… ç”¨æˆ·æ¥å—è®¢é˜…æ¶ˆæ¯æˆæƒ');\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ›´æ–°è®¢é˜…çŠ¶æ€\r\n\t\t\t\t\tthis.isSubscribed = true;\r\n\t\t\t\t\t\r\n\t\t\t\t\t// ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\r\n\t\t\t\t\tuni.setStorageSync('subscriptionStatus', {\r\n\t\t\t\t\t\tisSubscribed: true,\r\n\t\t\t\t\t\tstatus: 'accepted',\r\n\t\t\t\t\t\tlastUpdate: Date.now(),\r\n\t\t\t\t\t\tcacheExpiry: Date.now() + (365 * 24 * 60 * 60 * 1000) // 1å¹´æœ‰æ•ˆæœŸ\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\t// è°ƒç”¨äº‘å‡½æ•°åŒæ­¥æˆæƒçŠ¶æ€åˆ°æ•°æ®åº“ï¼ˆåˆ›å»ºä¼ªæ°¸ä¹…è®¢é˜…è®°å½•ï¼‰\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tconst openid = uni.getStorageSync('openid');\r\n\t\t\t\t\t\tif (openid) {\r\n\t\t\t\t\t\t\tconsole.log('ğŸ“¤ åŒæ­¥ä¸»è®¢é˜…æˆæƒçŠ¶æ€åˆ°äº‘ç«¯æ•°æ®åº“...');\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconst syncResult = await uniCloud.callFunction({\r\n\t\t\t\t\t\t\t\tname: 'subscription-message',\r\n\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\taction: 'request-subscription',\r\n\t\t\t\t\t\t\t\t\topenid: openid,\r\n\t\t\t\t\t\t\t\t\ttemplateId: this.templateId,\r\n\t\t\t\t\t\t\t\t\tstatus: 'accepted'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconsole.log('âœ… ä¸»è®¢é˜…äº‘ç«¯æ•°æ®åº“åŒæ­¥ç»“æœ:', syncResult);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (syncResult.result.code === 200) {\r\n\t\t\t\t\t\t\t\tconsole.log('âœ… ä¸»è®¢é˜…ä¼ªæ°¸ä¹…è®°å½•åˆ›å»ºæˆåŠŸ');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconsole.log('âš ï¸ ä¸»è®¢é˜…ä¼ªæ°¸ä¹…è®°å½•åˆ›å»ºå¤±è´¥:', syncResult.result.message);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.log('âš ï¸ æœªæ‰¾åˆ°openidï¼Œè·³è¿‡äº‘ç«¯åŒæ­¥');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (syncError) {\r\n\t\t\t\t\t\tconsole.error('åŒæ­¥ä¸»è®¢é˜…æˆæƒçŠ¶æ€åˆ°äº‘ç«¯å¤±è´¥:', syncError);\r\n\t\t\t\t\t\t// ä¸å½±å“æœ¬åœ°æˆæƒçŠ¶æ€\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'è®¢é˜…æˆåŠŸ',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (authResult[this.templateId] === 'reject') {\r\n\t\t\t\t\tconsole.log('âŒ ç”¨æˆ·æ‹’ç»è®¢é˜…æ¶ˆæ¯æˆæƒ');\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ¢å¤å¼€å…³çŠ¶æ€\r\n\t\t\t\t\tthis.isSubscribed = false;\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'è®¢é˜…è¢«æ‹’ç»',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('âš ï¸ è®¢é˜…æ¶ˆæ¯æˆæƒå¤±è´¥:', authResult[this.templateId]);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ¢å¤å¼€å…³çŠ¶æ€\r\n\t\t\t\t\tthis.isSubscribed = false;\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'æˆæƒå¤±è´¥',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('è¯·æ±‚è®¢é˜…æˆæƒå¤±è´¥:', error);\r\n\t\t\t\t\r\n\t\t\t\t// æ¢å¤å¼€å…³çŠ¶æ€\r\n\t\t\t\tthis.isSubscribed = false;\r\n\t\t\t\t\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: 'æˆæƒå¤±è´¥',\r\n\t\t\t\t\tcontent: 'æ— æ³•è·å–è®¢é˜…æ¶ˆæ¯æˆæƒï¼Œè¯·ç¨åé‡è¯•ã€‚',\r\n\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\tconfirmText: 'çŸ¥é“äº†'\r\n\t\t\t\t});\r\n\t\t\t} finally {\r\n\t\t\t\tthis.isSubscribing = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// å…³é—­è®¢é˜…\r\n\t\tdisableSubscription() {\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log('ğŸ”’ å…³é—­è®¢é˜…é€šçŸ¥...');\r\n\t\t\t\t\r\n\t\t\t\t// æ›´æ–°æœ¬åœ°çŠ¶æ€\r\n\t\t\t\tthis.isSubscribed = false;\r\n\t\t\t\t\r\n\t\t\t\t// æ¸…é™¤æœ¬åœ°å­˜å‚¨\r\n\t\t\t\tuni.removeStorageSync('subscriptionStatus');\r\n\t\t\t\t\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'å·²å…³é—­è®¢é˜…',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t});\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('å…³é—­è®¢é˜…å¤±è´¥:', error);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// å¤„ç†å¾®ä¿¡ç»‘å®š\r\n\t\tasync handleWechatBinding() {\r\n\t\t\tif (this.hasOpenid) {\r\n\t\t\t\t// å·²ç»‘å®šï¼Œå¯ä»¥é‡æ–°ç»‘å®š\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: 'é‡æ–°ç»‘å®š',\r\n\t\t\t\t\tcontent: 'æ˜¯å¦è¦é‡æ–°ç»‘å®šå¾®ä¿¡è´¦å·ï¼Ÿ',\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\tthis.bindWechat();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// æœªç»‘å®šï¼Œè¿›è¡Œç»‘å®š\r\n\t\t\t\tthis.bindWechat();\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// ç»‘å®šå¾®ä¿¡\r\n\t\tasync bindWechat() {\r\n\t\t\tif (this.isBinding) {\r\n\t\t\t\tconsole.log('æ­£åœ¨ç»‘å®šä¸­ï¼Œè·³è¿‡é‡å¤æ“ä½œ');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tthis.isBinding = true;\r\n\t\t\t\t\r\n\t\t\t\t// æ£€æŸ¥æ˜¯å¦åœ¨å¾®ä¿¡å°ç¨‹åºç¯å¢ƒ\r\n\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: 'æ­£åœ¨ç»‘å®š...'\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// è·å–å¾®ä¿¡ç™»å½•code\r\n\t\t\t\tconst loginResult = await uni.login({\r\n\t\t\t\t\tprovider: 'weixin'\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tif (loginResult.code) {\r\n\t\t\t\t\t// æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•\r\n\t\t\t\t\tconst userInfo = uni.getStorageSync('userInfo');\r\n\t\t\t\t\tif (!userInfo || !userInfo._id) {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\ttitle: 'éœ€è¦ç™»å½•',\r\n\t\t\t\t\t\t\tcontent: 'è¯·å…ˆç™»å½•ç³»ç»Ÿåå†ç»‘å®šå¾®ä¿¡',\r\n\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// è°ƒç”¨äº‘å‡½æ•°ç»‘å®šå¾®ä¿¡\r\n\t\t\t\t\tconst res = await uniCloud.callFunction({\r\n\t\t\t\t\t\tname: 'auth-service',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\taction: 'bind-wechat',\r\n\t\t\t\t\t\t\tparams: {\r\n\t\t\t\t\t\t\t\tcode: loginResult.code,\r\n\t\t\t\t\t\t\t\tuserId: userInfo._id\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (res.result.code === 200) {\r\n\t\t\t\t\t\t// ä¿å­˜openid\r\n\t\t\t\t\t\tuni.setStorageSync('openid', res.result.openid);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// æ›´æ–°çŠ¶æ€\r\n\t\t\t\t\t\tthis.hasOpenid = true;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: 'å¾®ä¿¡ç»‘å®šæˆåŠŸ',\r\n\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst errorMsg = res.result.message || 'ç»‘å®šå¤±è´¥';\r\n\t\t\t\t\t\tconsole.error('å¾®ä¿¡ç»‘å®šå¤±è´¥:', res.result);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\ttitle: 'å¾®ä¿¡ç»‘å®šå¤±è´¥',\r\n\t\t\t\t\t\t\tcontent: errorMsg,\r\n\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'è·å–å¾®ä¿¡æˆæƒå¤±è´¥',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t// #endif\r\n\t\t\t\t\r\n\t\t\t\t// #ifndef MP-WEIXIN\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'è¯·åœ¨å¾®ä¿¡å°ç¨‹åºä¸­ä½¿ç”¨',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\t// #endif\r\n\t\t\t} catch (error) {\r\n\t\t\t\tuni.hideLoading();\r\n\t\t\t\tconsole.error('ç»‘å®šå¾®ä¿¡å¤±è´¥:', error);\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'ç»‘å®šå¤±è´¥',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t} finally {\r\n\t\t\t\tthis.isBinding = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// å‘é€æµ‹è¯•æ¶ˆæ¯ï¼ˆå•æ¬¡å‘é€ï¼Œéµå¾ªé¡¹ç›®è§„èŒƒï¼‰\r\n\t\tasync sendTestMessage() {\r\n\t\t\tif (this.isTesting) return;\r\n\t\t\t\r\n\t\t\tthis.isTesting = true;\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log('ğŸ§ª å¼€å§‹å‘é€æµ‹è¯•è®¢é˜…æ¶ˆæ¯...');\r\n\t\t\t\t\r\n\t\t\t\t// æ˜¾ç¤ºåŠ è½½æç¤º\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: 'æ£€æŸ¥è®¢é˜…çŠ¶æ€...'\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// å…ˆæ£€æŸ¥äº‘ç«¯æ˜¯å¦å·²æœ‰ä¼ªæ°¸ä¹…è®¢é˜…è®°å½•\r\n\t\t\t\tconst openid = uni.getStorageSync('openid');\r\n\t\t\t\tif (!openid) {\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\ttitle: 'éœ€è¦ç»‘å®šå¾®ä¿¡',\r\n\t\t\t\t\t\tcontent: 'è¯·å…ˆç»‘å®šå¾®ä¿¡è´¦å·åå†å‘é€æµ‹è¯•æ¶ˆæ¯ã€‚',\r\n\t\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\t\tconfirmText: 'çŸ¥é“äº†'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// æ£€æŸ¥äº‘ç«¯ä¼ªæ°¸ä¹…è®¢é˜…çŠ¶æ€\r\n\t\t\t\t\tconsole.log('ğŸ” æ£€æŸ¥äº‘ç«¯ä¼ªæ°¸ä¹…è®¢é˜…çŠ¶æ€...');\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst statusResult = await uniCloud.callFunction({\r\n\t\t\t\t\t\tname: 'subscription-message',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\taction: 'get-subscription-status',\r\n\t\t\t\t\t\t\topenid: openid\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tconsole.log('ğŸ“Š äº‘ç«¯è®¢é˜…çŠ¶æ€æ£€æŸ¥ç»“æœ:', statusResult);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (statusResult.result.code === 200 && statusResult.result.data.isSubscribed) {\r\n\t\t\t\t\t\t// å·²æœ‰ä¼ªæ°¸ä¹…è®¢é˜…è®°å½•ï¼Œç›´æ¥å‘é€æµ‹è¯•æ¶ˆæ¯\r\n\t\t\t\t\t\tconsole.log('âœ… å‘ç°ä¼ªæ°¸ä¹…è®¢é˜…è®°å½•ï¼Œç›´æ¥å‘é€æµ‹è¯•æ¶ˆæ¯ï¼ˆæ— éœ€é‡æ–°æˆæƒï¼‰');\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// æ›´æ–°åŠ è½½æç¤º\r\n\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\ttitle: 'å‘é€æµ‹è¯•æ¶ˆæ¯...'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// æœªæ‰¾åˆ°ä¼ªæ°¸ä¹…è®¢é˜…è®°å½•ï¼Œéœ€è¦é‡æ–°æˆæƒï¼ˆä»…é¦–æ¬¡ï¼‰\r\n\t\t\t\t\t\tconsole.log('âš ï¸ æœªæ‰¾åˆ°ä¼ªæ°¸ä¹…è®¢é˜…è®°å½•ï¼Œéœ€è¦è¿›è¡Œé¦–æ¬¡æˆæƒ');\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst authResult = await uni.requestSubscribeMessage({\r\n\t\t\t\t\t\t\ttmplIds: [this.templateId]\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconsole.log('ğŸ“± é¦–æ¬¡æˆæƒç»“æœ:', authResult);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (authResult[this.templateId] !== 'accept') {\r\n\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\ttitle: 'éœ€è¦æˆæƒ',\r\n\t\t\t\t\t\t\t\tcontent: 'é¦–æ¬¡ä½¿ç”¨æµ‹è¯•åŠŸèƒ½éœ€è¦æ‚¨æˆæƒè®¢é˜…æ¶ˆæ¯ï¼Œæˆæƒååç»­ä¸éœ€é‡å¤æˆæƒã€‚',\r\n\t\t\t\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\t\t\t\tconfirmText: 'çŸ¥é“äº†'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// åˆ›å»ºä¼ªæ°¸ä¹…è®¢é˜…è®°å½•\r\n\t\t\t\t\t\tconst syncResult = await uniCloud.callFunction({\r\n\t\t\t\t\t\t\tname: 'subscription-message',\r\n\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\taction: 'request-subscription',\r\n\t\t\t\t\t\t\t\topenid: openid,\r\n\t\t\t\t\t\t\t\ttemplateId: this.templateId,\r\n\t\t\t\t\t\t\t\tstatus: 'accepted'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (syncResult.result.code === 200) {\r\n\t\t\t\t\t\t\tconsole.log('âœ… ä¼ªæ°¸ä¹…è®¢é˜…è®°å½•åˆ›å»ºæˆåŠŸï¼Œåç»­æµ‹è¯•æ— éœ€é‡å¤æˆæƒ');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\ttitle: 'å‘é€æµ‹è¯•æ¶ˆæ¯...'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (checkError) {\r\n\t\t\t\t\tconsole.error('æ£€æŸ¥äº‘ç«¯è®¢é˜…çŠ¶æ€å¤±è´¥:', checkError);\r\n\t\t\t\t\t// å¦‚æœæ£€æŸ¥å¤±è´¥ï¼Œå›é€€åˆ°é‡æ–°æˆæƒæµç¨‹\r\n\t\t\t\t\tconst authResult = await uni.requestSubscribeMessage({\r\n\t\t\t\t\t\ttmplIds: [this.templateId]\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (authResult[this.templateId] !== 'accept') {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\ttitle: 'éœ€è¦æˆæƒ',\r\n\t\t\t\t\t\t\tcontent: 'å‘é€æµ‹è¯•æ¶ˆæ¯éœ€è¦æ‚¨æˆæƒè®¢é˜…æ¶ˆæ¯ã€‚',\r\n\t\t\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\t\t\tconfirmText: 'çŸ¥é“äº†'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\ttitle: 'å‘é€æµ‹è¯•æ¶ˆæ¯...'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// ç”Ÿæˆæµ‹è¯•æ¶ˆæ¯å†…å®¹\r\n\t\t\t\tconst now = new Date();\r\n\t\t\t\tconst tomorrow = new Date(now.getTime() + 24 * 60 * 60 * 1000);\r\n\t\t\t\t\r\n\t\t\t\t// ä½¿ç”¨å¾®ä¿¡APIæ ‡å‡†æ—¶é—´æ ¼å¼\r\n\t\t\t\tconst year = tomorrow.getFullYear();\r\n\t\t\t\tconst month = tomorrow.getMonth() + 1;\r\n\t\t\t\tconst date = tomorrow.getDate();\r\n\t\t\t\tconst formattedDateTime = `${year}å¹´${month}æœˆ${date}æ—¥ 18:00`;\r\n\t\t\t\t\r\n\t\t\t\t// ç”Ÿæˆå”¯ä¸€çš„æµ‹è¯•æ¶ˆæ¯å†…å®¹\r\n\t\t\t\tconst uniqueId = now.getTime();\r\n\t\t\t\tconst messageData = {\r\n\t\t\t\t\tcourseName: `æµ‹è¯•è¯¾ç¨‹-${uniqueId}`,\r\n\t\t\t\t\tclassTime: formattedDateTime,\r\n\t\t\t\t\tremark: `æµ‹è¯•æ•™å®¤-${now.getSeconds()}ç§’`,\r\n\t\t\t\t\tstudentName: 'æµ‹è¯•å­¦å‘˜',\r\n\t\t\t\t\tpage: 'pages/schedule-tab/schedule-tab'\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\tconsole.log('ğŸ“¤ å³å°†å‘é€çš„æµ‹è¯•æ¶ˆæ¯æ•°æ®:', messageData);\r\n\t\t\t\t\r\n\t\t\t\t// è°ƒç”¨äº‘å‡½æ•°å‘é€æµ‹è¯•æ¶ˆæ¯\r\n\t\t\t\tconst result = await uniCloud.callFunction({\r\n\t\t\t\t\tname: 'subscription-message',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'send-schedule-notification',\r\n\t\t\t\t\t\topenid: openid,\r\n\t\t\t\t\t\t...messageData\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tconsole.log('ğŸ“¥ æµ‹è¯•æ¶ˆæ¯å‘é€ç»“æœ:', result);\r\n\t\t\t\t\r\n\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\r\n\t\t\t\t// è¯¦ç»†æ£€æŸ¥å‘é€ç»“æœ\r\n\t\t\t\tif (result.success && result.result) {\r\n\t\t\t\t\tconst cloudResult = result.result;\r\n\t\t\t\t\tconsole.log('â˜ï¸ äº‘å‡½æ•°è¿”å›ç»“æœè¯¦æƒ…:', cloudResult);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ£€æŸ¥äº‘å‡½æ•°æ‰§è¡Œç»“æœ\r\n\t\t\t\t\tif (cloudResult.code === 200) {\r\n\t\t\t\t\t\tconst msgid = cloudResult.data?.msgid;\r\n\t\t\t\t\t\tconst method = cloudResult.data?.method || 'pseudo_permanent';\r\n\t\t\t\t\t\tconst note = cloudResult.data?.note || '';\r\n\t\t\t\t\t\tconst originalError = cloudResult.data?.originalError;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconsole.log('âœ… äº‘å‡½æ•°æ‰§è¡ŒæˆåŠŸ:', {\r\n\t\t\t\t\t\t\tmsgid: msgid,\r\n\t\t\t\t\t\t\tmethod: method,\r\n\t\t\t\t\t\t\tnote: note,\r\n\t\t\t\t\t\t\toriginalError: originalError\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// æ£€æŸ¥æ˜¯å¦æœ‰å¾®ä¿¡APIé”™è¯¯ï¼ˆå¦‚43101ï¼‰\r\n\t\t\t\t\t\tif (originalError && (originalError.errcode === '43101' || originalError.errcode === 43101)) {\r\n\t\t\t\t\t\t\t// æ£€æŸ¥æœ¬åœ°è®¢é˜…çŠ¶æ€ï¼Œæä¾›æ›´å‡†ç¡®çš„æŒ‡å¯¼\r\n\t\t\t\t\t\t\tconst isLocalSubscribed = this.isSubscribed;\r\n\t\t\t\t\t\t\tconsole.log('ğŸ” 43101é”™è¯¯åˆ†æ:', {\r\n\t\t\t\t\t\t\t\tlocalSubscribed: isLocalSubscribed,\r\n\t\t\t\t\t\t\t\terrorCode: originalError.errcode,\r\n\t\t\t\t\t\t\t\terrorMsg: originalError.errmsg\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// ä¼ªæ°¸ä¹…è®¢é˜…åŠŸèƒ½ï¼šå³ä½¿43101é”™è¯¯ï¼Œä¹Ÿä¿æŒè®¢é˜…çŠ¶æ€æœ‰æ•ˆ\r\n\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\ttitle: 'ğŸ“± å¾®ä¿¡é€šçŸ¥è®¾ç½®æé†’',\r\n\t\t\t\t\t\t\t\tcontent: `æ‚¨çš„è®¢é˜…çŠ¶æ€æ­£å¸¸ï¼Œä½†å¾®ä¿¡å¯èƒ½åœ¨ç³»ç»Ÿå±‚é¢é™åˆ¶äº†é€šçŸ¥ã€‚\\n\\nâœ… ä¼ªæ°¸ä¹…è®¢é˜…ä»ç„¶æœ‰æ•ˆ\\nâœ… æ— éœ€é‡æ–°æˆæƒ\\nâœ… å¯ç»§ç»­æ­£å¸¸å‘é€\\n\\nå¦‚éœ€æ¥æ”¶å¾®ä¿¡é€šçŸ¥ï¼Œè¯·æ£€æŸ¥ï¼š\\n1. å¾®ä¿¡-è®¾ç½®-é€šç”¨-å°ç¨‹åº-é€šçŸ¥ç®¡ç†\\n2. ç¡®ä¿å¼€å¯äº†æœ¬å°ç¨‹åºçš„é€šçŸ¥æƒé™`,\r\n\t\t\t\t\t\t\t\tconfirmText: 'çŸ¥é“äº†',\r\n\t\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else if (msgid) {\r\n\t\t\t\t\t\t\t// çœŸæ­£å‘é€æˆåŠŸ\r\n\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\ttitle: 'âœ… æµ‹è¯•æˆåŠŸ',\r\n\t\t\t\t\t\t\t\tcontent: `æµ‹è¯•è®¢é˜…æ¶ˆæ¯å‘é€æˆåŠŸï¼\\n\\næ¶ˆæ¯ID: ${msgid}\\nå‘é€æ—¶é—´: ${new Date().toLocaleString()}\\nå‘é€æ–¹å¼: ${method}\\n\\n${note ? 'è¯´æ˜: ' + note + '\\n\\n' : ''}è¯·æ£€æŸ¥å¾®ä¿¡æ˜¯å¦æ”¶åˆ°é€šçŸ¥ã€‚`,\r\n\t\t\t\t\t\t\t\tconfirmText: 'çŸ¥é“äº†',\r\n\t\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// æ²¡æœ‰msgidï¼Œå¯èƒ½æ˜¯ç‰¹æ®Šå¤„ç†æ¨¡å¼\r\n\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\ttitle: 'âœ… å¤„ç†æˆåŠŸ',\r\n\t\t\t\t\t\t\t\tcontent: `æµ‹è¯•æ¶ˆæ¯å·²å¤„ç†ï¼\\n\\nå¤„ç†æ—¶é—´: ${new Date().toLocaleString()}\\nå¤„ç†æ–¹å¼: ${method}\\n\\n${note ? 'è¯´æ˜: ' + note : 'æ¶ˆæ¯å·²æŒ‰ç‰¹æ®Šç­–ç•¥å¤„ç†'}`,\r\n\t\t\t\t\t\t\t\tconfirmText: 'çŸ¥é“äº†',\r\n\t\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// äº‘å‡½æ•°è¿”å›é”™è¯¯\r\n\t\t\t\t\t\tthrow new Error(cloudResult.message || 'äº‘å‡½æ•°æ‰§è¡Œå¤±è´¥');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// äº‘å‡½æ•°è°ƒç”¨å¤±è´¥\r\n\t\t\t\t\tthrow new Error('äº‘å‡½æ•°è°ƒç”¨å¤±è´¥');\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tuni.hideLoading();\r\n\t\t\t\tconsole.error('å‘é€æµ‹è¯•æ¶ˆæ¯å¤±è´¥:', error);\r\n\t\t\t\t\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: 'æµ‹è¯•å¤±è´¥',\r\n\t\t\t\t\tcontent: `æµ‹è¯•æ¶ˆæ¯å‘é€å¤±è´¥ï¼š\\n\\n${error.message}\\n\\nè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•ã€‚`,\r\n\t\t\t\t\tconfirmText: 'çŸ¥é“äº†',\r\n\t\t\t\t\tshowCancel: false\r\n\t\t\t\t});\r\n\t\t\t} finally {\r\n\t\t\t\tthis.isTesting = false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.page-container {\r\n\theight: 100vh;\r\n\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n}\r\n\r\n.status-bar {\r\n\theight: var(--status-bar-height);\r\n\tbackground: transparent;\r\n}\r\n\r\n.top-bar {\r\n\tbackground: rgba(255, 255, 255, 0.95);\r\n\tbackdrop-filter: blur(10px);\r\n\tborder-bottom: 1px solid rgba(255, 255, 255, 0.2);\r\n}\r\n\r\n.top-nav {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tpadding: 20rpx 30rpx;\r\n\tposition: relative;\r\n}\r\n\r\n.back-btn {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tcolor: #333;\r\n\tfont-size: 16px;\r\n\tcursor: pointer;\r\n}\r\n\r\n.back-icon {\r\n\tfont-size: 20px;\r\n\tmargin-right: 8rpx;\r\n}\r\n\r\n.page-title {\r\n\tposition: absolute;\r\n\tleft: 50%;\r\n\ttransform: translateX(-50%);\r\n\tfont-size: 18px;\r\n\tfont-weight: bold;\r\n\tcolor: #333;\r\n}\r\n\r\n.content {\r\n\tflex: 1;\r\n\tpadding: 30rpx;\r\n\toverflow-y: auto;\r\n}\r\n\r\n/* é€šç”¨åŒºåŸŸæ ·å¼ */\r\n.subscription-section,\r\n.wechat-section,\r\n.test-section {\r\n\tbackground: rgba(255, 255, 255, 0.95);\r\n\tborder-radius: 20rpx;\r\n\tpadding: 40rpx;\r\n\tmargin-bottom: 30rpx;\r\n\tbox-shadow: 0 10rpx 40rpx rgba(0, 0, 0, 0.1);\r\n\tbackdrop-filter: blur(10px);\r\n}\r\n\r\n.section-title {\r\n\tfont-size: 22px;\r\n\tfont-weight: bold;\r\n\tcolor: #333;\r\n\tmargin-bottom: 15rpx;\r\n}\r\n\r\n.section-desc {\r\n\tfont-size: 14px;\r\n\tcolor: #666;\r\n\tmargin-bottom: 30rpx;\r\n\tline-height: 1.6;\r\n}\r\n\r\n/* å¼€å…³å®¹å™¨æ ·å¼ */\r\n.switch-container {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tpadding: 20rpx 0;\r\n}\r\n\r\n.switch-label {\r\n\tflex: 1;\r\n}\r\n\r\n.switch-text {\r\n\tfont-size: 16px;\r\n\tcolor: #333;\r\n\tfont-weight: 500;\r\n\tdisplay: block;\r\n\tmargin-bottom: 8rpx;\r\n}\r\n\r\n.switch-status {\r\n\tfont-size: 12px;\r\n\tcolor: #999;\r\n}\r\n\r\n.subscription-switch {\r\n\ttransform: scale(1.2);\r\n}\r\n\r\n/* æŒ‰é’®æ ·å¼ */\r\n.wechat-action,\r\n.test-action {\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n}\r\n\r\n.wechat-btn,\r\n.test-btn {\r\n\twidth: 280rpx;\r\n\theight: 70rpx;\r\n\tborder: none;\r\n\tborder-radius: 35rpx;\r\n\tfont-size: 16px;\r\n\tfont-weight: 500;\r\n\ttransition: all 0.3s ease;\r\n}\r\n\r\n.wechat-btn {\r\n\tbackground: linear-gradient(135deg, #52C41A, #73D13D);\r\n\tcolor: white;\r\n\tbox-shadow: 0 6rpx 20rpx rgba(82, 196, 26, 0.3);\r\n}\r\n\r\n.wechat-btn.bound {\r\n\tbackground: linear-gradient(135deg, #52C41A, #389E0D);\r\n\tbox-shadow: 0 6rpx 20rpx rgba(82, 196, 26, 0.4);\r\n}\r\n\r\n.test-btn {\r\n\tbackground: linear-gradient(135deg, #1890FF, #096DD9);\r\n\tcolor: white;\r\n\tbox-shadow: 0 6rpx 20rpx rgba(24, 144, 255, 0.3);\r\n}\r\n\r\n.wechat-btn:active,\r\n.test-btn:active {\r\n\ttransform: scale(0.95);\r\n}\r\n\r\n.wechat-btn::after,\r\n.test-btn::after {\r\n\tborder: none;\r\n}\r\n</style>","import mod from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./subscription-settings.vue?vue&type=style&index=0&id=2075e12e&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./subscription-settings.vue?vue&type=style&index=0&id=2075e12e&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1759881831275\n      var cssReload = require(\"D:/hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}