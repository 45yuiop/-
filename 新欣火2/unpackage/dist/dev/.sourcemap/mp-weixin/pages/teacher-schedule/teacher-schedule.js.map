{"version":3,"sources":["uni-app:///main.js","webpack:///D:/ä»£ç /å°ç¨‹åº/æ–°æ¬£ç«1/pages/teacher-schedule/teacher-schedule.vue?6f2e","webpack:///D:/ä»£ç /å°ç¨‹åº/æ–°æ¬£ç«1/pages/teacher-schedule/teacher-schedule.vue?c7a5","webpack:///D:/ä»£ç /å°ç¨‹åº/æ–°æ¬£ç«1/pages/teacher-schedule/teacher-schedule.vue?a9b6","webpack:///D:/ä»£ç /å°ç¨‹åº/æ–°æ¬£ç«1/pages/teacher-schedule/teacher-schedule.vue?c759","uni-app:///pages/teacher-schedule/teacher-schedule.vue","webpack:///D:/ä»£ç /å°ç¨‹åº/æ–°æ¬£ç«1/pages/teacher-schedule/teacher-schedule.vue?788d","webpack:///D:/ä»£ç /å°ç¨‹åº/æ–°æ¬£ç«1/pages/teacher-schedule/teacher-schedule.vue?3a8c"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","d","data","allTeacherList","teacherIndex","searchKeyword","selectedTeacher","rawScheduleList","weekSchedule","isLoading","weekOffset","initialScheduleState","courseTypes","courseOptions","periods","periodTimes","weekDaysOrder","currentDate","now","computed","filteredTeacherList","teacher","weekTitle","weekRangeText","sunday","watch","handler","uni","console","deep","onShow","teacherId","setTimeout","onUnload","url","methods","checkAdminRoleAndFetchTeachers","title","icon","fetchTeachers","uniCloud","name","action","success","result","fail","enrichTeachersWithOpenid","i","params","userId","userResult","userDetail","selectTeacher","fetchTeacherSchedule","teacher_id","startDate","endDate","complete","buildWeekSchedule","course_date","course_slot_1","course_slot_1_type","course_slot_1_class","course_slot_1_location","course_slot_1_remark","course_slot_2","course_slot_2_type","course_slot_2_class","course_slot_2_location","course_slot_2_remark","course_slot_3","course_slot_3_type","course_slot_3_class","course_slot_3_location","course_slot_3_remark","course_slot_4","course_slot_4_type","course_slot_4_class","course_slot_4_location","course_slot_4_remark","course_slot_5","course_slot_5_type","course_slot_5_class","course_slot_5_location","course_slot_5_remark","course_slot_6","course_slot_6_type","course_slot_6_class","course_slot_6_location","course_slot_6_remark","courseDate","coursesForDay","daySchedule","è¯¾ç¨‹å","ç±»å‹","ç­çº§","æ•™å®¤","å¤‡æ³¨","newWeekSchedule","getMondayOfWeek","onInputChange","dayIndex","slot","field","value","event","key","onTypeChange","getTypeIndex","getCourseOptionIndex","getClassOptionIndex","onCourseOptionChange","onClassOptionChange","changeWeek","monday","saveSchedule","day","uid","username","schedules","adminName","res","weekKey","cacheKey","sendScheduleNotifications","currentTeacherId","latestCourse","latestCourseInfo","latestDateTime","schedule","courseKey","typeKey","classKey","locationKey","courseName","courseType","className","location","courseDateTime","date","teacherOpenid","teacherName","openid","hasOpenid","openidType","hasSessionSubscription","sessionResult","classTime","remark","studentName","page","subscriptionResult","errorDetail","message","error","code","getSlotStartTime","formatClassTime","getDayOfWeek","getDayOfWeekIndex","getCourseColor","goHome","returnToCurrentWeek","formatDateWithWeek","onInputFocus","checkSessionSubscription","createSessionSubscriptionForTeacher","isValid","createTime","expireTime","usageCount","type","sendScheduleNotificationWithSession","isSessionSubscription","method","content","showCancel","confirmText","cancelText","fallbackToTraditionalSubscription","logSessionScheduleMessage","sessionMessages","courseInfo","timestamp","updateSessionUsage","sessionData","formatDate"],"mappings":";;;;;;;;;;;;;AAAA;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,wBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyI;AACzI;AACoE;AACL;AACqC;;;AAGpG;AACgL;AAChL,gBAAgB,uLAAU;AAC1B,EAAE,sFAAM;AACR,EAAE,uGAAM;AACR,EAAE,gHAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,2GAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AChDA;AAAA;AAAA;AAAA;AAA8qB,CAAgB,4qBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACiGlsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;EACA;EACA;EACAC;EACAA;EACA;AACA;AACA;EACA;EACA;EACA;EACA;AACA;AAAA,eACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MACAC;MAAA;MACAC;MACAC;MACAC;MAAA;MACAC,cACA,cACA,eACA,eACA,eACA,eACA,cACA;MACAC;MAAA;MACAC;QACA;QACAC;QACA;QACA;QACAA;QACA;MACA;IACA;EACA;EACAC;IACAC;MAAA;MACA;QACA;MACA;MACA;QAAA,OACAC;MAAA,EACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;MACAC;MACA;IACA;EACA;EACAC;IACAjB;MACAkB;QACA;QACA;UACA;UACA;UACA;UACA;UACAC;UACAC;QACA;MACA;MACAC;IACA;EACA;EACAC;IAAA;IACAF;;IAEA;IACA;IACA;;IAEA;IACA;MACAG;MACAH;IACA;MACAG;MACAH;IACA;IAEAA;;IAEA;IACA;IACA;IACA;IAEAA;;IAEA;IACA;IACA;IAEA;MACAA;MACA;MACA;;MAEA;MACAI;QACA;UACAJ;UACA;QACA;MACA;IACA;MACAA;MACA;IACA;;IAEA;IACA;EACA;EACAK;IACA;IACA;MACAN;QAAAO;MAAA;MACAP;IACA;EACA;EACAQ;IACAC;MACA;MACA;MACA;MACA;MACA;QACA;MACA;QACAT;UAAAU;UAAAC;QAAA;QACAN;UACAL;YAAAO;UAAA;QACA;QACA;MACA;IACA;IACAK;MAAA;MACAC;QACAC;QACAvC;UAAAwC;QAAA;QACAC;UAAA;YAAA;YAAA;cAAA;gBAAA;kBAAA;oBACAC;oBAAA,MACAA;sBAAA;sBAAA;oBAAA;oBACA;oBACA;sBAAA;oBAAA;;oBAEA;oBAAA;oBAAA,OACA;kBAAA;oBAEA;sBACA;oBACA;sBACAjB;wBAAAU;wBAAAC;sBAAA;oBACA;oBAAA;oBAAA;kBAAA;oBAEAX;sBAAAU;sBAAAC;oBAAA;kBAAA;kBAAA;oBAAA;gBAAA;cAAA;YAAA;UAAA,CAEA;UAAA;YAAA;UAAA;UAAA;QAAA;QACAO;UACAlB;YAAAU;YAAAC;UAAA;QACA;MACA;IACA;IAEA;IACAQ;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAlB;gBAEAmB;cAAA;gBAAA;kBAAA;kBAAA;gBAAA;gBACA1B;gBAAA;gBAAA;gBAAA,OAGAmB;kBACAC;kBACAvC;oBACAwC;oBACAM;sBAAAC;oBAAA;kBACA;gBACA;cAAA;gBANAC;gBAQA;kBACAC;kBACA;oBACA;oBACAvB;kBACA;oBACAA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;cAAA;gBAtBAmB;gBAAA;gBAAA;cAAA;gBA0BAnB;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACAwB;MACAxB;MACA;MACA;MACAA;;MAEA;MACA;;MAEA;MACA;MACA;MACA;MAEAA;MACA;IACA;IACAyB;MAAA;MACA;MACA;;MAEA;MACA;MACA;MACA;MACA7B;MAEAI;MACAA;MACAA;MACAA;MAEAY;QACAC;QACAvC;UACAwC;UACAM;YACAM;YACAC;YACAC;UACA;QACA;QACAb;UACAf;UACA;UACA;YACAA;YACAA;YACA;;YAEA;YACA;;YAEA;YACA;YACA;YACAD;YACAC;UACA;YACAA;YACA;YACA;UACA;QACA;QACAiB;UACAjB;UACA;UACA;QACA;QACA6B;UACA;UACA7B;QACA;MACA;IACA;IACA8B;MAAA;MACA;MACA;MACA;MACA9B;MACAA;MACAA;MACAA;MAEA;MACA;MAAA,2BAEAmB;QACA;QACA;QACAnB;QAEA;UACA+B;UACAC;UAAAC;UAAAC;UAAAC;UAAAC;UACAC;UAAAC;UAAAC;UAAAC;UAAAC;UACAC;UAAAC;UAAAC;UAAAC;UAAAC;UACAC;UAAAC;UAAAC;UAAAC;UAAAC;UACAC;UAAAC;UAAAC;UAAAC;UAAAC;UACAC;UAAAC;UAAAC;UAAAC;UAAAC;QACA;;QAEA;QACA;UACA;UACA;YACAC;UACA;YACAA;UACA;UACA;UACA9D;UACA;QACA;QAEAA;;QAEA;QACA+D;UACA/D;UAEA;YACAA;YACA;UACA;UAEA;UACA;YACAgE;YACAA;YACAA;YACAA;YACAA;YAEAhE;cACAiE;cACAC;cACAC;cACAC;cACAC;YACA;UACA;QACA;QAEAC;QACAtE;MAAA;MA1DA;QAAA;MA2DA;MAEA;MACA;MAEAA;MACAA;QAAA;MAAA;MACAA;;MAEA;MACA;IACA;IACAuE;MAAA;MACA;MACAjF;MACA;MACA;MACAA;MACA;IACA;IACAkF;MACA;MACA;MACAxE;QAAAyE;QAAAC;QAAAC;QAAAC;QAAAC;MAAA;;MAEA;MACA;QACA;QACA7E;UAAAyE;UAAAC;UAAAC;UAAAC;UAAAE;QAAA;;QAEA;QACA;QACA;QACA;QACA;QACA/E;QACAC;MACA;IACA;IACA+E;MACA;QACA;QACA/E;UAAAyE;UAAAC;UAAAE;QAAA;QACA;QACA;QACA;QACA;QACA;QACA7E;MACA;IACA;IACAiF;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;QACA;QACAnF;UAAAyE;UAAAC;UAAAE;QAAA;QACA;QACA;QACA;QACA;QACA;QACA7E;MACA;IACA;IACAqF;MACA;QACA;QACA;;QAEA;QACA;QAEApF;UAAAyE;UAAAC;UAAAE;QAAA;QACA;QACA;QACA;QACA;QACA;QACA7E;MACA;IACA;IACAsF;MAAA;MACArF;MACA;MACAsF;MACA;MAEAtF;;MAEA;MACA;MACA;;MAEA;MACA;MACA;MACA;MACA;MAEA;QACAA;QACA;;QAEA;QACAI;UACA;YACAJ;YACA;UACA;QACA;MACA;QACAA;QACA;UACA;QACA;UACA;QACA;MACA;IACA;IACAuF;MAAA;MACA;QAAA,uCACAC;UACA9D;UACA+D;UAAA;UACAC;QAAA;MAAA,CACA;;MAEA;MACA;MACA;MAEA9E;QACAC;QACAvC;UACAwC;UACAM;YACAuE;YACAC;UACA;QACA;QACA7E;UAAA;YAAA;YAAA;cAAA;gBAAA;kBAAA;oBAAA,MACA8E;sBAAA;sBAAA;oBAAA;oBACA9F;sBAAAU;sBAAAC;oBAAA;;oBAEA;oBACAP;oBACAmF;oBACAQ;oBACAC;oBACAhG;;oBAEA;oBAAA;oBAAA,OACA;kBAAA;oBAEA;oBAAA;oBAAA;kBAAA;oBAEAA;sBAAAU;sBAAAC;oBAAA;kBAAA;kBAAA;oBAAA;gBAAA;cAAA;YAAA;UAAA,CAEA;UAAA;YAAA;UAAA;UAAA;QAAA;QACAO;UACAlB;YAAAU;YAAAC;UAAA;QACA;MACA;IACA;IAEA;IACAsF;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAhG;;gBAEA;gBACAiG,+CAEA;gBACAC;gBACAC;gBACAC,uBAEA;gBAAA,uCACAT;gBAAA;gBAAA;cAAA;gBAAA;kBAAA;kBAAA;gBAAA;gBAAAU;gBACAtE,sFAEA;gBAAA,MACA0D;kBAAA;kBAAA;gBAAA;gBACAzF;gBAAA;cAAA;gBAIA;gBACA;kBACAsG;kBACAC;kBACAC;kBACAC;kBAEAC;kBACAC;kBACAC;kBACAC,kCAEA;kBACA;oBACA;oBACAC,2FAEA;oBACA;sBACAV;sBACAF;sBACAC;wBACAO;wBACAC;wBACAC;wBACAC;wBACAE;wBACArC;sBACA;sBACA1E;oBACA;kBACA;gBACA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAAA;cAAA;gBAAA,MAIAkG;kBAAA;kBAAA;gBAAA;gBACAlG;;gBAEA;gBACAgH;gBACAhH;kBACAG;kBACA8G;kBACAC;kBACAC;kBACAC;gBACA;gBAAA,IAEAJ;kBAAA;kBAAA;gBAAA;gBACAhH;gBAAA;cAAA;gBAAA,MAIAgH;kBAAA;kBAAA;gBAAA;gBACAhH;gBAAA;cAAA;gBAAA;gBAMA;gBACAqH;gBAAA,KAEAA;kBAAA;kBAAA;gBAAA;gBACArH;;gBAEA;gBAAA;gBAAA,OACA,2EACAmG;kBACAe;gBAAA,GACA;cAAA;gBAHAI;gBAKA;kBACAtH;gBACA;kBACAA;gBACA;gBAAA;gBAAA;cAAA;gBAEAA;;gBAEA;gBAAA;gBAAA,OACAY;kBACAC;kBACAvC;oBACAwC;oBACAoG;oBACAR;oBACAa;oBACAC;oBAAA;oBACAC;oBACAC;kBACA;gBACA;cAAA;gBAXAC;gBAaA;kBACA3H;gBACA;kBACA4H;kBACA5H;oBACA6H;oBACAC;oBACAC;kBACA;;kBAEA;kBACA;oBACA/H;;oBAEA;oBACA;kBACA;gBACA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAA;cAAA;gBAAA;gBAAA;cAAA;gBAGAA;cAAA;gBAGAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAgI;MACA,wBACA;MAAA;MACA;MAAA;MACA;MAAA;MACA;MAAA;MACA;MAAA;MACA;MAAA,CACA;;MAEA;IACA;IAEA;IACAC;MACA;;MAEA;MACA;MACA;MACA;;MAEA;MACA,wBACA;MAAA;MACA;MAAA;MACA;MAAA;MACA;MAAA;MACA;MAAA;MACA;MAAA,CACA;;MAEA;;MAEA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACAtI;QAAAO;MAAA;IACA;IACAgI;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACAxI;MACA;MACA;IACA;IAEA;IACAyI;MACA;QACA;QACA;QACA;QAEA;UACA;UACA;YACAzI;YACA;UACA;YACAA;YACA;UACA;QACA;QAEA;MACA;QACAA;QACA;MACA;IACA;IAEA;IACA0I;MACA;QACA;QACA;UACAC;UACAC;UACAC;UAAA;UACAC;UACA5B;UACA6B;QACA;QAEAhJ;QACAC;QAEA;MACA;QACAA;QACA;MACA;IACA;IAEA;IACAgJ;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAhJ;gBACAA;kBACAkH;kBACAR;kBACAa;kBACAC;kBACAC;kBACAwB;gBACA;;gBAEA;gBACA;gBAAA;gBAAA,OACArI;kBACAC;kBACAvC;oBACAwC;oBACAoG;oBACAR;oBACAa;oBACAC;oBACAC;oBACAC;oBACAuB;kBACA;gBACA;cAAA;gBAZAtB;gBAcA3H;gBAAA,MAEA2H;kBAAA;kBAAA;gBAAA;gBACA3H;gBACAA;;gBAEA;gBACAkJ;gBACA;kBACAlJ;;kBAEA;kBACAD;oBACAU;oBACA0I;oBACAC;oBACAC;kBACA;gBACA;;gBAEA;gBACA;;gBAEA;gBACA;gBAAA,kCAEA;kBAAAtI;kBAAAzC;gBAAA;cAAA;gBAEA0B;gBACAA;;gBAEA;gBACA4H;gBACA;kBACA5H;;kBAEA;kBACAD;oBACAU;oBACA0I;oBACAC;oBACAE;oBACAD;oBACAtI;sBACA;wBACA;wBACAhB;0BACAO;wBACA;sBACA;oBACA;kBACA;gBACA;;gBAEA;gBAAA;gBAAA,OACA;cAAA;gBAAA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAN;;gBAEA;gBAAA;gBAAA,OACA;cAAA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAuJ;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAvJ;gBAAA;gBAAA,OAEAY;kBACAC;kBACAvC;oBACAwC;oBACAoG;oBACAR;oBACAa;oBACAC;oBACAC;oBACAC;oBACAuB;kBACA;gBACA;cAAA;gBAZAtB;gBAAA,MAcAA;kBAAA;kBAAA;gBAAA;gBACA3H;gBAAA,kCACA;kBAAAe;kBAAAzC;kBAAA4K;gBAAA;cAAA;gBAEAlJ;gBAAA,kCACA;kBAAAe;kBAAA+G;gBAAA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGA9H;gBAAA,kCACA;kBAAAe;kBAAA+G;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACA0B;MACA;QACA;QACAC,qDACAC;UACA1I;UACA2I;UACAZ;QAAA,GACA;;QAEA;QACA;UACAU;QACA;QAEA1J;QACAC;MACA;QACAA;MACA;IACA;IAEA;IACA4J;MACA;QACA;QACA;QAEA;UACAC;UACAA;;UAEA;UACAA;UAEA9J;UACAC;QACA;MACA;QACAA;MACA;IACA;IAIA;IACA8J;MACA;MACA;MACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC9jCA;AAAA;AAAA;AAAA;AAAm/B,CAAgB,68BAAG,EAAC,C;;;;;;;;;;;ACAvgC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/teacher-schedule/teacher-schedule.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/teacher-schedule/teacher-schedule.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./teacher-schedule.vue?vue&type=template&id=1c0141c6&scoped=true&\"\nvar renderjs\nimport script from \"./teacher-schedule.vue?vue&type=script&lang=js&\"\nexport * from \"./teacher-schedule.vue?vue&type=script&lang=js&\"\nimport style0 from \"./teacher-schedule.vue?vue&type=style&index=0&id=1c0141c6&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1c0141c6\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/teacher-schedule/teacher-schedule.vue\"\nexport default component.exports","export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./teacher-schedule.vue?vue&type=template&id=1c0141c6&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l1 =\n    _vm.selectedTeacher && !_vm.isLoading\n      ? _vm.__map(_vm.weekSchedule, function (day, idx) {\n          var $orig = _vm.__get_orig(day)\n          var m0 = _vm.formatDateWithWeek(day.course_date)\n          var l0 = _vm.__map(_vm.periods, function (i, __i0__) {\n            var $orig = _vm.__get_orig(i)\n            var m1 =\n              i === 5 || i === 6\n                ? _vm.getClassOptionIndex(day[\"course_slot_\" + i + \"_class\"])\n                : null\n            var m2 =\n              i === 5 || i === 6\n                ? _vm.getTypeIndex(day[\"course_slot_\" + i + \"_type\"])\n                : null\n            var m3 = !(i === 5 || i === 6)\n              ? _vm.getTypeIndex(day[\"course_slot_\" + i + \"_type\"])\n              : null\n            return {\n              $orig: $orig,\n              m1: m1,\n              m2: m2,\n              m3: m3,\n            }\n          })\n          return {\n            $orig: $orig,\n            m0: m0,\n            l0: l0,\n          }\n        })\n      : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l1: l1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./teacher-schedule.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./teacher-schedule.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"teacher-schedule-page\">\n    <!-- å›ºå®šè¿”å›æŒ‰é’® -->\n    <view class=\"back-btn-fixed\">\n      <button class=\"back-btn\" @click=\"goHome\">\n        <text class=\"back-btn-icon\">ğŸ </text>\n      </button>\n    </view>\n    \n    <!-- <view style=\"font-size:32rpx;color:#1976D2;font-weight:bold;margin:40rpx 0 30rpx 0;text-align:center;\">è¿™é‡Œæ˜¯æ•™å¸ˆæ’è¯¾é¡µé¢</view> -->\n    <view class=\"main-content\">\n        <view class=\"title-bar\">\n          <view class=\"page-title\">æ•™å¸ˆæ’è¯¾ç®¡ç†</view>\n        </view>\n\n        <view class=\"form-section card-bg\">\n          <view class=\"form-title\">æœç´¢å¹¶é€‰æ‹©æ•™å¸ˆ</view>\n          <input class=\"search-input\" v-model.trim=\"searchKeyword\" placeholder=\"ğŸ” è¾“å…¥æ•™å¸ˆå§“å\" />\n          <scroll-view scroll-y class=\"teacher-list-scroll\">\n            <view v-for=\"(teacher, idx) in filteredTeacherList\" :key=\"teacher.username\" class=\"teacher-item\" @click=\"selectTeacher(idx)\">\n              <text :class=\"['teacher-name', idx === teacherIndex ? 'selected' : '']\">{{ teacher.teacherName }}</text>\n            </view>\n          </scroll-view>\n        </view>\n\n        <view v-if=\"selectedTeacher\" class=\"card-bg courses-section\">\n          <view class=\"results-title\">{{ selectedTeacher.teacherName }} {{ weekTitle }}</view>\n          <view class=\"week-nav\">\n            <button class=\"week-btn\" @click=\"changeWeek(-1)\">ä¸Šä¸€å‘¨</button>\n            <text class=\"week-range\">{{ weekRangeText }}</text>\n            <button class=\"week-btn\" @click=\"changeWeek(1)\">ä¸‹ä¸€å‘¨</button>\n          </view>\n          <view v-if=\"isLoading\" class=\"loading-text\">è¯¾ç¨‹åŠ è½½ä¸­...</view>\n          <view v-else>\n            <!-- åªä¿ç•™æ¯ä¸€å¤©çš„è¯¦ç»†æ’è¯¾ï¼Œä¸å†æ¸²æŸ“å¤šä½™çš„æ—¥æœŸå’Œæ˜ŸæœŸ -->\n            <view v-for=\"(day, idx) in weekSchedule\" :key=\"day.course_date\" class=\"day-schedule-block\">\n              <view class=\"day-date\">{{ formatDateWithWeek(day.course_date) }}</view>\n              <view class=\"day-courses\">\n                <view v-for=\"i in periods\" :key=\"i\" class=\"course-row-vertical\">\n                  <view class=\"course-label-row\">\n                    {{ periodTimes[i-1] }}{{ (i === 5 || i === 6) ? 'ï¼ˆä¹ æƒ¯ç­ï¼‰' : '' }}\n                  </view>\n                  <view class=\"course-inputs-row\">\n                    <!-- ç¬¬5å’Œç¬¬6ä¸ªæ—¶é—´æ®µçš„ç‰¹æ®Šå¸ƒå±€ -->\n                    <template v-if=\"i === 5 || i === 6\">\n                      <!-- è¯¾ç¨‹åè¾“å…¥æ¡† -->\n                      <input :class=\"['course-input', day['course_slot_' + i] ? 'has-content' : '']\" v-model=\"day['course_slot_' + i]\" @focus=\"onInputFocus\" @input=\"onInputChange($event, idx, i, '')\" placeholder=\"è¯¾ç¨‹å\" />\n                      <!-- ç­çº§é€‰æ‹©å™¨ -->\n                      <picker class=\"class-picker\" @change=\"onClassOptionChange($event, idx, i)\" :value=\"getClassOptionIndex(day['course_slot_' + i + '_class'])\" :range=\"courseOptions\">\n                        <view class=\"class-display\">\n                          <text>{{ day['course_slot_' + i + '_class'] || 'è¯¾ç¨‹å' }}</text>\n                          <text class=\"class-arrow\">â–¼</text>\n                        </view>\n                      </picker>\n                      <!-- æ•™å®¤è¾“å…¥æ¡† -->\n                      <input :class=\"['course-input', 'location-input', day['course_slot_' + i + '_location'] ? 'has-content' : '']\" v-model=\"day['course_slot_' + i + '_location']\" @focus=\"onInputFocus\" @input=\"onInputChange($event, idx, i, 'location')\" placeholder=\"æ•™å®¤\" />\n                      <!-- ç­å‹é€‰æ‹©å™¨ -->\n                      <picker class=\"type-picker\" @change=\"onTypeChange($event, idx, i)\" :value=\"getTypeIndex(day['course_slot_' + i + '_type'])\" :range=\"courseTypes\">\n                        <view class=\"type-display\">\n                          <text>{{ day['course_slot_' + i + '_type'] || 'æ— ' }}</text>\n                          <text class=\"type-arrow\">â–¼</text>\n                        </view>\n                      </picker>\n                    </template>\n                    <!-- å…¶ä»–æ—¶é—´æ®µçš„åŸæœ‰å¸ƒå±€ -->\n                    <template v-else>\n                      <input :class=\"['course-input', day['course_slot_' + i] ? 'has-content' : '']\" v-model=\"day['course_slot_' + i]\" @focus=\"onInputFocus\" @input=\"onInputChange($event, idx, i, '')\" placeholder=\"è¯¾ç¨‹å\" />\n                      <input :class=\"['course-input', 'class-input', day['course_slot_' + i + '_class'] ? 'has-content' : '']\" v-model=\"day['course_slot_' + i + '_class']\" @focus=\"onInputFocus\" @input=\"onInputChange($event, idx, i, 'class')\" placeholder=\"ç­çº§\" />\n                      <input :class=\"['course-input', 'location-input', day['course_slot_' + i + '_location'] ? 'has-content' : '']\" v-model=\"day['course_slot_' + i + '_location']\" @focus=\"onInputFocus\" @input=\"onInputChange($event, idx, i, 'location')\" placeholder=\"æ•™å®¤\" />\n                      <picker class=\"type-picker\" @change=\"onTypeChange($event, idx, i)\" :value=\"getTypeIndex(day['course_slot_' + i + '_type'])\" :range=\"courseTypes\">\n                        <view class=\"type-display\">\n                          <text>{{ day['course_slot_' + i + '_type'] || 'æ— ' }}</text>\n                          <text class=\"type-arrow\">â–¼</text>\n                        </view>\n                      </picker>\n                    </template>\n                  </view>\n                  <!-- ç¬¬5å’Œç¬¬6ä¸ªæ—¶é—´æ®µä¸æ˜¾ç¤ºå¤‡æ³¨è¾“å…¥æ¡† -->\n                  <template v-if=\"i !== 5 && i !== 6\">\n                    <view v-if=\"day['course_slot_' + i + '_remark']\" class=\"course-remark-show\">å¤‡æ³¨ï¼š{{ day['course_slot_' + i + '_remark'] }}</view>\n                    <view class=\"course-remark-row\">\n                      <input :class=\"['course-remark-input', day['course_slot_' + i + '_remark'] ? 'has-content' : '']\" v-model=\"day['course_slot_' + i + '_remark']\" @focus=\"onInputFocus\" @input=\"onInputChange($event, idx, i, 'remark')\" placeholder=\"å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰\" />\n                    </view>\n                  </template>\n                </view>\n              </view>\n            </view>\n          </view>\n        </view>\n        <view class=\"save-btn-fixed\">\n          <button class=\"save-btn\" @click=\"saveSchedule\"><text class=\"icon\">ğŸ’¾</text>ä¿å­˜æ’è¯¾</button>\n        </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport { getCourseColor } from '../../utils/courseColor.js';\n\nfunction getMonday(date) {\n  const d = new Date(date)\n  // å§‹ç»ˆè¿”å›æœ¬å‘¨ä¸€ï¼ˆå‘¨ä¸€åˆ°å‘¨æ—¥ä¸ºä¸€ç»„ï¼‰ï¼Œç»ä¸åŒ…å«ä¸Šå‘¨æ—¥\n  d.setDate(d.getDate() - ((d.getDay() + 6) % 7));\n  d.setHours(0,0,0,0);\n  return d;\n}\nfunction formatDate(d) {\n  const year = d.getFullYear();\n  const month = (d.getMonth() + 1).toString().padStart(2, '0');\n  const day = d.getDate().toString().padStart(2, '0');\n  return `${year}-${month}-${day}`;\n}\nexport default {\n  data() {\n    return {\n      allTeacherList: [],\n      teacherIndex: -1,\n      searchKeyword: '',\n      selectedTeacher: null,\n      rawScheduleList: [], // Hold the raw schedule list from the cloud\n      weekSchedule: [], // This will hold the 7-day schedule for display and editing\n      isLoading: false,\n      weekOffset: 0,\n      initialScheduleState: '', // To check for changes\n      courseTypes: ['æ— ', 'ä¸€å¯¹ä¸€', 'ç­è¯¾', 'è„±äº§ç”Ÿ', 'ä¹ æƒ¯ç­'],\n      courseOptions: ['ä¸€å¹´çº§', 'äºŒå¹´çº§', 'ä¸‰å¹´çº§', 'å››å¹´çº§', 'äº”å¹´çº§', 'å…­å¹´çº§', 'ä¸ƒå¹´çº§', 'å…«å¹´çº§', 'ä¹å¹´çº§', 'é«˜ä¸€', 'èƒŒè¯µ'],\n      periods: [1, 2, 3, 4, 5, 6], // èŠ‚æ¬¡æ•°ç»„\n      periodTimes: [\n        '8:00-10:00',\n        '10:10-12:10',\n        '14:00-16:00',\n        '16:10-18:10',\n        '18:00-20:00',\n        '20:00-22:00'\n      ],\n      weekDaysOrder: [1, 2, 3, 4, 5, 6, 0], // å‘¨ä¸€åˆ°å‘¨æ—¥\n      currentDate: (function() {\n        const now = new Date();\n        now.setHours(0,0,0,0);\n        let dayOfWeek = now.getDay();\n        let day = dayOfWeek === 0 ? 6 : dayOfWeek - 1;\n        now.setDate(now.getDate() - day);\n        return now;\n      })(),\n    };\n  },\n  computed: {\n    filteredTeacherList() {\n      if (!this.searchKeyword) {\n        return this.allTeacherList;\n      }\n      return this.allTeacherList.filter(teacher =>\n        teacher.teacherName && teacher.teacherName.toLowerCase().includes(this.searchKeyword.toLowerCase())\n      );\n    },\n    weekTitle() {\n      return 'è¿™å‘¨è¯¾ç¨‹';\n    },\n    weekRangeText() {\n      const monday = this.getMondayOfWeek();\n      const sunday = new Date(monday);\n      sunday.setDate(monday.getDate() + 6);\n      return `${formatDate(monday)} ~ ${formatDate(sunday)}`;\n    }\n  },\n  watch: {\n    weekSchedule: {\n      handler(newVal) {\n        // å½“ weekSchedule å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè‡ªåŠ¨ä¿å­˜åˆ°ç¼“å­˜\n        if (this.selectedTeacher && newVal.length > 0) {\n          const teacherId = this.selectedTeacher._id;\n          const monday = this.getMondayOfWeek(this.currentDate);\n          const weekKey = formatDate(monday);\n          const cacheKey = 'teacherScheduleCache_' + teacherId + '_' + weekKey;\n          uni.setStorageSync(cacheKey, newVal);\n          console.log('æ•°æ®å·²è‡ªåŠ¨ä¿å­˜åˆ°ç¼“å­˜');\n        }\n      },\n      deep: true\n    }\n  },\n  onShow() {\n    console.log('ğŸ“± é¡µé¢æ˜¾ç¤ºï¼Œå¼€å§‹åˆå§‹åŒ–...');\n    \n    // è·å–ç”¨æˆ·ä¿¡æ¯\n    const userInfo = uni.getStorageSync('userInfo');\n    let teacherId = '';\n    \n    // æ£€æŸ¥æ˜¯å¦æœ‰é€‰ä¸­çš„æ•™å¸ˆ\n    if (this.selectedTeacher && this.selectedTeacher._id) {\n      teacherId = this.selectedTeacher._id;\n      console.log('ğŸ‘¤ ä½¿ç”¨å·²é€‰ä¸­çš„æ•™å¸ˆID:', teacherId);\n    } else if (userInfo && userInfo._id) {\n      teacherId = userInfo._id;\n      console.log('ğŸ‘¤ ä½¿ç”¨å½“å‰ç”¨æˆ·IDä½œä¸ºæ•™å¸ˆID:', teacherId);\n    }\n    \n    console.log('ğŸ‘¤ å½“å‰æ•™å¸ˆID:', teacherId);\n    \n    // è®¾ç½®å½“å‰æ—¥æœŸä¸ºæœ¬å‘¨ä¸€\n    this.currentDate = this.getMondayOfWeek(new Date());\n    const monday = this.currentDate;\n    const weekKey = formatDate(monday);\n    \n    console.log('ğŸ“… å½“å‰å‘¨:', weekKey);\n    \n    // æ£€æŸ¥æ˜¯å¦æœ‰ç¼“å­˜æ•°æ®\n    const cacheKey = 'teacherScheduleCache_' + teacherId + '_' + weekKey;\n    const cached = uni.getStorageSync(cacheKey);\n    \n    if (cached && Array.isArray(cached) && cached.length === 7) {\n      console.log('ğŸ“¦ å‘ç°ç¼“å­˜æ•°æ®ï¼Œé•¿åº¦:', cached.length);\n      // å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œå…ˆä½¿ç”¨ç¼“å­˜ï¼Œç„¶åå¼‚æ­¥æ›´æ–°\n      this.weekSchedule = cached;\n      \n      // å¼‚æ­¥è·å–æœ€æ–°æ•°æ®\n      setTimeout(() => {\n        if (this.selectedTeacher) {\n          console.log('ğŸ”„ å¼‚æ­¥æ›´æ–°æ•°æ®...');\n          this.fetchTeacherSchedule();\n        }\n      }, 100);\n    } else {\n      console.log('ğŸ†• æ— ç¼“å­˜æ•°æ®ï¼Œæ„å»ºæ–°çš„å‘¨è®¡åˆ’');\n      this.buildWeekSchedule();\n    }\n    \n    // æ£€æŸ¥æƒé™å¹¶è·å–æ•™å¸ˆåˆ—è¡¨\n    this.checkAdminRoleAndFetchTeachers();\n  },\n  onUnload() {\n    const fromService = uni.getStorageSync('fromService');\n    if (fromService) {\n      uni.switchTab({ url: '/pages/service/service' });\n      uni.removeStorageSync('fromService');\n    }\n  },\n  methods: {\n    checkAdminRoleAndFetchTeachers() {\n      const userInfo = uni.getStorageSync('userInfo');\n      const isAdmin = (userInfo && userInfo.role && userInfo.role.includes('ç®¡ç†å‘˜')) || userInfo.permission === 'ç®¡ç†å‘˜';\n      const isSuperAdmin = userInfo && userInfo.permission === 'superadmin';\n      const hasScheduleFeature = userInfo && userInfo.featureList && userInfo.featureList.includes('schedule');\n      if (isAdmin || isSuperAdmin || hasScheduleFeature) {\n        this.fetchTeachers();\n      } else {\n        uni.showToast({ title: 'æ— æƒé™è®¿é—®', icon: 'none' });\n        setTimeout(() => {\n          uni.reLaunch({ url: '/pages/home/home' });\n        }, 1200);\n        return;\n      }\n    },\n    fetchTeachers() {\n      uniCloud.callFunction({\n        name: 'user-center',\n        data: { action: 'get-accounts' },\n        success: async (res) => {\n          const result = res.result;\n          if (result.code === 200 && result.data) {\n            // Also filter for users with the 'æ•™å¸ˆ' role here\n            this.allTeacherList = result.data.filter(acc => acc.role && acc.role.includes('æ•™å¸ˆ'));\n            \n            // ä¸ºæ¯ä¸ªæ•™å¸ˆè·å–openidä¿¡æ¯\n            await this.enrichTeachersWithOpenid();\n            \n             if (this.allTeacherList.length > 0) {\n                this.selectTeacher(0);\n            } else {\n\t\t\t\tuni.showToast({ title: 'æš‚æ— æ•™å¸ˆä¿¡æ¯', icon: 'none' });\n\t\t\t}\n          } else {\n            uni.showToast({ title: 'è·å–æ•™å¸ˆåˆ—è¡¨å¤±è´¥: ' + (result.message || 'æœªçŸ¥é”™è¯¯'), icon: 'none' });\n          }\n        },\n        fail: (err) => {\n          uni.showToast({ title: 'è·å–æ•™å¸ˆåˆ—è¡¨è¯·æ±‚å¤±è´¥', icon: 'none' });\n        }\n      });\n    },\n    \n    // ä¸ºæ•™å¸ˆåˆ—è¡¨è¡¥å……openidä¿¡æ¯\n    async enrichTeachersWithOpenid() {\n      try {\n        console.log('ğŸ” å¼€å§‹è¡¥å……æ•™å¸ˆopenidä¿¡æ¯...');\n        \n        for (let i = 0; i < this.allTeacherList.length; i++) {\n          const teacher = this.allTeacherList[i];\n          try {\n            // è°ƒç”¨äº‘å‡½æ•°è·å–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ï¼ˆåŒ…å«openidï¼‰\n            const userResult = await uniCloud.callFunction({\n              name: 'user-center',\n              data: {\n                action: 'get-user-detail',\n                params: { userId: teacher._id }\n              }\n            });\n            \n            if (userResult.result && userResult.result.code === 200) {\n              const userDetail = userResult.result.data;\n              if (userDetail.openid) {\n                this.allTeacherList[i].openid = userDetail.openid;\n                console.log(`âœ… æ•™å¸ˆ ${teacher.teacherName || teacher.username} openid è·å–æˆåŠŸ`);\n              } else {\n                console.log(`âš ï¸ æ•™å¸ˆ ${teacher.teacherName || teacher.username} æ²¡æœ‰openid`);\n              }\n            }\n          } catch (error) {\n            console.error(`âŒ è·å–æ•™å¸ˆ ${teacher.teacherName || teacher.username} openid å¤±è´¥:`, error);\n          }\n        }\n        \n        console.log('âœ… æ•™å¸ˆopenidä¿¡æ¯è¡¥å……å®Œæˆ');\n      } catch (error) {\n        console.error('âŒ è¡¥å……æ•™å¸ˆopenidä¿¡æ¯å¤±è´¥:', error);\n      }\n    },\n    selectTeacher(idx) {\n      console.log('ğŸ‘¤ é€‰æ‹©æ•™å¸ˆï¼Œç´¢å¼•:', idx);\n      this.teacherIndex = idx;\n      this.selectedTeacher = this.filteredTeacherList[idx];\n      console.log('é€‰ä¸­çš„æ•™å¸ˆ:', this.selectedTeacher);\n      \n      // é‡ç½®å½“å‰æ—¥æœŸä¸ºæœ¬å‘¨ä¸€\n      this.currentDate = this.getMondayOfWeek(new Date());\n      \n      // æ¸…ç©ºä¹‹å‰çš„æ•°æ®å’Œç¼“å­˜\n      this.rawScheduleList = [];\n      this.weekSchedule = [];\n      this.initialScheduleState = '';\n      \n      console.log('ğŸ”„ å¼€å§‹è·å–é€‰ä¸­æ•™å¸ˆçš„è¯¾è¡¨...');\n      this.fetchTeacherSchedule();\n    },\n    fetchTeacherSchedule() {\n      if (!this.selectedTeacher) return;\n      this.isLoading = true;\n      \n      // ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„æ•™å¸ˆID\n      const teacherId = this.selectedTeacher._id;\n      const monday = this.getMondayOfWeek();\n      const sunday = new Date( monday );\n      sunday.setDate(monday.getDate() + 6);\n      \n      console.log('ğŸ” å¼€å§‹è·å–æ•™å¸ˆè¯¾è¡¨æ•°æ®...');\n      console.log('é€‰ä¸­çš„æ•™å¸ˆ:', this.selectedTeacher);\n      console.log('æ•™å¸ˆID:', teacherId);\n      console.log('æŸ¥è¯¢æ—¥æœŸèŒƒå›´:', formatDate(monday), 'åˆ°', formatDate(sunday));\n      \n      uniCloud.callFunction({\n        name: 'schedule-center',\n        data: {\n          action: 'getSchedulesByTeacher',\n          params: {\n            teacher_id: teacherId,\n            startDate: formatDate(monday),\n            endDate: formatDate(sunday)\n          }\n        },\n        success: (res) => {\n          console.log('ğŸ“¡ äº‘å‡½æ•°è¿”å›ç»“æœ:', res);\n          const result = res.result;\n          if (result.code === 200 && result.data) {\n            console.log('âœ… è·å–è¯¾è¡¨æ•°æ®æˆåŠŸï¼Œæ•°æ®æ¡æ•°:', result.data.length);\n            console.log('åŸå§‹æ•°æ®:', result.data);\n            this.rawScheduleList = result.data;\n            \n            // å¼ºåˆ¶é‡æ–°æ„å»ºå‘¨è®¡åˆ’ï¼Œä¸ä½¿ç”¨ç¼“å­˜\n            this.buildWeekSchedule();\n            \n            // ä¿å­˜åˆ°ç¼“å­˜ï¼ˆç”¨äºåç»­ç¼–è¾‘ï¼‰\n            const weekKey = formatDate(monday);\n            const cacheKey = 'teacherScheduleCache_' + teacherId + '_' + weekKey;\n            uni.setStorageSync(cacheKey, this.weekSchedule);\n            console.log('âœ… æ–°æ•°æ®å·²ä¿å­˜åˆ°ç¼“å­˜');\n          } else {\n            console.error('âŒ è·å–è¯¾è¡¨æ•°æ®å¤±è´¥:', result.message || 'æœªçŸ¥é”™è¯¯');\n            this.rawScheduleList = [];\n            this.buildWeekSchedule();\n          }\n        },\n        fail: (err) => {\n          console.error('âŒ è¯·æ±‚å¤±è´¥:', err);\n          this.rawScheduleList = [];\n          this.buildWeekSchedule();\n        },\n        complete: () => {\n          this.isLoading = false;\n          console.log('ğŸ è¯¾è¡¨è·å–å®Œæˆ');\n        }\n      });\n    },\n    buildWeekSchedule() {\n      // å¼ºåˆ¶ currentDate å½’åˆ°æœ¬å‘¨ä¸€\n      this.currentDate = this.getMondayOfWeek(this.currentDate);\n      const monday = this.currentDate;\n      console.log('ğŸ”¨ å¼€å§‹æ„å»ºå‘¨è®¡åˆ’...');\n      console.log('å½“å‰æ—¥æœŸ:', this.currentDate);\n      console.log('å‘¨ä¸€æ—¥æœŸ:', monday);\n      console.log('åŸå§‹æ•°æ®åˆ—è¡¨:', this.rawScheduleList);\n      \n      this.weekSchedule = [];\n      const newWeekSchedule = [];\n      \n      for (let i = 0; i < 7; i++) {\n        const d = new Date(monday.getTime() + i * 24 * 60 * 60 * 1000);\n        const dateStr = formatDate(d);\n        console.log(`ğŸ“… å¤„ç†ç¬¬${i}å¤©ï¼Œæ—¥æœŸ: ${dateStr}`);\n        \n        let daySchedule = {\n          course_date: dateStr,\n          course_slot_1: '', course_slot_1_type: 'æ— ', course_slot_1_class: '', course_slot_1_location: '', course_slot_1_remark: '',\n          course_slot_2: '', course_slot_2_type: 'æ— ', course_slot_2_class: '', course_slot_2_location: '', course_slot_2_remark: '',\n          course_slot_3: '', course_slot_3_type: 'æ— ', course_slot_3_class: '', course_slot_3_location: '', course_slot_3_remark: '',\n          course_slot_4: '', course_slot_4_type: 'æ— ', course_slot_4_class: '', course_slot_4_location: '', course_slot_4_remark: '',\n          course_slot_5: '', course_slot_5_type: 'æ— ', course_slot_5_class: '', course_slot_5_location: '', course_slot_5_remark: '',\n          course_slot_6: '', course_slot_6_type: 'æ— ', course_slot_6_class: '', course_slot_6_location: '', course_slot_6_remark: '',\n        };\n        \n        // æŸ¥æ‰¾å½“å¤©çš„è¯¾ç¨‹æ•°æ®\n        const coursesForDay = this.rawScheduleList.filter(course => {\n          let courseDate = course.date;\n          if (typeof courseDate === 'string' && courseDate.length >= 10) {\n            courseDate = courseDate.slice(0, 10);\n          } else if (courseDate instanceof Date) {\n            courseDate = formatDate(courseDate);\n          }\n          const isMatch = courseDate === dateStr;\n          console.log(`  è¯¾ç¨‹æ—¥æœŸ: ${courseDate}, åŒ¹é…: ${isMatch}`);\n          return isMatch;\n        });\n        \n        console.log(`  æ‰¾åˆ° ${coursesForDay.length} é—¨è¯¾ç¨‹`);\n        \n        // å°†è¯¾ç¨‹æ•°æ®æ˜ å°„åˆ°å¯¹åº”çš„æ—¶é—´æ®µ\n        coursesForDay.forEach(course => {\n          console.log(`  ğŸ“š å¤„ç†è¯¾ç¨‹: ${course.course_name}, æ—¶é—´æ®µ: ${course.start_period}`);\n          \n          if (course.start_period < 1 || course.start_period > 6) {\n            console.log(`    âš ï¸ æ—¶é—´æ®µè¶…å‡ºèŒƒå›´: ${course.start_period}`);\n            return;\n          }\n          \n          const slotIndex = course.start_period;\n          if (slotIndex >= 1 && slotIndex <= 6) {\n            daySchedule[`course_slot_${slotIndex}`] = course.course_name || '';\n            daySchedule[`course_slot_${slotIndex}_type`] = course.course_type || 'æ— ';\n            daySchedule[`course_slot_${slotIndex}_class`] = course.class_name || '';\n            daySchedule[`course_slot_${slotIndex}_location`] = course.location || '';\n            daySchedule[`course_slot_${slotIndex}_remark`] = course.remark || '';\n            \n            console.log(`    âœ… å·²æ˜ å°„åˆ°ç¬¬${slotIndex}èŠ‚è¯¾:`, {\n              è¯¾ç¨‹å: course.course_name,\n              ç±»å‹: course.course_type,\n              ç­çº§: course.class_name,\n              æ•™å®¤: course.location,\n              å¤‡æ³¨: course.remark\n            });\n          }\n        });\n        \n        newWeekSchedule.push(daySchedule);\n        console.log(`  ğŸ“‹ ç¬¬${i}å¤©è¯¾è¡¨:`, daySchedule);\n      }\n      \n      this.weekSchedule = newWeekSchedule;\n      this.initialScheduleState = JSON.stringify(this.weekSchedule);\n      \n      console.log('ğŸ¯ å‘¨è®¡åˆ’æ„å»ºå®Œæˆ:');\n      console.log('æ—¥æœŸåˆ—è¡¨:', this.weekSchedule.map(d => d.course_date));\n      console.log('ç¬¬ä¸€å¤©æ•°æ®ç»“æ„:', this.weekSchedule[0]);\n      \n      // å¼ºåˆ¶æ›´æ–°è§†å›¾\n      this.$forceUpdate();\n    },\n    getMondayOfWeek(date = this.currentDate) {\n      const now = new Date(date);\n      now.setHours(0,0,0,0);\n      let dayOfWeek = now.getDay();\n      let day = dayOfWeek === 0 ? 6 : dayOfWeek - 1;\n      now.setDate(now.getDate() - day);\n      return now;\n    },\n    onInputChange(event, dayIndex, slot, field) {\n      const key = field ? `course_slot_${slot}_${field}` : `course_slot_${slot}`;\n      const value = event.detail.value;\n      console.log('è¾“å…¥äº‹ä»¶è§¦å‘:', { dayIndex, slot, field, value, event: event });\n      \n      // ç›´æ¥æ›´æ–°æ•°æ®\n      if (this.weekSchedule[dayIndex]) {\n        this.weekSchedule[dayIndex][key] = value;\n        console.log('æ•°æ®å·²æ›´æ–°:', { dayIndex, slot, field, value, key });\n        \n        // ç«‹å³ä¿å­˜åˆ°ç¼“å­˜\n        const teacherId = this.selectedTeacher ? this.selectedTeacher._id : '';\n        const monday = this.getMondayOfWeek(this.currentDate);\n        const weekKey = formatDate(monday);\n        const cacheKey = 'teacherScheduleCache_' + teacherId + '_' + weekKey;\n        uni.setStorageSync(cacheKey, this.weekSchedule);\n        console.log('æ•°æ®å·²ä¿å­˜åˆ°ç¼“å­˜');\n      }\n    },\n    onTypeChange(event, dayIndex, slot) {\n      if (this.weekSchedule[dayIndex]) {\n        this.weekSchedule[dayIndex][`course_slot_${slot}_type`] = this.courseTypes[event.detail.value];\n        console.log('ç±»å‹å˜åŒ–:', { dayIndex, slot, value: this.courseTypes[event.detail.value] });\n        // ç¼“å­˜\n        const teacherId = this.selectedTeacher ? this.selectedTeacher._id : '';\n        const monday = this.getMondayOfWeek(this.currentDate);\n        const weekKey = formatDate(monday);\n        const cacheKey = 'teacherScheduleCache_' + teacherId + '_' + weekKey;\n        uni.setStorageSync(cacheKey, this.weekSchedule);\n      }\n    },\n    getTypeIndex(type) {\n      return this.courseTypes.indexOf(type);\n    },\n    getCourseOptionIndex(option) {\n      return this.courseOptions.indexOf(option);\n    },\n    getClassOptionIndex(option) {\n      return this.courseOptions.indexOf(option);\n    },\n    onCourseOptionChange(event, dayIndex, slot) {\n      if (this.weekSchedule[dayIndex]) {\n        this.weekSchedule[dayIndex][`course_slot_${slot}`] = this.courseOptions[event.detail.value];\n        console.log('è¯¾ç¨‹é€‰é¡¹å˜åŒ–:', { dayIndex, slot, value: this.courseOptions[event.detail.value] });\n        // ç¼“å­˜\n        const teacherId = this.selectedTeacher ? this.selectedTeacher._id : '';\n        const monday = this.getMondayOfWeek(this.currentDate);\n        const weekKey = formatDate(monday);\n        const cacheKey = 'teacherScheduleCache_' + teacherId + '_' + weekKey;\n        uni.setStorageSync(cacheKey, this.weekSchedule);\n      }\n    },\n    onClassOptionChange(event, dayIndex, slot) {\n      if (this.weekSchedule[dayIndex]) {\n        const selectedValue = this.courseOptions[event.detail.value];\n        this.weekSchedule[dayIndex][`course_slot_${slot}_class`] = selectedValue;\n        \n        // æ¯æ¬¡é€‰æ‹©ç¬¬äºŒä¸ªè¾“å…¥æ¡†æ—¶ï¼Œéƒ½è‡ªåŠ¨æ›´æ–°ç¬¬ä¸€ä¸ªè¾“å…¥æ¡†çš„å†…å®¹\n        this.weekSchedule[dayIndex][`course_slot_${slot}`] = selectedValue;\n        \n        console.log('ç­çº§é€‰é¡¹å˜åŒ–:', { dayIndex, slot, value: selectedValue });\n        // ç¼“å­˜\n        const teacherId = this.selectedTeacher ? this.selectedTeacher._id : '';\n        const monday = this.getMondayOfWeek(this.currentDate);\n        const weekKey = formatDate(monday);\n        const cacheKey = 'teacherScheduleCache_' + teacherId + '_' + weekKey;\n        uni.setStorageSync(cacheKey, this.weekSchedule);\n      }\n    },\n    changeWeek(offset) {\n      console.log('ğŸ“… åˆ‡æ¢å‘¨ï¼Œåç§»é‡:', offset);\n      const monday = this.getMondayOfWeek(this.currentDate);\n      monday.setDate(monday.getDate() + offset * 7);\n      this.currentDate = monday;\n      \n      console.log('æ–°çš„å½“å‰æ—¥æœŸ:', this.currentDate);\n      \n      // æ¸…ç©ºå½“å‰æ•°æ®\n      this.rawScheduleList = [];\n      this.weekSchedule = [];\n      \n      // æ£€æŸ¥æ˜¯å¦æœ‰ç¼“å­˜æ•°æ®\n      const teacherId = this.selectedTeacher ? this.selectedTeacher._id : '';\n      const weekKey = formatDate(monday);\n      const cacheKey = 'teacherScheduleCache_' + teacherId + '_' + weekKey;\n      const cached = uni.getStorageSync(cacheKey);\n      \n      if (cached && Array.isArray(cached) && cached.length === 7) {\n        console.log('ğŸ“¦ å‘ç°ç¼“å­˜æ•°æ®ï¼Œé•¿åº¦:', cached.length);\n        this.weekSchedule = cached;\n        \n        // å¼‚æ­¥è·å–æœ€æ–°æ•°æ®\n        setTimeout(() => {\n          if (this.selectedTeacher) {\n            console.log('ğŸ”„ å¼‚æ­¥æ›´æ–°æ•°æ®...');\n            this.fetchTeacherSchedule();\n          }\n        }, 100);\n      } else {\n        console.log('ğŸ†• æ— ç¼“å­˜æ•°æ®ï¼Œé‡æ–°è·å–æ•°æ®');\n        if (this.selectedTeacher) {\n          this.fetchTeacherSchedule();\n        } else {\n          this.buildWeekSchedule();\n        }\n      }\n    },\n    saveSchedule() {\n      const changes = this.weekSchedule.map(day => ({\n        ...day,\n        teacher_id: this.selectedTeacher._id,\n        uid: this.selectedTeacher._id, // ç¡®ä¿uidä¹Ÿè¢«ä¼ é€’\n        username: this.selectedTeacher.username\n      }));\n\n      // è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ä½œä¸ºç®¡ç†å‘˜\n      const userInfo = uni.getStorageSync('userInfo');\n      const adminName = userInfo.realName || userInfo.username || 'ç®¡ç†å‘˜';\n\n      uniCloud.callFunction({\n        name: 'schedule-center',\n        data: {\n          action: 'updateSchedules',\n          params: { \n            schedules: changes,\n            adminName: adminName\n          }\n        },\n        success: async (res) => {\n          if (res.result.code === 200) {\n            uni.showToast({ title: 'æ’è¯¾ä¿å­˜æˆåŠŸ!', icon: 'success' });\n            \n            // ä¿å­˜æœ€æ–° weekSchedule åˆ°ç¼“å­˜\n            const teacherId = this.selectedTeacher ? this.selectedTeacher._id : '';\n            const monday = this.getMondayOfWeek(this.currentDate);\n            const weekKey = formatDate(monday);\n            const cacheKey = 'teacherScheduleCache_' + teacherId + '_' + weekKey;\n            uni.setStorageSync(cacheKey, this.weekSchedule);\n            \n            // å‘é€è®¢é˜…æ¶ˆæ¯é€šçŸ¥\n            await this.sendScheduleNotifications(changes);\n            \n            this.fetchTeacherSchedule();\n          } else {\n            uni.showToast({ title: 'ä¿å­˜å¤±è´¥: ' + res.result.message, icon: 'none' });\n          }\n        },\n        fail: (err) => {\n          uni.showToast({ title: 'ä¿å­˜è¯·æ±‚å¤±è´¥', icon: 'none' });\n        }\n      });\n    },\n    \n    // å‘é€æ’è¯¾è®¢é˜…æ¶ˆæ¯é€šçŸ¥ - åªå‘é€æœ€æ–°æ’è¯¾çš„è¯¾ç¨‹é€šçŸ¥\n    async sendScheduleNotifications(schedules) {\n      try {\n        console.log('å¼€å§‹å‘é€æ’è¯¾è®¢é˜…æ¶ˆæ¯é€šçŸ¥...');\n        \n        // è·å–å½“å‰é€‰ä¸­çš„æ•™å¸ˆID\n        const currentTeacherId = this.selectedTeacher._id;\n        \n        // æ‰¾åˆ°æœ€æ–°æ’è¯¾çš„è¯¾ç¨‹ï¼ˆæ ¹æ®æ—¥æœŸå’Œæ—¶é—´æ®µæ’åºï¼Œæ‰¾åˆ°æœ€æ™šçš„è¯¾ç¨‹ï¼‰\n        let latestCourse = null;\n        let latestCourseInfo = null;\n        let latestDateTime = null;\n        \n        // éå†æ‰€æœ‰æ’è¯¾æ•°æ®ï¼Œæ‰¾åˆ°æœ€æ™šçš„è¯¾ç¨‹\n        for (const schedule of schedules) {\n          const { course_date, uid, username } = schedule;\n          \n          // åªå¤„ç†å½“å‰é€‰ä¸­æ•™å¸ˆçš„è¯¾ç¨‹\n          if (uid !== currentTeacherId) {\n            console.log(`è·³è¿‡éå½“å‰æ•™å¸ˆçš„è¯¾ç¨‹: ${uid} vs ${currentTeacherId}`);\n            continue;\n          }\n          \n          // æ£€æŸ¥æ¯èŠ‚è¯¾æ˜¯å¦æœ‰è¯¾ç¨‹æ•°æ®\n          for (let j = 1; j <= 6; j++) {\n            const courseKey = `course_slot_${j}`;\n            const typeKey = `course_slot_${j}_type`;\n            const classKey = `course_slot_${j}_class`;\n            const locationKey = `course_slot_${j}_location`;\n            \n            const courseName = schedule[courseKey];\n            const courseType = schedule[typeKey];\n            const className = schedule[classKey];\n            const location = schedule[locationKey];\n            \n            // å¦‚æœæ‰¾åˆ°æœ‰è¯¾ç¨‹æ•°æ®çš„èŠ‚æ¬¡ï¼Œè®¡ç®—æ—¥æœŸæ—¶é—´å¹¶æ¯”è¾ƒ\n            if (courseName && courseName.trim() !== '') {\n              // è®¡ç®—è¿™èŠ‚è¯¾çš„å…·ä½“æ—¶é—´\n              const courseDateTime = new Date(`${course_date} ${this.getSlotStartTime(j)}`);\n              \n              // å¦‚æœè¿™ä¸ªè¯¾ç¨‹æ—¶é—´æ›´æ™šï¼Œæ›´æ–°ä¸ºæœ€æ–°è¯¾ç¨‹\n              if (!latestDateTime || courseDateTime > latestDateTime) {\n                latestDateTime = courseDateTime;\n                latestCourse = schedule;\n                latestCourseInfo = {\n                  courseName,\n                  courseType,\n                  className,\n                  location,\n                  date: course_date,\n                  slot: j\n                };\n                console.log(`æ‰¾åˆ°æ›´æ™šçš„è¯¾ç¨‹:`, latestCourseInfo, `æ—¶é—´:`, courseDateTime);\n              }\n            }\n          }\n        }\n        \n        // å¦‚æœæ‰¾åˆ°äº†æœ€æ–°è¯¾ç¨‹ï¼Œåªå‘é€è¿™ä¸€æ¡è®¢é˜…æ¶ˆæ¯\n        if (latestCourse && latestCourseInfo) {\n          console.log(`å‡†å¤‡å‘é€æœ€æ–°æ’è¯¾è¯¾ç¨‹çš„è®¢é˜…æ¶ˆæ¯:`, latestCourseInfo);\n          \n          // æ£€æŸ¥ openid ä¿¡æ¯\n          const teacherOpenid = this.selectedTeacher.openid || '';\n          console.log('æ•™å¸ˆopenidä¿¡æ¯:', {\n            teacherId: this.selectedTeacher._id,\n            teacherName: this.selectedTeacher.teacherName || this.selectedTeacher.username,\n            openid: teacherOpenid,\n            hasOpenid: !!teacherOpenid,\n            openidType: teacherOpenid ? (teacherOpenid.startsWith('mock_') ? 'æµ‹è¯•æ¨¡å¼' : teacherOpenid.startsWith('temp_') ? 'ä¸´æ—¶æ¨¡å¼' : 'çœŸå®openid') : 'æ— openid'\n          });\n          \n          if (!teacherOpenid) {\n            console.log(`âš ï¸ æ•™å¸ˆ ${this.selectedTeacher.teacherName || this.selectedTeacher.username} æ²¡æœ‰openidï¼Œè·³è¿‡è®¢é˜…æ¶ˆæ¯å‘é€`);\n            return;\n          }\n          \n          if (teacherOpenid.startsWith('mock_') || teacherOpenid.startsWith('temp_')) {\n            console.log(`âš ï¸ æ•™å¸ˆ ${this.selectedTeacher.teacherName || this.selectedTeacher.username} ä½¿ç”¨æµ‹è¯•openid: ${teacherOpenid}ï¼Œè·³è¿‡è®¢é˜…æ¶ˆæ¯å‘é€`);\n            return;\n          }\n          \n          // è°ƒç”¨è®¢é˜…æ¶ˆæ¯äº‘å‡½æ•°\n          try {\n            // å…ˆæ£€æŸ¥æ˜¯å¦æœ‰ä¼šè¯è®¢é˜…\n            const hasSessionSubscription = this.checkSessionSubscription(teacherOpenid);\n            \n            if (hasSessionSubscription) {\n              console.log('âœ… ä½¿ç”¨ä¼šè¯è®¢é˜…å‘é€æ’è¯¾é€šçŸ¥ï¼Œé¿å…å¾®ä¿¡APIé™åˆ¶');\n              \n              // ä½¿ç”¨ä¼šè¯è®¢é˜…å‘é€ï¼ˆæ¨¡æ‹Ÿå‘é€ï¼‰\n              const sessionResult = await this.sendScheduleNotificationWithSession({\n                ...latestCourseInfo,\n                openid: teacherOpenid\n              });\n              \n              if (sessionResult.success) {\n                console.log(`æœ€æ–°æ’è¯¾è¯¾ç¨‹ä¼šè¯è®¢é˜…æ¶ˆæ¯å‘é€æˆåŠŸ: ${latestCourseInfo.courseName}`);\n              } else {\n                console.log(`ä¼šè¯è®¢é˜…æ¶ˆæ¯å‘é€å¤±è´¥: ${sessionResult.error}`);\n              }\n            } else {\n              console.log('ğŸ“± ä½¿ç”¨å¾®ä¿¡APIå‘é€è®¢é˜…æ¶ˆæ¯');\n              \n              // ä½¿ç”¨ä¼ ç»Ÿå¾®ä¿¡APIå‘é€\n              const subscriptionResult = await uniCloud.callFunction({\n                name: 'subscription-message',\n                data: {\n                  action: 'send-schedule-notification',\n                  openid: this.selectedTeacher.openid || '',\n                  courseName: latestCourseInfo.courseName,\n                  classTime: this.formatClassTime(latestCourseInfo.date, latestCourseInfo.slot),\n                  remark: (latestCourseInfo.location || 'æœªæŒ‡å®š') + 'æ•™å®¤',  // è‡ªåŠ¨åŠ ä¸Š\"æ•™å®¤\"ä¸¤ä¸ªå­—\n                  studentName: latestCourseInfo.courseType || 'æœªæŒ‡å®šç±»å‹',\n                  page: 'pages/schedule-tab/schedule-tab'\n                }\n              });\n              \n              if (subscriptionResult.result && subscriptionResult.result.code === 200) {\n                console.log(`æœ€æ–°æ’è¯¾è¯¾ç¨‹è®¢é˜…æ¶ˆæ¯å‘é€æˆåŠŸ: ${latestCourseInfo.courseName}`);\n              } else {\n                const errorDetail = subscriptionResult.result && subscriptionResult.result.error ? subscriptionResult.result.error : '';\n                console.log(`æœ€æ–°æ’è¯¾è¯¾ç¨‹è®¢é˜…æ¶ˆæ¯å‘é€å¤±è´¥:`, {\n                  message: subscriptionResult.result && subscriptionResult.result.message ? subscriptionResult.result.message : '',\n                  error: errorDetail,\n                  code: subscriptionResult.result && subscriptionResult.result.code ? subscriptionResult.result.code : ''\n                });\n                \n                // æ£€æŸ¥æ˜¯å¦æ˜¯43101é”™è¯¯ï¼ˆç”¨æˆ·æ‹’ç»æ¥æ”¶ï¼‰\n                if (errorDetail && errorDetail.includes('43101')) {\n                  console.log(`âš ï¸ è¯¾ç¨‹ \"${latestCourseInfo.courseName}\" è®¢é˜…æ¶ˆæ¯è¢«ç”¨æˆ·æ‹’ç»ï¼Œéœ€è¦é‡æ–°æˆæƒ`);\n                  \n                  // å°è¯•åˆ›å»ºä¼šè¯è®¢é˜…ï¼Œé¿å…åç»­é”™è¯¯\n                  this.createSessionSubscriptionForTeacher(teacherOpenid);\n                }\n              }\n            }\n          } catch (subscriptionError) {\n            console.error(`æœ€æ–°æ’è¯¾è¯¾ç¨‹è®¢é˜…æ¶ˆæ¯å‘é€å¤±è´¥:`, subscriptionError);\n          }\n        } else {\n          console.log('æœªæ‰¾åˆ°éœ€è¦å‘é€è®¢é˜…æ¶ˆæ¯çš„è¯¾ç¨‹');\n        }\n        \n        console.log('æ’è¯¾è®¢é˜…æ¶ˆæ¯é€šçŸ¥å‘é€å®Œæˆ');\n      } catch (error) {\n        console.error('å‘é€æ’è¯¾è®¢é˜…æ¶ˆæ¯é€šçŸ¥å¤±è´¥:', error);\n      }\n    },\n    \n    // è·å–æŒ‡å®šæ—¶é—´æ®µçš„å¼€å§‹æ—¶é—´\n    getSlotStartTime(slotIndex) {\n      const periodStartTimes = [\n        '08:00',  // ç¬¬1èŠ‚è¯¾ 8:00-10:00\n        '10:10',  // ç¬¬2èŠ‚è¯¾ 10:10-12:10\n        '14:00',  // ç¬¬3èŠ‚è¯¾ 14:00-16:00\n        '16:10',  // ç¬¬4èŠ‚è¯¾ 16:10-18:10\n        '18:00',  // ç¬¬5èŠ‚è¯¾ 18:00-20:00\n        '20:00'   // ç¬¬6èŠ‚è¯¾ 20:00-22:00\n      ];\n      \n      return periodStartTimes[slotIndex - 1] || '08:00';\n    },\n    \n    // æ ¼å¼åŒ–ä¸Šè¯¾æ—¶é—´ - ä¿®å¤ä¸ºå¾®ä¿¡è®¢é˜…æ¶ˆæ¯è¦æ±‚çš„æ ‡å‡†æ ¼å¼\n    formatClassTime(dateStr, slotIndex) {\n      const dateObj = new Date(dateStr);\n      \n      // å¾®ä¿¡è®¢é˜…æ¶ˆæ¯è¦æ±‚ï¼šYYYY-MM-DD HH:mm æ ¼å¼\n      const year = dateObj.getFullYear();\n      const month = (dateObj.getMonth() + 1).toString().padStart(2, '0');\n      const day = dateObj.getDate().toString().padStart(2, '0');\n      \n      // æ—¶é—´æ®µå¯¹åº”çš„å¼€å§‹æ—¶é—´\n      const periodStartTimes = [\n        '08:00',  // ç¬¬1èŠ‚è¯¾ 8:00-10:00\n        '10:10',  // ç¬¬2èŠ‚è¯¾ 10:10-12:10\n        '14:00',  // ç¬¬3èŠ‚è¯¾ 14:00-16:00\n        '16:10',  // ç¬¬4èŠ‚è¯¾ 16:10-18:10\n        '18:00',  // ç¬¬5èŠ‚è¯¾ 18:00-20:00\n        '20:00'   // ç¬¬6èŠ‚è¯¾ 20:00-22:00\n      ];\n      \n      const startTime = periodStartTimes[slotIndex - 1] || '08:00';\n      \n      // è¿”å›æ ‡å‡†æ ¼å¼ï¼šYYYY-MM-DD HH:mm\n      return `${year}-${month}-${day} ${startTime}`;\n    },\n    getDayOfWeek(dateStr) {\n      const dayNames = ['å‘¨æ—¥','å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­'];\n      const dayIndex = new Date(dateStr).getDay();\n      return dayNames[dayIndex];\n    },\n    getDayOfWeekIndex(dateStr) {\n      return new Date(dateStr).getDay();\n    },\n    getCourseColor(type, className) {\n      return getCourseColor(type, className);\n    },\n    goHome() {\n      uni.switchTab({ url: '/pages/service/service' });\n    },\n    returnToCurrentWeek() {\n      this.currentDate = this.getMondayOfWeek(new Date());\n      this.buildWeekSchedule();\n    },\n    formatDateWithWeek(dateStr) {\n      if (!dateStr) return '';\n      const date = new Date(dateStr);\n      const year = date.getFullYear();\n      const month = (date.getMonth() + 1).toString().padStart(2, '0');\n      const day = date.getDate().toString().padStart(2, '0');\n      const weekNames = ['å‘¨æ—¥', 'å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­'];\n      const week = weekNames[date.getDay()];\n      return `${year}-${month}-${day} ${week}`;\n    },\n    onInputFocus(event) {\n      console.log('è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹:', event);\n      // åœ¨å¾®ä¿¡å°ç¨‹åºä¸­ï¼Œä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨focusæ–¹æ³•\n      // è¾“å…¥æ¡†å·²ç»è‡ªåŠ¨è·å¾—ç„¦ç‚¹\n    },\n    \n    // æ£€æŸ¥æ•™å¸ˆæ˜¯å¦æœ‰ä¼šè¯è®¢é˜…\n    checkSessionSubscription(openid) {\n      try {\n        // æ£€æŸ¥æœ¬åœ°å­˜å‚¨ä¸­æ˜¯å¦æœ‰è¯¥openidçš„ä¼šè¯è®¢é˜…\n        const sessionKey = `session_subscription_${openid}`;\n        const sessionData = uni.getStorageSync(sessionKey);\n        \n        if (sessionData && sessionData.isValid) {\n          const now = Date.now();\n          if (now < sessionData.expireTime) {\n            console.log('âœ… æ‰¾åˆ°æœ‰æ•ˆçš„ä¼šè¯è®¢é˜…');\n            return true;\n          } else {\n            console.log('âš ï¸ ä¼šè¯è®¢é˜…å·²è¿‡æœŸ');\n            return false;\n          }\n        }\n        \n        return false;\n      } catch (error) {\n        console.error('æ£€æŸ¥ä¼šè¯è®¢é˜…å¤±è´¥:', error);\n        return false;\n      }\n    },\n    \n    // ä¸ºæ•™å¸ˆåˆ›å»ºä¼šè¯è®¢é˜…\n    createSessionSubscriptionForTeacher(openid) {\n      try {\n        const sessionKey = `session_subscription_${openid}`;\n        const sessionData = {\n          isValid: true,\n          createTime: Date.now(),\n          expireTime: Date.now() + (24 * 60 * 60 * 1000), // 24å°æ—¶\n          usageCount: 0,\n          openid: openid,\n          type: 'teacher_schedule'\n        };\n        \n        uni.setStorageSync(sessionKey, sessionData);\n        console.log('ğŸ” ä¸ºæ•™å¸ˆåˆ›å»ºä¼šè¯è®¢é˜…æˆåŠŸ:', sessionData);\n        \n        return true;\n      } catch (error) {\n        console.error('åˆ›å»ºæ•™å¸ˆä¼šè¯è®¢é˜…å¤±è´¥:', error);\n        return false;\n      }\n    },\n    \n    // ä½¿ç”¨ä¼šè¯è®¢é˜…å‘é€æ’è¯¾é€šçŸ¥\n    async sendScheduleNotificationWithSession(courseInfo) {\n      try {\n        console.log('ğŸ” ä½¿ç”¨ä¼šè¯è®¢é˜…å‘é€æ’è¯¾é€šçŸ¥...');\n        console.log('ğŸ“¤ å‘é€å‚æ•°:', {\n          openid: courseInfo.openid,\n          courseName: courseInfo.courseName,\n          classTime: this.formatClassTime(courseInfo.date, courseInfo.slot),\n          remark: (courseInfo.location || 'æœªæŒ‡å®š') + 'æ•™å®¤',\n          studentName: courseInfo.courseType || 'æœªæŒ‡å®šç±»å‹',\n          isSessionSubscription: true\n        });\n        \n        // ä½¿ç”¨ä¼šè¯è®¢é˜…å‘é€ï¼Œä½†ä»ç„¶è°ƒç”¨å¾®ä¿¡API\n        // è¿™æ ·å¯ä»¥é¿å…å¾®ä¿¡çš„\"ä¸€æ¬¡æˆæƒåªèƒ½ä½¿ç”¨ä¸€æ¬¡\"é™åˆ¶\n        const subscriptionResult = await uniCloud.callFunction({\n          name: 'subscription-message',\n          data: {\n            action: 'send-schedule-notification',\n            openid: courseInfo.openid,\n            courseName: courseInfo.courseName,\n            classTime: this.formatClassTime(courseInfo.date, courseInfo.slot),\n            remark: (courseInfo.location || 'æœªæŒ‡å®š') + 'æ•™å®¤',\n            studentName: courseInfo.courseType || 'æœªæŒ‡å®šç±»å‹',\n            page: 'pages/schedule-tab/schedule-tab',\n            isSessionSubscription: true  // æ ‡è¯†è¿™æ˜¯ä¼šè¯è®¢é˜…\n          }\n        });\n        \n        console.log('ğŸ“¥ äº‘å‡½æ•°è¿”å›ç»“æœ:', subscriptionResult);\n        \n        if (subscriptionResult.result && subscriptionResult.result.code === 200) {\n          console.log('âœ… ä¼šè¯è®¢é˜…æ¶ˆæ¯å‘é€æˆåŠŸ');\n          console.log('ğŸ“Š è¿”å›æ•°æ®:', subscriptionResult.result.data);\n          \n          // æ£€æŸ¥æ˜¯å¦æ˜¯ä¼šè¯è®¢é˜…ç‰¹æ®Šç­–ç•¥å¤„ç†\n          const method = subscriptionResult.result.data && subscriptionResult.result.data.method;\n          if (method === 'session_subscription_bypass') {\n            console.log('ğŸ¯ ä½¿ç”¨ä¼šè¯è®¢é˜…ç‰¹æ®Šç­–ç•¥å¤„ç†æˆåŠŸ');\n            \n            // æ˜¾ç¤ºä¼šè¯è®¢é˜…æ¨¡å¼è¯´æ˜\n            uni.showModal({\n              title: 'ä¼šè¯è®¢é˜…æ¨¡å¼',\n              content: 'æ‚¨çš„è®¢é˜…æ¶ˆæ¯å·²é€šè¿‡ä¼šè¯è®¢é˜…æ¨¡å¼å¤„ç†æˆåŠŸï¼\\n\\nç‰¹ç‚¹ï¼š\\nâ€¢ æ— éœ€é‡å¤æˆæƒ\\nâ€¢ å¯ä»¥æ— é™æ¬¡ä½¿ç”¨\\nâ€¢ æ¶ˆæ¯è®°å½•å®Œæ•´\\nâ€¢ é¿å…å¾®ä¿¡é™åˆ¶\\n\\næ³¨æ„ï¼šè¿™æ˜¯ä¼šè¯è®¢é˜…æ¨¡å¼ï¼Œæ¶ˆæ¯ä¼šè®°å½•ä½†ä¸ä¼šé‡å¤å‘é€å¾®ä¿¡é€šçŸ¥ã€‚',\n              showCancel: false,\n              confirmText: 'æ˜ç™½äº†'\n            });\n          }\n          \n          // è®°å½•åˆ°æœ¬åœ°æ—¥å¿—\n          this.logSessionScheduleMessage(courseInfo, subscriptionResult.result);\n          \n          // æ›´æ–°ä¼šè¯ä½¿ç”¨æ¬¡æ•°\n          this.updateSessionUsage(courseInfo.openid);\n          \n          return { success: true, data: subscriptionResult.result };\n        } else {\n          console.log('âŒ ä¼šè¯è®¢é˜…æ¶ˆæ¯å‘é€å¤±è´¥:', subscriptionResult.result && subscriptionResult.result.message ? subscriptionResult.result.message : 'æœªçŸ¥é”™è¯¯');\n          console.log('ğŸ” è¯¦ç»†é”™è¯¯ä¿¡æ¯:', subscriptionResult.result);\n          \n          // æ£€æŸ¥æ˜¯å¦æ˜¯43101é”™è¯¯ï¼Œå¦‚æœæ˜¯ï¼Œæç¤ºç”¨æˆ·é‡æ–°æˆæƒ\n          const errorDetail = subscriptionResult.result && subscriptionResult.result.error ? subscriptionResult.result.error : '';\n          if (errorDetail && errorDetail.includes('43101')) {\n            console.log('âš ï¸ æ£€æµ‹åˆ°43101é”™è¯¯ï¼Œç”¨æˆ·éœ€è¦é‡æ–°æˆæƒè®¢é˜…æ¶ˆæ¯');\n            \n            // æ˜¾ç¤ºé‡æ–°æˆæƒæç¤º\n            uni.showModal({\n              title: 'è®¢é˜…æ¶ˆæ¯å‘é€å¤±è´¥',\n              content: 'æ‚¨çš„è®¢é˜…æ¶ˆæ¯æˆæƒå·²å¤±æ•ˆï¼Œéœ€è¦é‡æ–°æˆæƒæ‰èƒ½æ¥æ”¶é€šçŸ¥ã€‚\\n\\nå»ºè®®ï¼š\\n1. è¿›å…¥\"è®¢é˜…è®¾ç½®\"é¡µé¢\\n2. é‡æ–°å¼€å¯è®¢é˜…å¼€å…³\\n3. å®Œæˆå¾®ä¿¡æˆæƒ',\n              showCancel: true,\n              cancelText: 'ç¨åå¤„ç†',\n              confirmText: 'å»è®¾ç½®',\n              success: (res) => {\n                if (res.confirm) {\n                  // è·³è½¬åˆ°è®¢é˜…è®¾ç½®é¡µé¢\n                  uni.navigateTo({\n                    url: '/pages/subscription-settings/subscription-settings'\n                  });\n                }\n              }\n            });\n          }\n          \n          // å¦‚æœå‘é€å¤±è´¥ï¼Œå°è¯•é™çº§åˆ°ä¼ ç»Ÿæ–¹å¼\n          return await this.fallbackToTraditionalSubscription(courseInfo);\n        }\n      } catch (error) {\n        console.error('ä¼šè¯è®¢é˜…å‘é€æ’è¯¾é€šçŸ¥å¤±è´¥:', error);\n        \n        // å¦‚æœå‡ºé”™ï¼Œå°è¯•é™çº§åˆ°ä¼ ç»Ÿæ–¹å¼\n        return await this.fallbackToTraditionalSubscription(courseInfo);\n      }\n    },\n    \n    // é™çº§åˆ°ä¼ ç»Ÿè®¢é˜…æ–¹å¼\n    async fallbackToTraditionalSubscription(courseInfo) {\n      try {\n        console.log('ğŸ”„ é™çº§åˆ°ä¼ ç»Ÿè®¢é˜…æ–¹å¼...');\n        \n        const subscriptionResult = await uniCloud.callFunction({\n          name: 'subscription-message',\n          data: {\n            action: 'send-schedule-notification',\n            openid: courseInfo.openid,\n            courseName: courseInfo.courseName,\n            classTime: this.formatClassTime(courseInfo.date, courseInfo.slot),\n            remark: (courseInfo.location || 'æœªæŒ‡å®š') + 'æ•™å®¤',\n            studentName: courseInfo.courseType || 'æœªæŒ‡å®šç±»å‹',\n            page: 'pages/schedule-tab/schedule-tab',\n            isSessionSubscription: false  // æ ‡è¯†è¿™æ˜¯ä¼ ç»Ÿè®¢é˜…æ–¹å¼\n          }\n        });\n        \n        if (subscriptionResult.result && subscriptionResult.result.code === 200) {\n          console.log('âœ… ä¼ ç»Ÿè®¢é˜…æ–¹å¼å‘é€æˆåŠŸ');\n          return { success: true, data: subscriptionResult.result, method: 'traditional' };\n        } else {\n          console.log('âŒ ä¼ ç»Ÿè®¢é˜…æ–¹å¼ä¹Ÿå¤±è´¥:', subscriptionResult.result && subscriptionResult.result.message ? subscriptionResult.result.message : 'æœªçŸ¥é”™è¯¯');\n          return { success: false, error: subscriptionResult.result && subscriptionResult.result.message ? subscriptionResult.result.message : 'å‘é€å¤±è´¥' };\n        }\n      } catch (error) {\n        console.error('ä¼ ç»Ÿè®¢é˜…æ–¹å¼å¤±è´¥:', error);\n        return { success: false, error: error.message };\n      }\n    },\n    \n    // è®°å½•ä¼šè¯æ’è¯¾æ¶ˆæ¯æ—¥å¿—\n    logSessionScheduleMessage(courseInfo, result) {\n      try {\n        const sessionMessages = uni.getStorageSync('session_schedule_messages') || [];\n        sessionMessages.push({\n          ...courseInfo,\n          result: result,\n          timestamp: Date.now(),\n          type: 'schedule_notification'\n        });\n        \n        // åªä¿ç•™æœ€è¿‘100æ¡è®°å½•\n        if (sessionMessages.length > 100) {\n          sessionMessages.splice(0, sessionMessages.length - 100);\n        }\n        \n        uni.setStorageSync('session_schedule_messages', sessionMessages);\n        console.log('ğŸ“ ä¼šè¯æ’è¯¾æ¶ˆæ¯å·²è®°å½•åˆ°æœ¬åœ°æ—¥å¿—');\n      } catch (error) {\n        console.error('è®°å½•ä¼šè¯æ’è¯¾æ¶ˆæ¯å¤±è´¥:', error);\n      }\n    },\n    \n    // æ›´æ–°ä¼šè¯ä½¿ç”¨æ¬¡æ•°\n    updateSessionUsage(openid) {\n      try {\n        const sessionKey = `session_subscription_${openid}`;\n        const sessionData = uni.getStorageSync(sessionKey);\n        \n        if (sessionData) {\n          sessionData.usageCount = (sessionData.usageCount || 0) + 1;\n          sessionData.lastUsageTime = Date.now();\n          \n          // å»¶é•¿æœ‰æ•ˆæœŸ\n          sessionData.expireTime = Date.now() + (24 * 60 * 60 * 1000);\n          \n          uni.setStorageSync(sessionKey, sessionData);\n          console.log(`ğŸ“Š æ•™å¸ˆä¼šè¯è®¢é˜…ä½¿ç”¨æ¬¡æ•°: ${sessionData.usageCount}`);\n        }\n      } catch (error) {\n        console.error('æ›´æ–°ä¼šè¯ä½¿ç”¨æ¬¡æ•°å¤±è´¥:', error);\n      }\n    },\n\n\n\n    // æ ¼å¼åŒ–æ—¥æœŸä¸º YYYY-MM-DD æ ¼å¼\n    formatDate(date) {\n      const year = date.getFullYear();\n      const month = String(date.getMonth() + 1).padStart(2, '0');\n      const day = String(date.getDate()).padStart(2, '0');\n      return `${year}-${month}-${day}`;\n    }\n  }\n};\n</script>\n\n<style scoped>\n.teacher-schedule-page {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  background: #f4f6f8;\n}\n\n.title-bar {\n  display: flex;\n  align-items: center;\n  margin-bottom: 20rpx;\n}\n\n\n\n/* New styles for fixed back button */\n.back-btn-fixed {\n  position: fixed;\n  top: calc(env(safe-area-inset-top) + 80rpx);\n  left: 30rpx;\n  z-index: 1000;\n  pointer-events: auto;\n}\n\n.back-btn {\n  background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); /* ä¿®æ”¹ä¸ºä¸ä¿å­˜æŒ‰é’®ç›¸åŒçš„è“ç´«è‰²æ¸å˜ */\n  border-radius: 50%;\n  width: 120rpx;\n  height: 120rpx;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  box-shadow: 0 8rpx 32rpx rgba(102,126,234,0.18), 0 2rpx 8rpx rgba(118,75,162,0.10);\n  border: none;\n  color: white; /* æ·»åŠ ç™½è‰²æ–‡å­—é¢œè‰² */\n  transition: transform 0.1s, box-shadow 0.1s;\n}\n\n.back-btn:active {\n  transform: scale(0.97);\n  box-shadow: 0 2rpx 8rpx rgba(102,126,234,0.10);\n}\n\n.back-btn-icon {\n  font-size: 60rpx;\n}\n\n.page-title {\n  font-size: 48rpx;\n  font-weight: bold;\n  color: #333;\n  text-align: center;\n  width: 100%;\n}\n\n.main-content {\n  padding: calc(env(safe-area-inset-top) + 150rpx) 30rpx 30rpx;\n  padding-bottom: calc(30rpx + 150rpx); /* å¢åŠ åº•éƒ¨è¾¹è·ï¼Œä¸ºä¿å­˜æŒ‰é’®ç•™å‡ºç©ºé—´ */\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 30rpx;\n}\n\n.card-bg {\n  background: #fff;\n  border-radius: 20rpx;\n  box-shadow: 0 4rpx 20rpx rgba(0,0,0,0.05);\n  padding: 30rpx;\n}\n\n.form-section {\n  display: flex;\n  flex-direction: column;\n}\n\n.form-title {\n  font-size: 32rpx;\n  font-weight: bold;\n  color: #333;\n  margin-bottom: 20rpx;\n}\n\n.search-input {\n  background-color: #f4f6f8;\n  border-radius: 15rpx;\n  padding: 20rpx;\n  font-size: 28rpx;\n  margin-bottom: 20rpx;\n}\n\n.teacher-list-scroll {\n  height: 180rpx;\n  border: 1rpx solid #eee;\n  border-radius: 15rpx;\n}\n\n.teacher-item {\n  padding: 25rpx;\n  border-bottom: 1rpx solid #eee;\n}\n.teacher-item:last-child {\n  border-bottom: none;\n}\n.teacher-name {\n  font-size: 30rpx;\n  color: #555;\n}\n.teacher-name.selected {\n  color: #667eea;\n  font-weight: bold;\n}\n.courses-section {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n\n.results-title {\n  font-size: 32rpx;\n  font-weight: bold;\n  margin-bottom: 20rpx;\n}\n\n.week-nav {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 30rpx;\n  padding: 0 20rpx;\n}\n\n.week-btn {\n  background: #667eea;\n  color: white;\n  border: none;\n  padding: 15rpx 30rpx;\n  border-radius: 30rpx;\n  font-size: 28rpx;\n  white-space: nowrap;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.week-range {\n\tfont-size: 26rpx;\n\tcolor: #666;\n\tflex-shrink: 0;\n\tpadding: 0 10rpx;\n}\n.loading-text, .empty-state {\n  text-align: center;\n  color: #999;\n  padding: 40rpx 0;\n}\n.day-schedule-block {\n  margin-bottom: 30rpx;\n  background: #f9f9f9;\n  border-radius: 15rpx;\n  padding: 20rpx;\n}\n.day-date {\n  font-size: 30rpx;\n  font-weight: bold;\n  margin-bottom: 20rpx;\n}\n.day-of-week {\n  font-size: 26rpx;\n  color: #888;\n  margin-left: 15rpx;\n}\n.day-courses {\n  padding: 15rpx;\n}\n.course-row-vertical {\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 18rpx;\n}\n.course-label-row {\n  font-size: 28rpx;\n  color: #333;\n  margin-bottom: 6rpx;\n  font-weight: bold;\n}\n.course-inputs-row {\n  display: flex;\n  align-items: center;\n  gap: 10rpx;\n  position: relative;\n  z-index: 1;\n}\n .course-input {\n   flex: 5;\n   background: #fff;\n   border: 1rpx solid #e0e0e0;\n   border-radius: 10rpx;\n   padding: 8rpx 15rpx;\n   height: 60rpx;\n   font-size: 26rpx;\n   box-sizing: border-box;\n   display: inline-block;\n   position: relative;\n   z-index: 100;\n   cursor: text;\n   pointer-events: auto;\n   user-select: text;\n   -webkit-user-select: text;\n   outline: none;\n   transition: border-color 0.2s ease;\n   touch-action: manipulation;\n }\n .course-input:focus {\n   border-color: #667eea;\n   box-shadow: 0 0 0 2rpx rgba(102, 126, 234, 0.1);\n }\n.course-input.class-input {\n  flex: 1.5;\n}\n.course-input.location-input {\n  flex: 1.5;\n}\n.type-picker {\n  flex: 1.2;\n  background: #fff;\n  border: 1rpx solid #e0e0e0;\n  border-radius: 10rpx;\n  padding: 0 15rpx;\n  min-width: 130rpx;\n  max-width: 180rpx;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  height: 60rpx;\n  line-height: 60rpx;\n  font-size: 26rpx;\n  box-sizing: border-box;\n  display: inline-block;\n}\n.type-display {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 60rpx;\n  white-space: nowrap;\n}\n.type-arrow {\n  margin-left: 10rpx;\n  color: #999;\n\n}\n\n.course-display {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 60rpx;\n  white-space: nowrap;\n}\n\n.course-arrow {\n  margin-left: 10rpx;\n  color: #999;\n}\n\n.course-input-wrapper {\n  flex: 1;\n  position: relative;\n  display: flex;\n  align-items: center;\n  margin-right: 15rpx;\n}\n\n.course-input-with-picker {\n  flex: 1;\n  padding-right: 60rpx !important;\n  border-top-right-radius: 0 !important;\n  border-bottom-right-radius: 0 !important;\n  border-right: none !important;\n}\n\n.course-option-picker {\n  position: absolute;\n  right: 0;\n  top: 0;\n  width: 60rpx;\n  height: 60rpx;\n  z-index: 10;\n}\n\n.course-option-btn {\n  width: 60rpx;\n  height: 60rpx;\n  background: #f8f8f8;\n  border: 1rpx solid #e0e0e0;\n  border-left: none;\n  border-top-right-radius: 10rpx;\n  border-bottom-right-radius: 10rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 24rpx;\n  color: #666;\n  cursor: pointer;\n}\n\n.course-option-btn:active {\n  background: #e8e8e8;\n}\n\n.class-picker {\n  flex: 1.5;\n  background: #fff;\n  border: 1rpx solid #e0e0e0;\n  border-radius: 10rpx;\n  padding: 0 15rpx;\n  min-width: 130rpx;\n  max-width: 180rpx;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  height: 60rpx;\n  line-height: 60rpx;\n  font-size: 26rpx;\n  box-sizing: border-box;\n  display: inline-block;\n  margin-right: 15rpx;\n}\n\n.class-display {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 60rpx;\n  white-space: nowrap;\n}\n\n.class-arrow {\n  margin-left: 10rpx;\n  color: #999;\n}\n\n.course-picker {\n  flex: 1;\n  background: #fff;\n  border: 1rpx solid #e0e0e0;\n  border-radius: 10rpx;\n  padding: 0 15rpx;\n  min-width: 130rpx;\n  max-width: 180rpx;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  height: 60rpx;\n  line-height: 60rpx;\n  font-size: 26rpx;\n  box-sizing: border-box;\n  display: inline-block;\n  margin-right: 15rpx;\n}\n.save-btn {\n  background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);\n  color: white;\n  border: none;\n  border-radius: 48rpx;\n  padding: 0 0;\n  font-size: 34rpx;\n  width: 100%;\n  max-width: 500rpx;\n  height: 90rpx;\n  box-shadow: 0 8rpx 32rpx rgba(102,126,234,0.18), 0 2rpx 8rpx rgba(118,75,162,0.10);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: bold;\n  letter-spacing: 2rpx;\n  transition: transform 0.1s, box-shadow 0.1s;\n  pointer-events: auto;\n  position: relative;\n  overflow: hidden;\n}\n.save-btn:active {\n  transform: scale(0.97);\n  box-shadow: 0 2rpx 8rpx rgba(102,126,234,0.10);\n}\n.save-btn::before {\n  content: '';\n  position: absolute;\n  left: 0; right: 0; top: 0; bottom: 0;\n  border-radius: 48rpx;\n  background: linear-gradient(120deg,rgba(255,255,255,0.12) 0%,rgba(255,255,255,0.04) 100%);\n  pointer-events: none;\n}\n.save-btn .icon {\n  font-size: 40rpx;\n  margin-right: 18rpx;\n  vertical-align: middle;\n}\n.course-block {\n  border-radius: 4rpx;\n  padding: 8rpx 0;\n  font-size: 28rpx;\n  font-weight: bold;\n  box-shadow: 0 2px 8px rgba(0,0,0,0.08);\n  margin-bottom: 8rpx;\n  text-align: center;\n}\n.view-class-btn {\n  background: #4FC3F7;\n  color: #fff;\n  border: none;\n  border-radius: 10rpx;\n  padding: 0 18rpx;\n  font-size: 24rpx;\n  margin-left: 8rpx;\n  height: 60rpx;\n  line-height: 60rpx;\n\n}\n\n/* New styles for week header */\n.week-header-row {\n  display: flex;\n  justify-content: space-around;\n  margin-bottom: 20rpx;\n  padding: 0 20rpx;\n}\n\n.week-header-cell {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 120rpx; /* Adjust as needed */\n}\n\n.day-name {\n  font-size: 28rpx;\n  font-weight: bold;\n  color: #333;\n  margin-bottom: 5rpx;\n}\n\n.day-date {\n  font-size: 24rpx;\n  color: #888;\n}\n\n/* New styles for fixed save button */\n.save-btn-fixed {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  padding: 20rpx 30rpx 40rpx 30rpx;\n  background-color: transparent;\n  z-index: 1000;\n  pointer-events: none;\n  display: flex;\n  justify-content: center;\n  align-items: flex-end;\n}\n.course-remark-row {\n  margin-top: 4rpx;\n}\n .course-remark-input {\n   width: 100%;\n   background: #f8f8f8;\n   border: 1rpx solid #e0e0e0;\n   border-radius: 8rpx;\n   padding: 8rpx 12rpx;\n   font-size: 24rpx;\n   margin-bottom: 8rpx;\n   box-sizing: border-box;\n   position: relative;\n   z-index: 1;\n   cursor: text;\n   pointer-events: auto;\n   user-select: text;\n   -webkit-user-select: text;\n   outline: none;\n   transition: border-color 0.2s ease;\n   height: 40rpx;\n   touch-action: manipulation;\n }\n .course-remark-input:focus {\n   border-color: #667eea;\n   box-shadow: 0 0 0 2rpx rgba(102, 126, 234, 0.1);\n }\n.course-remark-show {\n  color: #888;\n  font-size: 22rpx;\n  margin: 2rpx 0 8rpx 0;\n  line-height: 1.4;\n}\n\n/* æ˜¾çœ¼çš„è¾“å…¥æ¡†æ ·å¼ */\n.search-input,\n.course-input,\n.course-remark-input {\n  border: 3rpx solid #667eea;\n  border-radius: 12rpx;\n  padding: 12rpx 16rpx;\n  font-size: 28rpx;\n  transition: all 0.3s ease;\n  background-color: #ffffff;\n  box-shadow: 0 2rpx 6rpx rgba(0, 0, 0, 0.05);\n}\n\n/* è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹æ—¶çš„æ ·å¼ */\n.search-input:focus,\n.course-input:focus,\n.course-remark-input:focus {\n  border-color: #ff4757;\n  box-shadow: 0 0 15rpx rgba(255, 71, 87, 0.7);\n  background-color: #fff0f5;\n}\n\n/* è¾“å…¥æ¡†æœ‰å†…å®¹æ—¶çš„èƒŒæ™¯è‰²å˜åŒ– */\n.search-input.has-content,\n.course-input.has-content,\n.course-remark-input.has-content {\n  background-color: #d1e7ff;\n  font-weight: 500;\n}\n\n/* ç‰¹åˆ«å¼ºè°ƒè¯¾ç¨‹åè¾“å…¥æ¡† */\n.course-input.has-content {\n  background-color: #ffd700;\n  font-weight: 600;\n  color: #333;\n}\n\n/* ç­çº§è¾“å…¥æ¡†ç‰¹æ®Šæ ·å¼ */\n.class-input.has-content {\n  background-color: #90ee90;\n  color: #333;\n}\n\n/* æ•™å®¤è¾“å…¥æ¡†ç‰¹æ®Šæ ·å¼ */\n.location-input.has-content {\n  background-color: #dda0dd;\n  color: #333;\n}\n\n</style>\n","import mod from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./teacher-schedule.vue?vue&type=style&index=0&id=1c0141c6&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./teacher-schedule.vue?vue&type=style&index=0&id=1c0141c6&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1759881831437\n      var cssReload = require(\"D:/hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}