{"version":3,"sources":["uni-app:///main.js","webpack:///D:/代码/小程序/新欣火1/pages/exam-analysis/exam-analysis-list.vue?8649","webpack:///D:/代码/小程序/新欣火1/pages/exam-analysis/exam-analysis-list.vue?3701","webpack:///D:/代码/小程序/新欣火1/pages/exam-analysis/exam-analysis-list.vue?e9bb","webpack:///D:/代码/小程序/新欣火1/pages/exam-analysis/exam-analysis-list.vue?8f27","uni-app:///pages/exam-analysis/exam-analysis-list.vue","webpack:///D:/代码/小程序/新欣火1/pages/exam-analysis/exam-analysis-list.vue?1169","webpack:///D:/代码/小程序/新欣火1/pages/exam-analysis/exam-analysis-list.vue?4918"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","ImageZoomViewer","data","yearList","yearIndex","selectedYear","monthList","monthIndex","selectedMonth","examTypeList","examTypeIndex","selectedExamType","analysisList","loading","currentPage","pageSize","total","totalPages","showImageZoom","currentImages","currentImageIndex","computed","onLoad","console","onPullDownRefresh","methods","initYearList","setDefaultFilters","onYearChange","onMonthChange","onExamTypeChange","resetFilter","searchAnalysis","loadAnalysisList","userInfo","uni","title","icon","params","userId","userRole","page","uniCloud","name","action","result","list","viewDetail","url","editAnalysis","deleteAnalysis","content","success","res","id","addAnalysis","changePage","formatTime","goBack","viewStudentDetail","viewUserDetail","openImageZoom","closeImageZoom","switchImage"],"mappings":";;;;;;;;;;;;;AAAA;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,yBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2I;AAC3I;AACsE;AACL;AACqC;;;AAGtG;AACgL;AAChL,gBAAgB,uLAAU;AAC1B,EAAE,wFAAM;AACR,EAAE,yGAAM;AACR,EAAE,kHAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,6GAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AChDA;AAAA;AAAA;AAAA;AAAgrB,CAAgB,8qBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;eC6KpsB;EACAC;IACAC;EACA;EACAC;IACA;MACA;MACAC;MACAC;MACAC;MAEAC;MACAC;MACAC;MAEAC;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EAEAC;IACAJ;MACA;IACA;EACA;EAEAK;IAAA;IACA;IACA;IACAC;IAEA;IACA;IACA;MACA;MACA;IACA;EACA;EAEAC;IACA;EACA;EAEAC;IACA;IACAC;MACA;MACA;MACA;QACA;MACA;IACA;IAEA;IACAC;MACA;MACA;MACA;MAEA;MACA;MAEA;MACA;MAEAJ;QACAlB;QACAG;QACAG;QACAP;QACAG;QACAG;MACA;IACA;IAEA;IACAkB;MACA;MACA;MACAL;QAAAnB;QAAAC;MAAA;MACA;MACA;MACA;IACA;IAEA;IACAwB;MACA;MACA;MACAN;QAAAhB;QAAAC;MAAA;MACA;MACA;MACA;IACA;IAEA;IACAsB;MACA;MACA;MACAP;QAAAb;QAAAC;MAAA;MACA;MACA;MACA;IACA;IAEA;IACAoB;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA;IACA;IAEA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA;gBAAA;gBAGAC;gBACAX;gBAAA,IACAW;kBAAA;kBAAA;gBAAA;gBACAC;kBACAC;kBACAC;gBACA;gBAAA;cAAA;gBAIA;gBACAC;kBACAC;kBACAC;kBACAC;kBACA1B;gBACA;gBACA;gBACA;gBACA;gBAEAQ;gBAAA;gBAAA,OAEAmB;kBACAC;kBACAzC;oBACA0C;oBACA1C;kBACA;gBACA;cAAA;gBANA2C;gBAQAtB;gBAEA;kBACA;kBACA;kBACAA;oBAAAuB;oBAAA9B;kBAAA;gBACA;kBACAO;kBACAY;oBACAC;oBACAC;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAd;gBACAY;kBACAC;kBACAC;gBACA;cAAA;gBAAA;gBAEA;gBACAF;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAY;MACAZ;QACAa;MACA;IACA;IAEA;IACAC;MACAd;QACAa;MACA;IACA;IAEA;IACAE;MAAA;MACAf;QACAC;QACAe;QACAC;UAAA;YAAA;YAAA;cAAA;gBAAA;kBAAA;oBAAA,KACAC;sBAAA;sBAAA;oBAAA;oBAAA;oBAEAnB;oBAAA;oBAAA,OACAQ;sBACAC;sBACAzC;wBACA0C;wBACA1C;0BACAoD;0BACAf;0BACAC;wBACA;sBACA;oBACA;kBAAA;oBAVAK;oBAYA;sBACAV;wBACAC;wBACAC;sBACA;sBACA;oBACA;sBACAF;wBACAC;wBACAC;sBACA;oBACA;oBAAA;oBAAA;kBAAA;oBAAA;oBAAA;oBAEAd;oBACAY;sBACAC;sBACAC;oBACA;kBAAA;kBAAA;oBAAA;gBAAA;cAAA;YAAA;UAAA,CAGA;UAAA;YAAA;UAAA;UAAA;QAAA;MACA;IACA;IAEA;IACAkB;MACApB;QACAa;MACA;IACA;IAEA;IACAQ;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA;MACA;IACA;IAEA;IACAC;MACAvB;IACA;IAEA;IACAwB;MACA;QACAxB;UACAa;QACA;MACA;QACAb;UACAC;UACAC;QACA;MACA;IACA;IAEA;IACAuB;MACA;QACAzB;UACAC;UACAC;QACA;MACA;QACAF;UACAC;UACAC;QACA;MACA;IACA;IAEA;IACAwB;MACA;QACA1B;UACAC;UACAC;QACA;QACA;MACA;MAEA;MACA;MACA;IACA;IAEA;IACAyB;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;IACA;EAEA;AACA;AAAA,2B;;;;;;;;;;;;;AC9fA;AAAA;AAAA;AAAA;AAAq/B,CAAgB,+8BAAG,EAAC,C;;;;;;;;;;;ACAzgC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/exam-analysis/exam-analysis-list.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/exam-analysis/exam-analysis-list.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./exam-analysis-list.vue?vue&type=template&id=1237909f&scoped=true&\"\nvar renderjs\nimport script from \"./exam-analysis-list.vue?vue&type=script&lang=js&\"\nexport * from \"./exam-analysis-list.vue?vue&type=script&lang=js&\"\nimport style0 from \"./exam-analysis-list.vue?vue&type=style&index=0&id=1237909f&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1237909f\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/exam-analysis/exam-analysis-list.vue\"\nexport default component.exports","export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./exam-analysis-list.vue?vue&type=template&id=1237909f&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = !_vm.loading ? _vm.analysisList.length : null\n  var l1 =\n    !_vm.loading && !(g0 === 0)\n      ? _vm.__map(_vm.analysisList, function (item, __i0__) {\n          var $orig = _vm.__get_orig(item)\n          var m0 = _vm.formatTime(item.createTime)\n          var g1 = item.analysisText ? item.analysisText.substring(0, 50) : null\n          var g2 = item.analysisText ? item.analysisText.length : null\n          var g3 = item.examImages && item.examImages.length > 0\n          var l0 = g3\n            ? _vm.__map(item.examImages.slice(0, 3), function (image, index) {\n                var $orig = _vm.__get_orig(image)\n                var g4 = index === 2 && item.examImages.length > 3\n                var g5 = g4 ? item.examImages.length : null\n                return {\n                  $orig: $orig,\n                  g4: g4,\n                  g5: g5,\n                }\n              })\n            : null\n          return {\n            $orig: $orig,\n            m0: m0,\n            g1: g1,\n            g2: g2,\n            g3: g3,\n            l0: l0,\n          }\n        })\n      : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        l1: l1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./exam-analysis-list.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./exam-analysis-list.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"page-container\">\n    <view class=\"exam-analysis-list-container\">\n      <!-- 顶部导航栏 -->\n      <view class=\"nav-bar\">\n        <view class=\"back-btn\" @click=\"goBack\">\n          <text class=\"back-icon\">←</text>\n        </view>\n        <view class=\"nav-title\">试卷分析列表</view>\n      </view>\n      \n      <!-- 筛选条件 -->\n      <view class=\"filter-section\">\n        <view class=\"filter-row\">\n          <picker @change=\"onYearChange\" :value=\"yearIndex\" :range=\"yearList\" class=\"filter-picker\">\n            <view class=\"picker-box\">\n              <text>{{ selectedYear || '选择年份' }}</text>\n              <text class=\"arrow\">></text>\n            </view>\n          </picker>\n          \n          <picker @change=\"onMonthChange\" :value=\"monthIndex\" :range=\"monthList\" class=\"filter-picker\">\n            <view class=\"picker-box\">\n              <text>{{ selectedMonth || '选择月份' }}</text>\n              <text class=\"arrow\">></text>\n            </view>\n          </picker>\n          \n          <picker @change=\"onExamTypeChange\" :value=\"examTypeIndex\" :range=\"examTypeList\" class=\"filter-picker\">\n            <view class=\"picker-box\">\n              <text>{{ selectedExamType || '选择类型' }}</text>\n              <text class=\"arrow\">></text>\n            </view>\n          </picker>\n        </view>\n      </view>\n      \n      <!-- 列表内容 -->\n      <view class=\"list-container\">\n        <view v-if=\"loading\" class=\"loading\">\n          <text>加载中...</text>\n        </view>\n        \n        <view v-else-if=\"analysisList.length === 0\" class=\"empty\">\n          <text>暂无数据</text>\n        </view>\n        \n        <view v-else class=\"analysis-list\">\n          <view \n            v-for=\"item in analysisList\" \n            :key=\"item._id\"\n            class=\"analysis-item\"\n            @click=\"viewDetail(item)\"\n          >\n            <view class=\"item-header\">\n              <view class=\"item-title\">\n                {{ item.year }}年{{ item.month }} - {{ item.examType }}\n              </view>\n              <view class=\"item-time\">\n                {{ formatTime(item.createTime) }}\n              </view>\n            </view>\n            \n            <view class=\"item-student\">\n              <text class=\"student-info\" @click.stop=\"viewStudentDetail(item)\">\n                {{ (item.grade || '未知年级') }} - {{ (item.studentName || '未知学生') }}\n              </text>\n            </view>\n            \n            <view class=\"item-content\">\n              <view class=\"content-row\">\n                <text class=\"label\">考试难度：</text>\n                <view class=\"stars\">\n                  <text \n                    v-for=\"index in 5\" \n                    :key=\"index\"\n                    class=\"star\"\n                    :class=\"{ active: index <= item.difficultyRating }\"\n                  >\n                    ★\n                  </text>\n                </view>\n              </view>\n              \n              <view class=\"content-row\">\n                <text class=\"label\">答题效果：</text>\n                <view class=\"stars\">\n                  <text \n                    v-for=\"index in 5\" \n                    :key=\"index\"\n                    class=\"star\"\n                    :class=\"{ active: index <= item.studentPerformance }\"\n                  >\n                    ★\n                  </text>\n                </view>\n              </view>\n              \n              <view v-if=\"item.analysisText\" class=\"content-row\">\n                <text class=\"label\">分析内容：</text>\n                <text class=\"analysis-text\">{{ item.analysisText.substring(0, 50) }}{{ item.analysisText.length > 50 ? '...' : '' }}</text>\n              </view>\n              \n              <!-- 试卷图片预览 -->\n              <view v-if=\"item.examImages && item.examImages.length > 0\" class=\"content-row\">\n                <text class=\"label\">试卷图片：</text>\n                <view class=\"image-preview-list\">\n                  <view \n                    v-for=\"(image, index) in item.examImages.slice(0, 3)\" \n                    :key=\"index\"\n                    class=\"image-preview-item\"\n                    @click.stop=\"openImageZoom(item.examImages, index)\"\n                  >\n                    <image :src=\"image\" class=\"preview-image\" mode=\"aspectFill\" />\n                    <view v-if=\"index === 2 && item.examImages.length > 3\" class=\"more-indicator\">\n                      <text>+{{ item.examImages.length - 3 }}</text>\n                    </view>\n                  </view>\n                </view>\n              </view>\n            </view>\n            \n            <view class=\"item-footer\">\n              <text class=\"user-name\" @click.stop=\"viewUserDetail(item)\">{{ item.userName || '未知用户' }}</text>\n              <view class=\"action-buttons\">\n                <button class=\"action-btn edit\" @click.stop=\"editAnalysis(item)\">编辑</button>\n                <button class=\"action-btn delete\" @click.stop=\"deleteAnalysis(item)\">删除</button>\n              </view>\n            </view>\n          </view>\n        </view>\n        \n        <!-- 分页 -->\n        <view v-if=\"total > pageSize\" class=\"pagination\">\n          <button \n            class=\"page-btn\" \n            :disabled=\"currentPage <= 1\"\n            @click=\"changePage(currentPage - 1)\"\n          >\n            上一页\n          </button>\n          <text class=\"page-info\">{{ currentPage }} / {{ totalPages }}</text>\n          <button \n            class=\"page-btn\" \n            :disabled=\"currentPage >= totalPages\"\n            @click=\"changePage(currentPage + 1)\"\n          >\n            下一页\n          </button>\n        </view>\n      </view>\n      \n      <!-- 悬浮添加按钮 -->\n      <view class=\"fab\" @click=\"addAnalysis\">\n        <text class=\"fab-icon\">+</text>\n      </view>\n      \n    </view>\n    \n    <!-- 图片放大查看组件 -->\n    <ImageZoomViewer\n      :visible=\"showImageZoom\"\n      :images=\"currentImages\"\n      :currentIndex=\"currentImageIndex\"\n      @close=\"closeImageZoom\"\n      @switch=\"switchImage\"\n    />\n  </view>\n</template>\n\n<script>\nimport ImageZoomViewer from '@/components/ImageZoomViewer.vue'\n\nexport default {\n  components: {\n    ImageZoomViewer\n  },\n  data() {\n    return {\n      // 筛选条件\n      yearList: [],\n      yearIndex: 0,\n      selectedYear: '全部',\n      \n      monthList: ['全部', '1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],\n      monthIndex: 0,\n      selectedMonth: '全部',\n      \n      examTypeList: ['全部', '期中', '元调', '二调', '四调', '中考', '月考', '期末'],\n      examTypeIndex: 0,\n      selectedExamType: '全部',\n      \n      // 列表数据\n      analysisList: [],\n      loading: false,\n      currentPage: 1,\n      pageSize: 10,\n      total: 0,\n      totalPages: 0,\n      showImageZoom: false,\n      currentImages: [],\n      currentImageIndex: 0\n    }\n  },\n  \n  computed: {\n    totalPages() {\n      return Math.ceil(this.total / this.pageSize)\n    }\n  },\n  \n  onLoad() {\n    // 检查用户登录状态\n    const userInfo = uni.getStorageSync('userInfo')\n    console.log('exam-analysis-list onLoad - userInfo:', userInfo)\n    \n    this.initYearList()\n    // 设置默认筛选条件，确保能显示所有数据\n    this.$nextTick(() => {\n      this.setDefaultFilters()\n      this.loadAnalysisList()\n    })\n  },\n  \n  onPullDownRefresh() {\n    this.loadAnalysisList()\n  },\n  \n  methods: {\n    // 初始化年份列表\n    initYearList() {\n      this.yearList = ['全部'] // 添加\"全部\"选项\n      const currentYear = new Date().getFullYear()\n      for (let i = currentYear - 5; i <= currentYear + 1; i++) {\n        this.yearList.push(i + '年')\n      }\n    },\n    \n    // 设置默认筛选条件\n    setDefaultFilters() {\n      // 强制设置默认值\n      this.$set(this, 'selectedYear', '全部')\n      this.$set(this, 'yearIndex', 0)\n      \n      this.$set(this, 'selectedMonth', '全部')\n      this.$set(this, 'monthIndex', 0)\n      \n      this.$set(this, 'selectedExamType', '全部')\n      this.$set(this, 'examTypeIndex', 0)\n      \n      console.log('setDefaultFilters - 设置完成:', {\n        selectedYear: this.selectedYear,\n        selectedMonth: this.selectedMonth,\n        selectedExamType: this.selectedExamType,\n        yearIndex: this.yearIndex,\n        monthIndex: this.monthIndex,\n        examTypeIndex: this.examTypeIndex\n      })\n    },\n    \n    // 年份选择\n    onYearChange(e) {\n      this.yearIndex = e.detail.value\n      this.selectedYear = this.yearList[this.yearIndex]\n      console.log('onYearChange - 选择年份:', { yearIndex: this.yearIndex, selectedYear: this.selectedYear })\n      // 选择后自动加载数据\n      this.currentPage = 1\n      this.loadAnalysisList()\n    },\n    \n    // 月份选择\n    onMonthChange(e) {\n      this.monthIndex = e.detail.value\n      this.selectedMonth = this.monthList[this.monthIndex]\n      console.log('onMonthChange - 选择月份:', { monthIndex: this.monthIndex, selectedMonth: this.selectedMonth })\n      // 选择后自动加载数据\n      this.currentPage = 1\n      this.loadAnalysisList()\n    },\n    \n    // 考试类型选择\n    onExamTypeChange(e) {\n      this.examTypeIndex = e.detail.value\n      this.selectedExamType = this.examTypeList[this.examTypeIndex]\n      console.log('onExamTypeChange - 选择考试类型:', { examTypeIndex: this.examTypeIndex, selectedExamType: this.selectedExamType })\n      // 选择后自动加载数据\n      this.currentPage = 1\n      this.loadAnalysisList()\n    },\n    \n    // 重置筛选条件\n    resetFilter() {\n      this.selectedYear = '全部'\n      this.selectedMonth = '全部'\n      this.selectedExamType = '全部'\n      this.yearIndex = 0\n      this.monthIndex = 0\n      this.examTypeIndex = 0\n      this.currentPage = 1\n      this.loadAnalysisList()\n    },\n    \n    // 搜索分析\n    searchAnalysis() {\n      this.currentPage = 1\n      this.loadAnalysisList()\n    },\n    \n    // 加载分析列表\n    async loadAnalysisList() {\n      this.loading = true\n      \n      try {\n        const userInfo = uni.getStorageSync('userInfo')\n        console.log('loadAnalysisList - userInfo:', userInfo)\n        if (!userInfo) {\n          uni.showToast({\n            title: '请先登录',\n            icon: 'none'\n          })\n          return\n        }\n        \n        // 只在有值且不是\"全部\"时才传递筛选条件\n        const params = {\n          userId: userInfo._id,\n          userRole: userInfo.role,\n          page: this.currentPage,\n          pageSize: this.pageSize\n        }\n        if (this.selectedYear && this.selectedYear !== '全部') params.year = this.selectedYear\n        if (this.selectedMonth && this.selectedMonth !== '全部') params.month = this.selectedMonth\n        if (this.selectedExamType && this.selectedExamType !== '全部') params.examType = this.selectedExamType\n        \n        console.log('loadAnalysisList - 发送参数:', params)\n        \n        const result = await uniCloud.callFunction({\n          name: 'exam-analysis',\n          data: {\n            action: 'getList',\n            data: params\n          }\n        })\n        \n        console.log('loadAnalysisList - 返回结果:', result)\n        \n        if (result.result.code === 0) {\n          this.analysisList = result.result.data.list\n          this.total = result.result.data.total\n          console.log('loadAnalysisList - 设置数据:', { list: this.analysisList.length, total: this.total })\n        } else {\n          console.error('loadAnalysisList - 返回错误:', result.result)\n          uni.showToast({\n            title: result.result.message || '加载失败',\n            icon: 'none'\n          })\n        }\n      } catch (error) {\n        console.error('加载失败:', error)\n        uni.showToast({\n          title: '加载失败，请重试',\n          icon: 'none'\n        })\n      } finally {\n        this.loading = false\n        uni.stopPullDownRefresh()\n      }\n    },\n    \n    // 查看详情\n    viewDetail(item) {\n      uni.navigateTo({\n        url: `/pages/exam-analysis/exam-analysis-detail?id=${item._id}`\n      })\n    },\n    \n    // 编辑分析\n    editAnalysis(item) {\n      uni.navigateTo({\n        url: `/pages/exam-analysis/exam-analysis?id=${item._id}`\n      })\n    },\n    \n    // 删除分析\n    deleteAnalysis(item) {\n      uni.showModal({\n        title: '确认删除',\n        content: '确定要删除这条试卷分析吗？',\n        success: async (res) => {\n          if (res.confirm) {\n            try {\n              const userInfo = uni.getStorageSync('userInfo')\n              const result = await uniCloud.callFunction({\n                name: 'exam-analysis',\n                data: {\n                  action: 'delete',\n                  data: {\n                    id: item._id,\n                    userId: userInfo._id,\n                    userRole: userInfo.role\n                  }\n                }\n              })\n              \n              if (result.result.code === 0) {\n                uni.showToast({\n                  title: '删除成功',\n                  icon: 'success'\n                })\n                this.loadAnalysisList()\n              } else {\n                uni.showToast({\n                  title: result.result.message || '删除失败',\n                  icon: 'none'\n                })\n              }\n            } catch (error) {\n              console.error('删除失败:', error)\n              uni.showToast({\n                title: '删除失败，请重试',\n                icon: 'none'\n              })\n            }\n          }\n        }\n      })\n    },\n    \n    // 添加分析\n    addAnalysis() {\n      uni.navigateTo({\n        url: '/pages/exam-analysis/exam-analysis'\n      })\n    },\n    \n    // 切换页面\n    changePage(page) {\n      this.currentPage = page\n      this.loadAnalysisList()\n    },\n    \n    // 格式化时间\n    formatTime(timestamp) {\n      if (!timestamp) return ''\n      const date = new Date(timestamp)\n      return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`\n    },\n    \n    // 返回上一页\n    goBack() {\n      uni.navigateBack()\n    },\n    \n    // 查看学生详情\n    viewStudentDetail(item) {\n      if (item.studentId) {\n        uni.navigateTo({\n          url: `/pages/student-hours-detail/student-hours-detail?id=${item.studentId}`\n        })\n      } else {\n        uni.showToast({\n          title: '学生信息不完整',\n          icon: 'none'\n        })\n      }\n    },\n\n    // 查看用户详情\n    viewUserDetail(item) {\n      if (item.userId) {\n        uni.showToast({\n          title: '用户详情功能开发中',\n          icon: 'none'\n        })\n      } else {\n        uni.showToast({\n          title: '用户信息不完整',\n          icon: 'none'\n        })\n      }\n    },\n    \n    // 打开图片放大查看\n    openImageZoom(images, currentIndex) {\n      if (!images || images.length === 0) {\n        uni.showToast({\n          title: '没有图片可预览',\n          icon: 'none'\n        })\n        return\n      }\n      \n      this.currentImages = images\n      this.currentImageIndex = currentIndex\n      this.showImageZoom = true\n    },\n\n    // 关闭图片放大查看\n    closeImageZoom() {\n      this.showImageZoom = false\n      this.currentImages = []\n      this.currentImageIndex = 0\n    },\n\n    // 切换图片\n    switchImage(index) {\n      this.currentImageIndex = index\n    }\n\n  }\n}\n</script>\n\n<style scoped>\n.page-container {\n  min-height: 100vh;\n  background-color: #f5f5f5;\n}\n\n.exam-analysis-list-container {\n  min-height: 100vh;\n}\n\n.nav-bar {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  height: 88rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n  padding-top: var(--status-bar-height);\n}\n\n.back-btn {\n  position: absolute;\n  left: 30rpx;\n  top: 50%;\n  transform: translateY(-50%);\n  width: 60rpx;\n  height: 60rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 50%;\n}\n\n.back-icon {\n  color: white;\n  font-size: 36rpx;\n  font-weight: bold;\n}\n\n.nav-title {\n  color: white;\n  font-size: 36rpx;\n  font-weight: bold;\n}\n\n.filter-section {\n  background: white;\n  padding: 30rpx;\n  margin-bottom: 20rpx;\n}\n\n.filter-row {\n  display: flex;\n  gap: 20rpx;\n  margin-bottom: 20rpx;\n}\n\n.filter-picker {\n  flex: 1;\n}\n\n.picker-box {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 20rpx;\n  background: #f8f9fa;\n  border-radius: 10rpx;\n  font-size: 28rpx;\n  color: #333;\n}\n\n.arrow {\n  color: #999;\n}\n\n.filter-buttons {\n  display: flex;\n  gap: 20rpx;\n}\n\n.filter-btn {\n  flex: 1;\n  height: 70rpx;\n  border-radius: 35rpx;\n  font-size: 28rpx;\n  border: 2rpx solid #e0e0e0;\n  background: white;\n  color: #666;\n}\n\n.filter-btn.primary {\n  background: #667eea;\n  color: white;\n  border-color: #667eea;\n}\n\n.list-container {\n  padding: 0 30rpx;\n}\n\n.loading, .empty {\n  text-align: center;\n  padding: 100rpx 0;\n  color: #999;\n  font-size: 28rpx;\n}\n\n.analysis-list {\n  margin-bottom: 30rpx;\n}\n\n.analysis-item {\n  background: white;\n  border-radius: 20rpx;\n  padding: 30rpx;\n  margin-bottom: 20rpx;\n  box-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.1);\n}\n\n.item-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20rpx;\n}\n\n.item-title {\n  font-size: 32rpx;\n  font-weight: bold;\n  color: #333;\n}\n\n.item-time {\n  font-size: 24rpx;\n  color: #999;\n}\n\n.item-student {\n  margin-bottom: 15rpx;\n}\n\n.student-info {\n  font-size: 28rpx;\n  color: #667eea;\n  font-weight: 500;\n  cursor: pointer;\n  text-decoration: underline;\n}\n\n.student-info:active {\n  color: #5a6fd8;\n}\n\n.item-content {\n  margin-bottom: 20rpx;\n}\n\n.content-row {\n  display: flex;\n  align-items: center;\n  margin-bottom: 15rpx;\n}\n\n.label {\n  font-size: 26rpx;\n  color: #666;\n  width: 120rpx;\n}\n\n.stars {\n  display: flex;\n  gap: 5rpx;\n}\n\n.star {\n  font-size: 24rpx;\n  color: #ddd;\n}\n\n.star.active {\n  color: #ffd700;\n}\n\n.analysis-text {\n  font-size: 26rpx;\n  color: #666;\n  flex: 1;\n}\n\n/* 图片预览样式 */\n.image-preview-list {\n  display: flex;\n  gap: 10rpx;\n  flex: 1;\n}\n\n.image-preview-item {\n  position: relative;\n  width: 80rpx;\n  height: 80rpx;\n  border-radius: 8rpx;\n  overflow: hidden;\n  border: 2rpx solid #e0e0e0;\n}\n\n.preview-image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  cursor: pointer;\n  transition: transform 0.2s ease;\n}\n\n.preview-image:active {\n  transform: scale(0.95);\n}\n\n.more-indicator {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.6);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.more-indicator text {\n  color: white;\n  font-size: 20rpx;\n  font-weight: bold;\n}\n\n.item-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-top: 20rpx;\n  border-top: 1rpx solid #f0f0f0;\n}\n\n.user-name {\n  font-size: 24rpx;\n  color: #999;\n  cursor: pointer;\n  text-decoration: underline;\n}\n\n.user-name:active {\n  color: #666;\n}\n\n.action-buttons {\n  display: flex;\n  gap: 15rpx;\n}\n\n.action-btn {\n  padding: 10rpx 20rpx;\n  border-radius: 15rpx;\n  font-size: 24rpx;\n  border: none;\n}\n\n.action-btn.edit {\n  background: #4CAF50;\n  color: white;\n}\n\n.action-btn.delete {\n  background: #f44336;\n  color: white;\n}\n\n.pagination {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 30rpx;\n  padding: 30rpx 0;\n}\n\n.page-btn {\n  padding: 15rpx 30rpx;\n  border-radius: 20rpx;\n  font-size: 28rpx;\n  border: 2rpx solid #e0e0e0;\n  background: white;\n  color: #666;\n}\n\n.page-btn:disabled {\n  opacity: 0.5;\n}\n\n.page-info {\n  font-size: 28rpx;\n  color: #666;\n}\n\n.fab {\n  position: fixed;\n  right: 40rpx;\n  bottom: 40rpx;\n  width: 100rpx;\n  height: 100rpx;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0 8rpx 30rpx rgba(102, 126, 234, 0.3);\n}\n\n.fab-icon {\n  color: white;\n  font-size: 50rpx;\n  font-weight: bold;\n}\n\n\n</style> ","import mod from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./exam-analysis-list.vue?vue&type=style&index=0&id=1237909f&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./exam-analysis-list.vue?vue&type=style&index=0&id=1237909f&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1759881831269\n      var cssReload = require(\"D:/hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}