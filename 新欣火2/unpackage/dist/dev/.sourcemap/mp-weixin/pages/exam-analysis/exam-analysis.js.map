{"version":3,"sources":["uni-app:///main.js","webpack:///D:/代码/小程序/新欣火1/pages/exam-analysis/exam-analysis.vue?f0fb","webpack:///D:/代码/小程序/新欣火1/pages/exam-analysis/exam-analysis.vue?7774","webpack:///D:/代码/小程序/新欣火1/pages/exam-analysis/exam-analysis.vue?bc64","webpack:///D:/代码/小程序/新欣火1/pages/exam-analysis/exam-analysis.vue?833e","uni-app:///pages/exam-analysis/exam-analysis.vue","webpack:///D:/代码/小程序/新欣火1/pages/exam-analysis/exam-analysis.vue?559e","webpack:///D:/代码/小程序/新欣火1/pages/exam-analysis/exam-analysis.vue?5a4c"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","ImageZoomViewer","data","gradeList","gradeIndex","selectedGrade","studentList","studentIndex","selectedStudent","yearList","yearIndex","selectedYear","monthList","monthIndex","selectedMonth","examTypes","selectedExamType","customExamType","examImages","examImageFileIDs","analysisText","analysisImages","analysisImageFileIDs","difficultyRating","studentPerformance","isEdit","editId","showImageZoom","currentImages","currentImageIndex","onLoad","console","setTimeout","uni","title","icon","methods","initYearList","initDefaultValues","onGradeChange","onStudentChange","loadStudentsByGrade","userInfo","uniCloud","name","action","teacherId","result","allStudents","student","loadGradeList","grades","onYearChange","onMonthChange","selectExamType","onCustomTypeInput","chooseImage","count","sizeType","sourceType","success","deleteImage","chooseAnalysisImage","deleteAnalysisImage","setDifficultyRating","setStudentPerformance","submitAnalysis","i","imagePath","fileName","filePath","cloudPath","uploadResult","id","year","month","examType","studentId","studentName","grade","userId","userRole","userName","content","showCancel","confirmText","resetForm","loadAnalysisDetail","examTypeIndex","cloudImages","localImages","goToList","url","goBack","openImageZoom","closeImageZoom","switchImage","deleteCloudExamImage","fileList","deleteLocalExamImage","deleteCloudAnalysisImage","deleteLocalAnalysisImage","imageToBase64","encoding","resolve","fail","reject"],"mappings":";;;;;;;;;;;;;AAAA;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,qBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsI;AACtI;AACiE;AACL;AACqC;;;AAGjG;AACgL;AAChL,gBAAgB,uLAAU;AAC1B,EAAE,mFAAM;AACR,EAAE,oGAAM;AACR,EAAE,6GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,wGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC3BA;AAAA;AAAA;AAAA;AAA2qB,CAAgB,yqBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eCkO/rB;EACAC;IACAC;EACA;EACAC;IACA;MACA;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;MAEA;MACAC;MAAA;MACAC;MAAA;;MAEA;MACAC;MACAC;MAAA;MACAC;MAAA;;MAEA;MACAC;MACAC;MAEA;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;IACA;EACA;EAEAC;IAAA;IACA;MACAC;;MAEA;MACA;MACAA;MAEA;MACA;MACA;;MAEA;MACA;QACA;QACA;QACA;QACAC;UACA;QACA;MACA;MACAD;IACA;MACAA;MACAE;QACAC;QACAC;MACA;IACA;EACA;EAEAC;IACA;IACAC;MACA;QACAN;QACA;QACA;UACA;QACA;QACA;QACAA;MACA;QACAA;MACA;IACA;IAEA;IACAO;MACA;QACAP;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AAA,MACA;cAAA;gBAAA,MAEA;cAAA;gBAjBAoC;gBAAA;gBAAA;cAAA;gBAsBApC;;gBAEA;gBACAW;gBAAA,IACAA;kBAAA;kBAAA;gBAAA;gBAAA,MACA;cAAA;gBAAA;gBAAA,OAGAC;kBACAC;kBACA1C;oBACA2C;oBACA3C,sCACA;sBAAAuE;oBAAA;sBACAC;sBACAC;sBACAC;sBACA1D;sBAAA;sBACAE;sBACAC;sBAAA;sBACAE;sBACAC;sBACAqD;sBACAC;sBACAC;sBACAC;sBACAC;sBACAC;oBAAA;kBAEA;gBACA;cAAA;gBAtBAnC;gBAwBAhB;gBACAE;gBAEA;kBACAA;oBACAC;oBACAC;kBACA;kBAEA;oBACA;oBACAH;sBACAC;oBACA;kBACA;oBACA;oBACA;kBACA;gBACA;kBACAF;kBACAE;oBACAC;oBACAC;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAF;gBACAF;;gBAEA;gBACA;kBACAE;oBACAC;oBACAiD;oBACAC;oBACAC;kBACA;gBACA;kBACApD;oBACAC;oBACAC;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAmD;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IAEA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAxD;gBAAA;gBAAA,OACAY;kBACAC;kBACA1C;oBACA2C;oBACA3C;sBAAAuE;oBAAA;kBACA;gBACA;cAAA;gBANA1B;gBAQAhB;gBAAA,MAEAgB;kBAAA;kBAAA;gBAAA;gBACA7C;gBACA6B;gBAEA;gBACArB;gBACA;gBAEA;gBACAG;gBACA;;gBAEA;gBACA;kBACA;gBACA;gBACA;kBACA;gBACA;;gBAEA;gBACA2E;gBACA;kBACA;kBACA;gBACA;kBACA;kBACA;gBACA;gBACA;gBACA;kBACA;kBACAC;oBAAA;kBAAA;kBACAC;oBAAA;kBAAA;kBAEA;kBACA;gBACA;kBACA;kBACA;gBACA;gBACA;gBACA;gBACA;kBACA;kBACAD;oBAAA;kBAAA;kBACAC;oBAAA;kBAAA;kBAEA;kBACA;gBACA;kBACA;kBACA;gBACA;gBACA;gBACA;;gBAEA;gBACA;kBACA;kBACAtF;kBACA;gBACA;gBAAA,MAEAF;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OAEA;cAAA;gBACAK;kBAAA;gBAAA;gBACA;kBACA;kBACA;gBACA;cAAA;gBAGAwB;gBAAA;gBAAA;cAAA;gBAEAA;gBACAE;kBACAC;kBACAC;gBACA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAJ;gBACAE;kBACAC;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAwD;MACA1D;QACA2D;MACA;IACA;IAIA;IACAC;MACA5D;IACA;IAEA;IACA6D;MACA;QACA7D;UACAC;UACAC;QACA;QACA;MACA;MAEA;MACA;MACA;IACA;IAEA;IACA4D;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;IACA;IAEA;IACAC;MAAA;MACA;MACA;QACAtD;UACAuD;QACA;UACA;UACAjE;YACAC;YACAC;UACA;QACA;UACAJ;UACAE;YACAC;YACAC;UACA;QACA;MACA;IACA;IAEA;IACAgE;MACA;MACAlE;QACAC;QACAC;MACA;IACA;IAEA;IACAiE;MAAA;MACA;MACA;QACAzD;UACAuD;QACA;UACA;UACAjE;YACAC;YACAC;UACA;QACA;UACAJ;UACAE;YACAC;YACAC;UACA;QACA;MACA;IACA;IAEA;IACAkE;MACA;MACApE;QACAC;QACAC;MACA;IACA;IAEA;IACAmE;MACA;QACArE;UACAqC;UACAiC;UACA3C;YACA;YACA;YACA;YACA,+CACA,+CACA;YAEA;YACA4C;UACA;UACAC;YACA1E;YACA2E;UACA;QACA;MACA;IACA,EAEA;EAEA;AACA;AAAA,2B;;;;;;;;;;;;;AC57BA;AAAA;AAAA;AAAA;AAAg/B,CAAgB,08BAAG,EAAC,C;;;;;;;;;;;ACApgC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/exam-analysis/exam-analysis.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/exam-analysis/exam-analysis.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./exam-analysis.vue?vue&type=template&id=36a69848&scoped=true&\"\nvar renderjs\nimport script from \"./exam-analysis.vue?vue&type=script&lang=js&\"\nexport * from \"./exam-analysis.vue?vue&type=script&lang=js&\"\nimport style0 from \"./exam-analysis.vue?vue&type=style&index=0&id=36a69848&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"36a69848\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/exam-analysis/exam-analysis.vue\"\nexport default component.exports","export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./exam-analysis.vue?vue&type=template&id=36a69848&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.examImageFileIDs.length\n  var g1 = _vm.examImageFileIDs.length\n  var g2 = _vm.examImages.length\n  var g3 = _vm.analysisImageFileIDs.length\n  var g4 = _vm.analysisImageFileIDs.length\n  var g5 = _vm.analysisImages.length\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        g2: g2,\n        g3: g3,\n        g4: g4,\n        g5: g5,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./exam-analysis.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./exam-analysis.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"page-container\">\n    <view class=\"exam-analysis-container\">\n      <!-- 顶部导航栏 -->\n      <view class=\"nav-bar\">\n        <view class=\"back-btn\" @click=\"goBack\">\n          <text class=\"back-icon\">←</text>\n        </view>\n        <view class=\"nav-title\">试卷分析</view>\n      </view>\n      \n      <!-- 主要内容区域 -->\n      <view class=\"content\">\n        <!-- 基本信息选择 -->\n        <view class=\"section\">\n          <view class=\"section-title\">基本信息</view>\n          \n          <!-- 年级选择 -->\n          <view class=\"form-item\">\n            <text class=\"label\">年级</text>\n            <picker @change=\"onGradeChange\" :value=\"gradeIndex\" :range=\"gradeList\">\n              <view class=\"picker-box\">\n                <text>{{ selectedGrade }}</text>\n                <text class=\"arrow\">></text>\n              </view>\n            </picker>\n          </view>\n          \n          <!-- 学生选择 -->\n          <view class=\"form-item\">\n            <text class=\"label\">学生</text>\n            <picker @change=\"onStudentChange\" :value=\"studentIndex\" :range=\"studentList\" range-key=\"studentName\">\n              <view class=\"picker-box\">\n                <text>{{ selectedStudent ? selectedStudent.studentName : '请选择学生' }}</text>\n                <text class=\"arrow\">></text>\n              </view>\n            </picker>\n          </view>\n          \n          <!-- 年份选择 -->\n          <view class=\"form-item\">\n            <text class=\"label\">年份</text>\n            <picker @change=\"onYearChange\" :value=\"yearIndex\" :range=\"yearList\">\n              <view class=\"picker-box\">\n                <text>{{ selectedYear }}</text>\n                <text class=\"arrow\">></text>\n              </view>\n            </picker>\n          </view>\n          \n          <!-- 月份选择 -->\n          <view class=\"form-item\">\n            <text class=\"label\">月份</text>\n            <picker @change=\"onMonthChange\" :value=\"monthIndex\" :range=\"monthList\">\n              <view class=\"picker-box\">\n                <text>{{ selectedMonth }}</text>\n                <text class=\"arrow\">></text>\n              </view>\n            </picker>\n          </view>\n          \n          <!-- 考试类型选择 -->\n          <view class=\"form-item\">\n            <text class=\"label\">考试类型</text>\n            <view class=\"exam-type-container\">\n              <view class=\"exam-type-list\">\n                <view \n                  v-for=\"(type, index) in examTypes\" \n                  :key=\"index\"\n                  class=\"exam-type-item\"\n                  :class=\"{ active: selectedExamType === type }\"\n                  @click=\"selectExamType(type)\"\n                >\n                  {{ type }}\n                </view>\n              </view>\n              <view class=\"custom-exam-type\">\n                <input \n                  v-model=\"customExamType\" \n                  placeholder=\"自定义考试类型\"\n                  class=\"custom-input\"\n                  @input=\"onCustomTypeInput\"\n                />\n              </view>\n            </view>\n          </view>\n        </view>\n        \n        <!-- 试卷上传 -->\n        <view class=\"section\">\n          <view class=\"section-title\">试卷上传</view>\n          <view class=\"upload-container\">\n            <view class=\"upload-list\">\n              <!-- 显示云存储的图片 -->\n              <view \n                v-for=\"(fileID, index) in examImageFileIDs\" \n                :key=\"index\"\n                class=\"upload-item\"\n              >\n                <image :src=\"fileID\" class=\"upload-image\" mode=\"aspectFit\" @click=\"openImageZoom(examImageFileIDs, index)\" />\n                <view class=\"delete-btn\" @click=\"deleteCloudExamImage(index)\">×</view>\n              </view>\n              <!-- 显示本地新选择的图片 -->\n              <view \n                v-for=\"(image, index) in examImages\" \n                :key=\"index + examImageFileIDs.length\"\n                class=\"upload-item\"\n              >\n                <image :src=\"image\" class=\"upload-image\" mode=\"aspectFit\" @click=\"openImageZoom(examImages, index)\" />\n                <view class=\"delete-btn\" @click=\"deleteLocalExamImage(index)\">×</view>\n              </view>\n              <view v-if=\"(examImageFileIDs.length + examImages.length) < 5\" class=\"upload-btn\" @click=\"chooseImage\">\n                <text class=\"plus\">+</text>\n                <text class=\"upload-text\">上传试卷</text>\n              </view>\n            </view>\n          </view>\n        </view>\n        \n        <!-- 试卷分析 -->\n        <view class=\"section\">\n          <view class=\"section-title\">试卷分析</view>\n          <view class=\"analysis-container\">\n            <textarea \n              v-model=\"analysisText\"\n              placeholder=\"请输入试卷分析内容，支持粘贴文本...\"\n              class=\"analysis-textarea\"\n              :maxlength=\"2000\"\n              show-confirm-bar=\"false\"\n            />\n            <view class=\"analysis-upload\">\n              <view class=\"upload-list\">\n                <!-- 显示云存储的分析图片 -->\n                <view \n                  v-for=\"(fileID, index) in analysisImageFileIDs\" \n                  :key=\"index\"\n                  class=\"upload-item\"\n                >\n                  <image :src=\"fileID\" class=\"upload-image\" mode=\"aspectFit\" @click=\"openImageZoom(analysisImageFileIDs, index)\" />\n                  <view class=\"delete-btn\" @click=\"deleteCloudAnalysisImage(index)\">×</view>\n                </view>\n                <!-- 显示本地新选择的分析图片 -->\n                <view \n                  v-for=\"(image, index) in analysisImages\" \n                  :key=\"index + analysisImageFileIDs.length\"\n                  class=\"upload-item\"\n                >\n                  <image :src=\"image\" class=\"upload-image\" mode=\"aspectFit\" @click=\"openImageZoom(analysisImages, index)\" />\n                  <view class=\"delete-btn\" @click=\"deleteLocalAnalysisImage(index)\">×</view>\n                </view>\n                <view v-if=\"(analysisImageFileIDs.length + analysisImages.length) < 3\" class=\"upload-btn\" @click=\"chooseAnalysisImage\">\n                  <text class=\"plus\">+</text>\n                  <text class=\"upload-text\">上传分析图片</text>\n                </view>\n              </view>\n            </view>\n          </view>\n        </view>\n        \n        <!-- 难度评分 -->\n        <view class=\"section\">\n          <view class=\"section-title\">考试难度</view>\n          <view class=\"rating-container\">\n            <view class=\"stars\">\n              <view \n                v-for=\"index in 5\" \n                :key=\"index\"\n                class=\"star\"\n                :class=\"{ active: index <= difficultyRating }\"\n                @click=\"setDifficultyRating(index)\"\n              >\n                ★\n              </view>\n            </view>\n            <text class=\"rating-text\"></text>\n          </view>\n        </view>\n        \n        <!-- 学生答题效果 -->\n        <view class=\"section\">\n          <view class=\"section-title\">学生答题效果</view>\n          <view class=\"rating-container\">\n            <view class=\"stars\">\n              <view \n                v-for=\"index in 5\" \n                :key=\"index\"\n                class=\"star\"\n                :class=\"{ active: index <= studentPerformance }\"\n                @click=\"setStudentPerformance(index)\"\n              >\n                ★\n              </view>\n            </view>\n            <text class=\"rating-text\"></text>\n          </view>\n        </view>\n        \n            <!-- 提交按钮 -->\n      <view class=\"submit-section\">\n        <button class=\"submit-btn\" @click=\"submitAnalysis\">{{ isEdit ? '更新分析' : '提交分析' }}</button>\n      </view>\n      \n      <!-- 查看列表按钮 -->\n      <view class=\"list-section\">\n        <button class=\"list-btn\" @click=\"goToList\">查看分析列表</button>\n      </view>\n      \n      \n\n      </view>\n    </view>\n    \n    <!-- 图片放大查看组件 -->\n    <ImageZoomViewer\n      :visible=\"showImageZoom\"\n      :images=\"currentImages\"\n      :currentIndex=\"currentImageIndex\"\n      @close=\"closeImageZoom\"\n      @switch=\"switchImage\"\n    />\n  </view>\n</template>\n\n<script>\nimport ImageZoomViewer from '@/components/ImageZoomViewer.vue'\n\nexport default {\n  components: {\n    ImageZoomViewer\n  },\n  data() {\n    return {\n      // 年级相关\n      gradeList: [],\n      gradeIndex: 0,\n      selectedGrade: '',\n      \n      // 学生相关\n      studentList: [],\n      studentIndex: 0,\n      selectedStudent: null,\n      \n      // 年份相关\n      yearList: [],\n      yearIndex: 0,\n      selectedYear: '',\n      \n      // 月份相关\n      monthList: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],\n      monthIndex: 0,\n      selectedMonth: '',\n      \n      // 考试类型\n      examTypes: ['期中', '元调', '二调', '四调', '中考', '月考', '期末'],\n      selectedExamType: '',\n      customExamType: '',\n      \n      // 试卷图片 - 分别存储云存储文件ID和本地图片路径\n      examImages: [], // 本地新选择的图片路径\n      examImageFileIDs: [], // 云存储的文件ID\n      \n      // 分析内容\n      analysisText: '',\n      analysisImages: [], // 本地新选择的图片路径\n      analysisImageFileIDs: [], // 云存储的文件ID\n      \n      // 评分\n      difficultyRating: 0,\n      studentPerformance: 0,\n      \n      // 编辑模式\n      isEdit: false,\n      editId: '',\n      \n      // 图片放大查看\n      showImageZoom: false,\n      currentImages: [],\n      currentImageIndex: 0\n    }\n  },\n  \n  onLoad(options) {\n    try {\n      console.log('试卷分析页面加载开始')\n      \n      // 检查用户登录状态\n      const userInfo = uni.getStorageSync('userInfo')\n      console.log('onLoad - userInfo:', userInfo)\n      \n      this.initYearList()\n      this.initDefaultValues()\n      this.loadGradeList()\n      \n      // 检查是否为编辑模式\n      if (options.id) {\n        this.isEdit = true\n        this.editId = options.id\n        // 延迟加载详情，确保年份列表已初始化\n        setTimeout(() => {\n          this.loadAnalysisDetail(options.id)\n        }, 100)\n      }\n      console.log('试卷分析页面加载完成')\n    } catch (error) {\n      console.error('试卷分析页面加载失败:', error)\n      uni.showToast({\n        title: '页面加载失败',\n        icon: 'none'\n      })\n    }\n  },\n  \n  methods: {\n    // 初始化年份列表\n    initYearList() {\n      try {\n        console.log('初始化年份列表')\n        const currentYear = new Date().getFullYear()\n        for (let i = currentYear - 5; i <= currentYear + 1; i++) {\n          this.yearList.push(i + '年')\n        }\n        this.selectedYear = this.yearList[0]\n        console.log('年份列表初始化完成:', this.yearList)\n      } catch (error) {\n        console.error('初始化年份列表失败:', error)\n      }\n    },\n    \n    // 初始化默认值\n    initDefaultValues() {\n      try {\n        console.log('初始化默认值')\n        const currentMonth = new Date().getMonth()\n        this.monthIndex = currentMonth\n        this.selectedMonth = this.monthList[currentMonth]\n        console.log('默认值初始化完成:', { monthIndex: this.monthIndex, selectedMonth: this.selectedMonth })\n      } catch (error) {\n        console.error('初始化默认值失败:', error)\n      }\n    },\n    \n    // 年级选择\n    onGradeChange(e) {\n      this.gradeIndex = e.detail.value\n      this.selectedGrade = this.gradeList[this.gradeIndex]\n      this.loadStudentsByGrade()\n    },\n    \n    // 学生选择\n    onStudentChange(e) {\n      this.studentIndex = e.detail.value\n      this.selectedStudent = this.studentList[this.studentIndex]\n    },\n    \n    // 根据年级加载学生列表\n    async loadStudentsByGrade() {\n      if (!this.selectedGrade) return\n      \n      try {\n        const userInfo = uni.getStorageSync('userInfo')\n        console.log('loadStudentsByGrade - userInfo:', userInfo)\n        if (!userInfo) {\n          uni.showToast({ title: '请先登录', icon: 'none' })\n          return\n        }\n        \n        const result = await uniCloud.callFunction({\n          name: 'student-hours',\n          data: {\n            action: 'getMyClassStudentsByType',\n            teacherId: userInfo._id\n          }\n        })\n        \n        if (result.result.code === 200) {\n          const allStudents = [\n            ...result.result.data.classStudents,\n            ...result.result.data.oneToOneStudents\n          ]\n          \n          // 筛选指定年级的所有学生（包括一对一、班课、托产生）\n          this.studentList = allStudents.filter(student => \n            student.grade === this.selectedGrade\n          )\n          \n          // 重置学生选择\n          this.selectedStudent = null\n          this.studentIndex = 0\n          \n          console.log('加载学生列表完成:', this.studentList)\n        } else {\n          uni.showToast({ title: result.result.message || '加载学生失败', icon: 'none' })\n        }\n      } catch (error) {\n        console.error('加载学生列表失败:', error)\n        uni.showToast({ title: '加载学生失败，请重试', icon: 'none' })\n      }\n    },\n    \n    // 加载年级列表\n    async loadGradeList() {\n      try {\n        const userInfo = uni.getStorageSync('userInfo')\n        console.log('loadGradeList - userInfo:', userInfo)\n        if (!userInfo) {\n          uni.showToast({ title: '请先登录', icon: 'none' })\n          return\n        }\n        \n        const result = await uniCloud.callFunction({\n          name: 'student-hours',\n          data: {\n            action: 'getMyClassStudentsByType',\n            teacherId: userInfo._id\n          }\n        })\n        \n        if (result.result.code === 200) {\n          const allStudents = [\n            ...result.result.data.classStudents,\n            ...result.result.data.oneToOneStudents\n          ]\n          \n          // 获取所有年级并去重\n          const grades = [...new Set(allStudents.map(student => student.grade).filter(Boolean))]\n          this.gradeList = grades.sort()\n          \n          if (this.gradeList.length > 0) {\n            this.selectedGrade = this.gradeList[0]\n            this.gradeIndex = 0\n            // 加载第一个年级的学生\n            await this.loadStudentsByGrade()\n          }\n          \n          console.log('加载年级列表完成:', this.gradeList)\n        } else {\n          uni.showToast({ title: result.result.message || '加载年级失败', icon: 'none' })\n        }\n      } catch (error) {\n        console.error('加载年级列表失败:', error)\n        uni.showToast({ title: '加载年级失败，请重试', icon: 'none' })\n      }\n    },\n    \n    // 年份选择\n    onYearChange(e) {\n      this.yearIndex = e.detail.value\n      this.selectedYear = this.yearList[this.yearIndex]\n    },\n    \n    // 月份选择\n    onMonthChange(e) {\n      this.monthIndex = e.detail.value\n      this.selectedMonth = this.monthList[this.monthIndex]\n    },\n    \n    // 选择考试类型\n    selectExamType(type) {\n      this.selectedExamType = type\n      this.customExamType = ''\n    },\n    \n    // 自定义考试类型输入\n    onCustomTypeInput(e) {\n      this.customExamType = e.detail.value\n      this.selectedExamType = ''\n    },\n    \n    // 选择试卷图片\n    chooseImage() {\n      uni.chooseImage({\n        count: 5 - this.examImages.length,\n        sizeType: ['compressed'],\n        sourceType: ['album', 'camera'],\n        success: (res) => {\n          this.examImages = [...this.examImages, ...res.tempFilePaths]\n        }\n      })\n    },\n    \n    // 删除试卷图片（保留原有方法以兼容）\n    deleteImage(index) {\n      this.examImages.splice(index, 1)\n    },\n    \n    // 选择分析图片\n    chooseAnalysisImage() {\n      uni.chooseImage({\n        count: 3 - this.analysisImages.length,\n        sizeType: ['compressed'],\n        sourceType: ['album', 'camera'],\n        success: (res) => {\n          this.analysisImages = [...this.analysisImages, ...res.tempFilePaths]\n        }\n      })\n    },\n    \n    // 删除分析图片（保留原有方法以兼容）\n    deleteAnalysisImage(index) {\n      this.analysisImages.splice(index, 1)\n    },\n    \n    // 设置难度评分\n    setDifficultyRating(rating) {\n      this.difficultyRating = rating\n    },\n\n    // 设置学生答题效果\n    setStudentPerformance(rating) {\n      this.studentPerformance = rating\n    },\n    \n    // 提交分析\n    async submitAnalysis() {\n      // 验证必填字段\n      if (!this.selectedYear || !this.selectedMonth || !this.selectedExamType && !this.customExamType) {\n        uni.showToast({\n          title: '请填写完整的基本信息',\n          icon: 'none'\n        })\n        return\n      }\n      \n      if (!this.selectedStudent || !this.selectedGrade) {\n        uni.showToast({\n          title: '请选择年级和学生',\n          icon: 'none'\n        })\n        return\n      }\n      \n             if ((!this.examImages || this.examImages.length === 0) && (!this.examImageFileIDs || this.examImageFileIDs.length === 0)) {\n        uni.showToast({\n          title: '请上传试卷图片',\n          icon: 'none'\n        })\n        return\n      }\n      \n             if ((!this.analysisText || this.analysisText.trim() === '') && (!this.analysisImages || this.analysisImages.length === 0) && (!this.analysisImageFileIDs || this.analysisImageFileIDs.length === 0)) {\n        uni.showToast({\n          title: '请填写试卷分析或上传分析图片',\n          icon: 'none'\n        })\n        return\n      }\n      \n      if (!this.difficultyRating || this.difficultyRating === 0) {\n        uni.showToast({\n          title: '请选择考试难度',\n          icon: 'none'\n        })\n        return\n      }\n      \n      if (!this.studentPerformance || this.studentPerformance === 0) {\n        uni.showToast({\n          title: '请选择学生答题效果',\n          icon: 'none'\n        })\n        return\n      }\n      \n      uni.showLoading({\n        title: '正在提交...'\n      })\n      \n      try {\n        console.log('开始上传图片到云存储')\n        \n        // 上传试卷图片到云存储（只上传本地新选择的图片）\n        const examImageFileIDs = [...this.examImageFileIDs] // 保留原有的云存储文件ID\n        for (let i = 0; i < this.examImages.length; i++) {\n          const imagePath = this.examImages[i]\n          const fileName = `exam_images/${Date.now()}_${i}_${Math.random().toString(36).substr(2, 9)}.jpg`\n          \n          try {\n            const uploadResult = await uniCloud.uploadFile({\n              filePath: imagePath,\n              cloudPath: fileName\n            })\n            examImageFileIDs.push(uploadResult.fileID)\n            console.log(`试卷图片 ${i + 1} 上传成功:`, uploadResult.fileID)\n          } catch (uploadError) {\n            console.error(`试卷图片 ${i + 1} 上传失败:`, uploadError)\n            // 检查是否是域名问题\n            if (uploadError.message && uploadError.message.includes('domain list')) {\n              throw new Error('图片上传失败：请检查微信小程序域名配置。请在微信开发者工具中配置云存储域名。')\n            } else {\n              throw new Error(`试卷图片 ${i + 1} 上传失败`)\n            }\n          }\n        }\n        \n        // 上传分析图片到云存储（只上传本地新选择的图片）\n        const analysisImageFileIDs = [...this.analysisImageFileIDs] // 保留原有的云存储文件ID\n        for (let i = 0; i < this.analysisImages.length; i++) {\n          const imagePath = this.analysisImages[i]\n          const fileName = `analysis_images/${Date.now()}_${i}_${Math.random().toString(36).substr(2, 9)}.jpg`\n          \n          try {\n            const uploadResult = await uniCloud.uploadFile({\n              filePath: imagePath,\n              cloudPath: fileName\n            })\n            analysisImageFileIDs.push(uploadResult.fileID)\n            console.log(`分析图片 ${i + 1} 上传成功:`, uploadResult.fileID)\n          } catch (uploadError) {\n            console.error(`分析图片 ${i + 1} 上传失败:`, uploadError)\n            // 检查是否是域名问题\n            if (uploadError.message && uploadError.message.includes('domain list')) {\n              throw new Error('图片上传失败：请检查微信小程序域名配置。请在微信开发者工具中配置云存储域名。')\n            } else {\n              throw new Error(`分析图片 ${i + 1} 上传失败`)\n            }\n          }\n        }\n        \n        console.log('所有图片上传完成，开始调用云函数')\n        \n        // 获取用户信息\n        const userInfo = uni.getStorageSync('userInfo')\n        if (!userInfo) {\n          throw new Error('用户信息不存在')\n        }\n        \n        const result = await uniCloud.callFunction({\n          name: 'exam-analysis',\n          data: {\n            action: this.isEdit ? 'update' : 'save',\n            data: {\n              ...(this.isEdit && { id: this.editId }),\n              year: this.selectedYear,\n              month: this.selectedMonth,\n              examType: this.selectedExamType || this.customExamType,\n              examImages: examImageFileIDs, // 使用云存储文件ID\n              analysisText: this.analysisText,\n              analysisImages: analysisImageFileIDs, // 使用云存储文件ID\n              difficultyRating: this.difficultyRating,\n              studentPerformance: this.studentPerformance,\n              studentId: this.selectedStudent._id,\n              studentName: this.selectedStudent.studentName,\n              grade: this.selectedGrade,\n              userId: userInfo._id,\n              userRole: userInfo.role,\n              userName: userInfo.teacherName || userInfo.username || '未知用户'\n            }\n          }\n        })\n        \n        console.log('云函数调用结果:', result)\n        uni.hideLoading()\n        \n        if (result.result.code === 0) {\n          uni.showToast({\n            title: this.isEdit ? '更新成功' : '提交成功',\n            icon: 'success'\n          })\n          \n          if (this.isEdit) {\n            // 编辑模式下返回上一页\n            setTimeout(() => {\n              uni.navigateBack()\n            }, 1500)\n          } else {\n            // 重置表单\n            this.resetForm()\n          }\n        } else {\n          console.error('提交失败:', result.result.message)\n          uni.showToast({\n            title: result.result.message || '提交失败',\n            icon: 'none'\n          })\n        }\n      } catch (error) {\n        uni.hideLoading()\n        console.error('提交失败:', error)\n        \n        // 如果是域名配置问题，显示更详细的提示\n        if (error.message && error.message.includes('域名配置')) {\n          uni.showModal({\n            title: '配置提示',\n            content: '图片上传失败，需要在微信开发者工具中配置云存储域名。\\n\\n配置步骤：\\n1. 点击右上角\"详情\"\\n2. 选择\"域名信息\"\\n3. 在\"uploadFile合法域名\"中添加云存储域名\\n4. 重新编译项目',\n            showCancel: false,\n            confirmText: '我知道了'\n          })\n        } else {\n          uni.showToast({\n            title: error.message || '提交失败，请重试',\n            icon: 'none'\n          })\n        }\n      }\n    },\n    \n    // 重置表单\n    resetForm() {\n      this.selectedYear = this.yearList[0]\n      this.yearIndex = 0\n      this.selectedMonth = this.monthList[new Date().getMonth()]\n      this.monthIndex = new Date().getMonth()\n      this.selectedExamType = ''\n      this.customExamType = ''\n      this.examImages = []\n      this.examImageFileIDs = [] // 重置云存储文件ID\n      this.analysisText = ''\n      this.analysisImages = []\n      this.analysisImageFileIDs = [] // 重置云存储文件ID\n      this.difficultyRating = 0\n      this.studentPerformance = 0\n      this.selectedGrade = this.gradeList[0] || ''\n      this.gradeIndex = 0\n      this.selectedStudent = null\n      this.studentIndex = 0\n      this.studentList = []\n      this.isEdit = false\n      this.editId = ''\n    },\n    \n    // 加载分析详情\n    async loadAnalysisDetail(id) {\n      try {\n        console.log('开始加载分析详情:', id)\n        const result = await uniCloud.callFunction({\n          name: 'exam-analysis',\n          data: {\n            action: 'getDetail',\n            data: { id }\n          }\n        })\n        \n        console.log('加载详情结果:', result)\n        \n        if (result.result.code === 0) {\n          const data = result.result.data\n          console.log('详情数据:', data)\n          \n          this.selectedYear = data.year\n          const yearIndex = this.yearList.indexOf(data.year)\n          this.yearIndex = yearIndex !== -1 ? yearIndex : 0\n          \n          this.selectedMonth = data.month\n          const monthIndex = this.monthList.indexOf(data.month)\n          this.monthIndex = monthIndex !== -1 ? monthIndex : 0\n          \n          // 如果找不到对应的索引，使用默认值\n          if (yearIndex === -1) {\n            this.selectedYear = this.yearList[0]\n          }\n          if (monthIndex === -1) {\n            this.selectedMonth = this.monthList[0]\n          }\n          \n          // 检查考试类型是否在预设列表中\n          const examTypeIndex = this.examTypes.indexOf(data.examType)\n          if (examTypeIndex !== -1) {\n            this.selectedExamType = data.examType\n            this.customExamType = ''\n          } else {\n            this.selectedExamType = ''\n            this.customExamType = data.examType\n          }\n                     // 处理试卷图片 - 如果是云存储文件ID，直接使用；如果是本地路径，清空（编辑时重新选择）\n           if (data.examImages && Array.isArray(data.examImages)) {\n             // 检查是否为云存储文件ID（以cloud://开头）\n             const cloudImages = data.examImages.filter(img => typeof img === 'string' && img.startsWith('cloud://'))\n             const localImages = data.examImages.filter(img => typeof img === 'string' && !img.startsWith('cloud://'))\n             \n             this.examImageFileIDs = cloudImages\n             this.examImages = [] // 编辑时清空本地图片，需要重新选择\n           } else {\n             this.examImageFileIDs = []\n             this.examImages = []\n           }\n          this.analysisText = data.analysisText || ''\n                     // 处理分析图片 - 如果是云存储文件ID，直接使用；如果是本地路径，清空（编辑时重新选择）\n           if (data.analysisImages && Array.isArray(data.analysisImages)) {\n             // 检查是否为云存储文件ID（以cloud://开头）\n             const cloudImages = data.analysisImages.filter(img => typeof img === 'string' && img.startsWith('cloud://'))\n             const localImages = data.analysisImages.filter(img => typeof img === 'string' && !img.startsWith('cloud://'))\n             \n             this.analysisImageFileIDs = cloudImages\n             this.analysisImages = [] // 编辑时清空本地图片，需要重新选择\n           } else {\n             this.analysisImageFileIDs = []\n             this.analysisImages = []\n           }\n          this.difficultyRating = data.difficultyRating\n          this.studentPerformance = data.studentPerformance\n          \n          // 设置年级和学生信息\n          if (data.grade) {\n            this.selectedGrade = data.grade\n            const gradeIndex = this.gradeList.indexOf(data.grade)\n            this.gradeIndex = gradeIndex !== -1 ? gradeIndex : 0\n          }\n          \n          if (data.studentId && data.studentName) {\n            // 需要重新加载学生列表来设置选中的学生\n            await this.loadStudentsByGrade()\n            const studentIndex = this.studentList.findIndex(student => student._id === data.studentId)\n            if (studentIndex !== -1) {\n              this.selectedStudent = this.studentList[studentIndex]\n              this.studentIndex = studentIndex\n            }\n          }\n          \n          console.log('详情加载完成')\n        } else {\n          console.error('加载详情失败:', result.result.message)\n          uni.showToast({\n            title: result.result.message || '加载失败',\n            icon: 'none'\n          })\n        }\n      } catch (error) {\n        console.error('加载详情失败:', error)\n        uni.showToast({\n          title: '加载失败，请重试',\n          icon: 'none'\n        })\n      }\n    },\n    \n    // 跳转到列表页面\n    goToList() {\n      uni.navigateTo({\n        url: '/pages/exam-analysis/exam-analysis-list'\n      })\n    },\n    \n\n    \n    // 返回上一页\n    goBack() {\n      uni.navigateBack()\n    },\n    \n    // 打开图片放大查看\n    openImageZoom(images, currentIndex) {\n      if (!images || images.length === 0) {\n        uni.showToast({\n          title: '没有图片可预览',\n          icon: 'none'\n        })\n        return\n      }\n      \n      this.currentImages = images\n      this.currentImageIndex = currentIndex\n      this.showImageZoom = true\n    },\n    \n    // 关闭图片放大查看\n    closeImageZoom() {\n      this.showImageZoom = false\n      this.currentImages = []\n      this.currentImageIndex = 0\n    },\n    \n    // 切换图片\n    switchImage(index) {\n      this.currentImageIndex = index\n    },\n    \n    // 删除云存储的试卷图片\n    deleteCloudExamImage(index) {\n      const fileID = this.examImageFileIDs[index];\n      if (fileID) {\n        uniCloud.deleteFile({\n          fileList: [fileID]\n        }).then(() => {\n          this.examImageFileIDs.splice(index, 1);\n          uni.showToast({\n            title: '图片删除成功',\n            icon: 'success'\n          });\n        }).catch(err => {\n          console.error('删除云存储图片失败:', err);\n          uni.showToast({\n            title: '图片删除失败',\n            icon: 'none'\n          });\n        });\n      }\n    },\n\n    // 删除本地新选择的试卷图片\n    deleteLocalExamImage(index) {\n      this.examImages.splice(index, 1);\n      uni.showToast({\n        title: '图片删除成功',\n        icon: 'success'\n      });\n    },\n    \n         // 删除云存储的分析图片\n     deleteCloudAnalysisImage(index) {\n       const fileID = this.analysisImageFileIDs[index];\n       if (fileID) {\n         uniCloud.deleteFile({\n           fileList: [fileID]\n         }).then(() => {\n           this.analysisImageFileIDs.splice(index, 1);\n           uni.showToast({\n             title: '图片删除成功',\n             icon: 'success'\n           });\n         }).catch(err => {\n           console.error('删除云存储图片失败:', err);\n           uni.showToast({\n             title: '图片删除失败',\n             icon: 'none'\n           });\n         });\n       }\n     },\n\n     // 删除本地新选择的分析图片\n     deleteLocalAnalysisImage(index) {\n       this.analysisImages.splice(index, 1);\n       uni.showToast({\n         title: '图片删除成功',\n         icon: 'success'\n       });\n     },\n    \n    // 将图片转换为base64格式\n    imageToBase64(filePath) {\n      return new Promise((resolve, reject) => {\n        uni.getFileSystemManager().readFile({\n          filePath: filePath,\n          encoding: 'base64',\n          success: (res) => {\n            // 根据文件扩展名确定MIME类型\n            const ext = filePath.split('.').pop().toLowerCase()\n            let mimeType = 'image/jpeg'\n            if (ext === 'png') mimeType = 'image/png'\n            else if (ext === 'gif') mimeType = 'image/gif'\n            else if (ext === 'webp') mimeType = 'image/webp'\n            \n            const base64 = `data:${mimeType};base64,${res.data}`\n            resolve(base64)\n          },\n          fail: (err) => {\n            console.error('读取文件失败:', err)\n            reject(err)\n          }\n        })\n      })\n    },\n    \n    // 调试用户信息\n\n  }\n}\n</script>\n\n<style scoped>\n.page-container {\n  min-height: 100vh;\n  background-color: #f5f5f5;\n}\n\n.exam-analysis-container {\n  min-height: 100vh;\n}\n\n.nav-bar {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  height: 88rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n  padding-top: calc(var(--status-bar-height) + 15rpx);\n}\n\n.back-btn {\n  position: absolute;\n  left: 30rpx;\n  top: 50%;\n  transform: translateY(-50%);\n  width: 60rpx;\n  height: 60rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 50%;\n}\n\n.back-icon {\n  color: white;\n  font-size: 36rpx;\n  font-weight: bold;\n}\n\n.nav-title {\n  color: white;\n  font-size: 36rpx;\n  font-weight: bold;\n}\n\n.content {\n  padding: 50rpx 30rpx 30rpx 30rpx;\n}\n\n.section {\n  background: white;\n  border-radius: 20rpx;\n  padding: 30rpx;\n  margin-bottom: 30rpx;\n  box-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.1);\n}\n\n.section-title {\n  font-size: 32rpx;\n  font-weight: bold;\n  color: #333;\n  margin-bottom: 30rpx;\n  border-left: 8rpx solid #667eea;\n  padding-left: 20rpx;\n}\n\n.form-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 25rpx 0;\n  border-bottom: 1rpx solid #f0f0f0;\n}\n\n.form-item:last-child {\n  border-bottom: none;\n}\n\n.label {\n  font-size: 28rpx;\n  color: #333;\n  font-weight: 500;\n}\n\n.picker-box {\n  display: flex;\n  align-items: center;\n  color: #666;\n  font-size: 28rpx;\n}\n\n.arrow {\n  margin-left: 10rpx;\n  color: #999;\n}\n\n.exam-type-container {\n  width: 100%;\n}\n\n.exam-type-list {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 20rpx;\n  margin-bottom: 20rpx;\n}\n\n.exam-type-item {\n  padding: 15rpx 25rpx;\n  background: #f8f9fa;\n  border-radius: 25rpx;\n  font-size: 26rpx;\n  color: #666;\n  border: 2rpx solid transparent;\n  transition: all 0.3s;\n}\n\n.exam-type-item.active {\n  background: #667eea;\n  color: white;\n  border-color: #667eea;\n}\n\n.custom-input {\n  width: 100%;\n  padding: 20rpx;\n  border: 2rpx solid #e0e0e0;\n  border-radius: 10rpx;\n  font-size: 28rpx;\n  background: #fafafa;\n}\n\n.upload-container {\n  width: 100%;\n}\n\n.upload-list {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 20rpx;\n}\n\n.upload-item {\n  position: relative;\n  width: 200rpx;\n  height: 200rpx;\n}\n\n.upload-image {\n  width: 100%;\n  height: 100%;\n  border-radius: 10rpx;\n  border: 2rpx solid #e0e0e0;\n  cursor: pointer;\n  transition: transform 0.2s ease;\n}\n\n.upload-image:active {\n  transform: scale(0.95);\n}\n\n.delete-btn {\n  position: absolute;\n  top: -10rpx;\n  right: -10rpx;\n  width: 40rpx;\n  height: 40rpx;\n  background: #ff4757;\n  color: white;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 24rpx;\n  font-weight: bold;\n}\n\n.upload-btn {\n  width: 200rpx;\n  height: 200rpx;\n  border: 2rpx dashed #ccc;\n  border-radius: 10rpx;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  background: #fafafa;\n}\n\n.plus {\n  font-size: 60rpx;\n  color: #999;\n  margin-bottom: 10rpx;\n}\n\n.upload-text {\n  font-size: 24rpx;\n  color: #999;\n}\n\n.analysis-container {\n  width: 100%;\n}\n\n.analysis-textarea {\n  width: 100%;\n  min-height: 200rpx;\n  padding: 20rpx;\n  border: 2rpx solid #e0e0e0;\n  border-radius: 10rpx;\n  font-size: 28rpx;\n  background: #fafafa;\n  margin-bottom: 20rpx;\n}\n\n.analysis-upload {\n  width: 100%;\n}\n\n.rating-container {\n  display: flex;\n  align-items: center;\n  gap: 30rpx;\n}\n\n.stars {\n  display: flex;\n  gap: 10rpx;\n}\n\n.star {\n  font-size: 50rpx;\n  color: #ddd;\n  cursor: pointer;\n  transition: color 0.3s;\n}\n\n.star.active {\n  color: #ffd700;\n}\n\n.rating-text {\n  font-size: 28rpx;\n  color: #666;\n  font-weight: 500;\n}\n\n.submit-section {\n  margin-top: 50rpx;\n  padding: 0 30rpx;\n}\n\n.submit-btn {\n  width: 100%;\n  height: 90rpx;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n  border-radius: 45rpx;\n  font-size: 32rpx;\n  font-weight: bold;\n  border: none;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.submit-btn:active {\n  transform: scale(0.98);\n}\n\n.list-section {\n  margin-top: 30rpx;\n  padding: 0 30rpx;\n}\n\n.list-btn {\n  width: 100%;\n  height: 80rpx;\n  background: #f8f9fa;\n  color: #667eea;\n  border-radius: 40rpx;\n  font-size: 30rpx;\n  font-weight: bold;\n  border: 2rpx solid #667eea;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.list-btn:active {\n  transform: scale(0.98);\n}\n\n.debug-section {\n  margin-top: 20rpx;\n  padding: 0 30rpx;\n}\n\n.debug-btn {\n  width: 100%;\n  height: 60rpx;\n  background: #ff6b6b;\n  color: white;\n  border-radius: 30rpx;\n  font-size: 26rpx;\n  border: none;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.debug-btn:active {\n  transform: scale(0.98);\n}\n</style>\n","import mod from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./exam-analysis.vue?vue&type=style&index=0&id=36a69848&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./exam-analysis.vue?vue&type=style&index=0&id=36a69848&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1759362723318\n      var cssReload = require(\"D:/hbuilderx/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}