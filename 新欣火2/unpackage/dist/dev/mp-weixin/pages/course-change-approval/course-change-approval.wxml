<view class="approval-container data-v-7830e406"><view class="status-bar data-v-7830e406" style="{{(statusBarStyle)}}"></view><view class="top-bar data-v-7830e406" style="{{(topBarStyle)}}"><view class="nav-content data-v-7830e406"><view data-event-opts="{{[['tap',[['goBack',['$event']]]]]}}" class="back-btn data-v-7830e406" bindtap="__e"><text class="back-icon data-v-7830e406">‹</text><text class="back-text data-v-7830e406">返回</text></view><text class="page-title data-v-7830e406">调课审批</text></view></view><view class="filter-tabs data-v-7830e406"><view data-event-opts="{{[['tap',[['setFilter',['all']]]]]}}" class="{{['filter-tab','data-v-7830e406',(currentFilter==='all')?'active':'']}}" bindtap="__e">全部</view><view data-event-opts="{{[['tap',[['setFilter',['pending']]]]]}}" class="{{['filter-tab','data-v-7830e406',(currentFilter==='pending')?'active':'']}}" bindtap="__e">待审批</view><view data-event-opts="{{[['tap',[['setFilter',['approved']]]]]}}" class="{{['filter-tab','data-v-7830e406',(currentFilter==='approved')?'active':'']}}" bindtap="__e">已通过</view><view data-event-opts="{{[['tap',[['setFilter',['rejected']]]]]}}" class="{{['filter-tab','data-v-7830e406',(currentFilter==='rejected')?'active':'']}}" bindtap="__e">已拒绝</view></view><view class="application-list data-v-7830e406"><block wx:if="{{$root.g0===0}}"><view class="empty-state data-v-7830e406"><text class="empty-text data-v-7830e406">暂无调课申请</text></view></block><block wx:for="{{$root.l0}}" wx:for-item="application" wx:for-index="index" wx:key="_id"><view class="application-card data-v-7830e406"><view class="card-header data-v-7830e406"><view class="teacher-info data-v-7830e406"><text class="teacher-name data-v-7830e406">{{application.$orig.teacherName}}</text><text class="apply-time data-v-7830e406">{{application.m0}}</text></view><view class="{{['status-badge','data-v-7830e406',application.$orig.status==='pending'?'status-pending':application.$orig.status==='approved'?'status-approved':'status-rejected']}}">{{''+(application.$orig.status==='pending'?'待审批':application.$orig.status==='approved'?'已通过':'已拒绝')+''}}</view></view><view class="course-info data-v-7830e406"><view class="course-title data-v-7830e406">{{application.$orig.courseName}}</view><view class="time-change data-v-7830e406"><view class="original-time data-v-7830e406"><text class="time-label data-v-7830e406">原时间：</text><text class="time-value data-v-7830e406">{{application.$orig.originalDate+" "+application.$orig.originalTime}}</text></view><view class="arrow data-v-7830e406">→</view><view class="new-time data-v-7830e406"><text class="time-label data-v-7830e406">新时间：</text><text class="time-value data-v-7830e406">{{application.$orig.newDate+" "+application.$orig.newTime}}</text></view></view><view class="course-details data-v-7830e406"><text class="detail-item data-v-7830e406">{{"地点："+application.$orig.location}}</text><text class="detail-item data-v-7830e406">{{"班级："+application.$orig.className}}</text></view></view><view class="reason-section data-v-7830e406"><text class="reason-label data-v-7830e406">申请理由：</text><text class="reason-content data-v-7830e406">{{application.$orig.reason}}</text></view><block wx:if="{{application.$orig.status==='pending'}}"><view class="approval-actions data-v-7830e406"><button data-event-opts="{{[['tap',[['rejectApplication',['$0'],[[['filteredApplications','_id',application.$orig._id]]]]]]]}}" class="reject-btn data-v-7830e406" bindtap="__e">拒绝</button><button data-event-opts="{{[['tap',[['approveApplication',['$0'],[[['filteredApplications','_id',application.$orig._id]]]]]]]}}" class="approve-btn data-v-7830e406" bindtap="__e">通过</button></view></block><block wx:if="{{application.$orig.status!=='pending'}}"><view class="approval-result data-v-7830e406"><text class="result-text data-v-7830e406">{{''+(application.$orig.status==='approved'?'审批通过':'审批拒绝')+''}}<block wx:if="{{application.$orig.approvalTime}}"><text class="result-time data-v-7830e406">{{'('+application.m1+')'}}</text></block><block wx:if="{{application.$orig.approverName}}"><text class="result-approver data-v-7830e406">{{'- '+application.$orig.approverName}}</text></block></text><block wx:if="{{application.$orig.approvalRemark}}"><text class="approval-remark data-v-7830e406">{{'备注：'+application.$orig.approvalRemark+''}}</text></block></view></block></view></block></view><uni-popup vue-id="e427c480-1" type="dialog" data-ref="rejectDialog" class="data-v-7830e406 vue-ref" bind:__l="__l" vue-slots="{{['default']}}"><view class="reject-dialog-content data-v-7830e406"><view class="reject-title data-v-7830e406">请输入拒绝理由</view><textarea class="reject-textarea data-v-7830e406" placeholder="请填写拒绝调课理由" maxlength="200" data-event-opts="{{[['input',[['__set_model',['','rejectReason','$event',[]]]]]]}}" value="{{rejectReason}}" bindinput="__e"></textarea><view class="reject-dialog-actions data-v-7830e406"><button data-event-opts="{{[['tap',[['closeRejectDialog',['$event']]]]]}}" class="reject-cancel-btn data-v-7830e406" bindtap="__e">取消</button><button data-event-opts="{{[['tap',[['submitReject',['$event']]]]]}}" class="reject-confirm-btn data-v-7830e406" bindtap="__e">确定</button></view></view></uni-popup></view>