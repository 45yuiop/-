<view class="news-edit-container data-v-478d0dd0"><view class="nav-bar data-v-478d0dd0" style="{{'padding-top:'+(statusBarHeight+'px')+';'}}"><view class="nav-content data-v-478d0dd0"><view data-event-opts="{{[['tap',[['goBack',['$event']]]]]}}" class="back-btn data-v-478d0dd0" bindtap="__e"><image class="back-icon data-v-478d0dd0" src="/static/back-cartoon.svg" mode="aspectFit"></image></view><text class="nav-title data-v-478d0dd0">{{isEdit?'编辑':'发布'}}</text><view class="nav-right data-v-478d0dd0"></view></view></view><view class="edit-form data-v-478d0dd0" style="{{'padding-top:'+(statusBarHeight+44+'px')+';'+('padding-bottom:'+(safeAreaBottom+120+'px')+';')}}"><view class="form-group data-v-478d0dd0"><text class="form-label data-v-478d0dd0">标题 *</text><input class="form-input data-v-478d0dd0" placeholder="请输入标题" maxlength="100" data-event-opts="{{[['input',[['__set_model',['$0','title','$event',[]],['newsForm']]]]]}}" value="{{newsForm.title}}" bindinput="__e"/></view><view class="form-group data-v-478d0dd0"><text class="form-label data-v-478d0dd0">发布时间</text><picker class="date-picker data-v-478d0dd0" mode="date" value="{{newsForm.time}}" data-event-opts="{{[['change',[['onDateChange',['$event']]]]]}}" bindchange="__e"><view class="picker-display data-v-478d0dd0"><text class="data-v-478d0dd0">{{newsForm.time||'请选择日期'}}</text><text class="picker-arrow data-v-478d0dd0">></text></view></picker></view><view class="form-group data-v-478d0dd0"><text class="form-label data-v-478d0dd0">作者</text><input class="form-input data-v-478d0dd0" placeholder="请输入作者姓名" maxlength="50" data-event-opts="{{[['input',[['__set_model',['$0','author','$event',[]],['newsForm']]]]]}}" value="{{newsForm.author}}" bindinput="__e"/></view><view class="form-group data-v-478d0dd0"><view class="switch-container data-v-478d0dd0"><text class="form-label data-v-478d0dd0">置顶</text><switch checked="{{newsForm.isPinned}}" color="#007aff" data-event-opts="{{[['change',[['onPinChange',['$event']]]]]}}" bindchange="__e" class="data-v-478d0dd0"></switch></view><text class="switch-tip data-v-478d0dd0">开启后，此事件将显示在列表顶部</text></view><view class="form-group data-v-478d0dd0"><text class="form-label data-v-478d0dd0">内容 *</text><view class="content-editor data-v-478d0dd0"><view class="editor-toolbar data-v-478d0dd0"><button data-event-opts="{{[['tap',[['addTextBlock',['$event']]]]]}}" class="tool-btn data-v-478d0dd0" bindtap="__e"><text class="tool-icon data-v-478d0dd0">📝</text><text class="tool-text data-v-478d0dd0">添加文字</text></button><button data-event-opts="{{[['tap',[['addImageBlock',['$event']]]]]}}" class="tool-btn data-v-478d0dd0" bindtap="__e"><text class="tool-icon data-v-478d0dd0">🖼️</text><text class="tool-text data-v-478d0dd0">添加图片</text></button></view><view class="content-blocks data-v-478d0dd0"><block wx:for="{{$root.l0}}" wx:for-item="block" wx:for-index="index" wx:key="index"><view class="content-block data-v-478d0dd0"><block wx:if="{{block.$orig.type==='text'}}"><view class="text-block data-v-478d0dd0"><textarea class="text-input data-v-478d0dd0" placeholder="请输入文字内容" maxlength="1000" data-event-opts="{{[['input',[['__set_model',['$0','content','$event',[]],[[['newsForm.contentBlocks','',index]]]],['updateCharCount',['$event']]]]]}}" value="{{block.$orig.content}}" bindinput="__e"></textarea><view class="block-actions data-v-478d0dd0"><text class="char-count data-v-478d0dd0">{{block.g0+"/1000"}}</text><button data-event-opts="{{[['tap',[['removeBlock',[index]]]]]}}" class="action-btn delete data-v-478d0dd0" bindtap="__e">删除</button><button class="action-btn move-up data-v-478d0dd0" disabled="{{index===0}}" data-event-opts="{{[['tap',[['moveBlock',[index,-1]]]]]}}" bindtap="__e">上移</button><button class="action-btn move-down data-v-478d0dd0" disabled="{{index===block.g1-1}}" data-event-opts="{{[['tap',[['moveBlock',[index,1]]]]]}}" bindtap="__e">下移</button></view></view></block><block wx:else><block wx:if="{{block.$orig.type==='image'}}"><view class="image-block data-v-478d0dd0"><view class="image-preview data-v-478d0dd0"><image class="preview-image data-v-478d0dd0" src="{{block.$orig.imageUrl}}" mode="aspectFill" data-event-opts="{{[['tap',[['previewImage',['$0'],[[['newsForm.contentBlocks','',index,'imageUrl']]]]]]]}}" bindtap="__e"></image><button data-event-opts="{{[['tap',[['removeBlock',[index]]]]]}}" class="remove-image-btn data-v-478d0dd0" bindtap="__e">×</button></view><view class="image-caption data-v-478d0dd0"><input class="caption-input data-v-478d0dd0" placeholder="图片说明（可选）" maxlength="100" data-event-opts="{{[['input',[['__set_model',['$0','caption','$event',[]],[[['newsForm.contentBlocks','',index]]]]]]]}}" value="{{block.$orig.caption}}" bindinput="__e"/></view><view class="block-actions data-v-478d0dd0"><button class="action-btn move-up data-v-478d0dd0" disabled="{{index===0}}" data-event-opts="{{[['tap',[['moveBlock',[index,-1]]]]]}}" bindtap="__e">上移</button><button class="action-btn move-down data-v-478d0dd0" disabled="{{index===block.g2-1}}" data-event-opts="{{[['tap',[['moveBlock',[index,1]]]]]}}" bindtap="__e">下移</button></view></view></block></block></view></block><block wx:if="{{$root.g3===0}}"><view class="empty-content data-v-478d0dd0"><text class="data-v-478d0dd0">点击上方按钮添加内容块</text></view></block></view></view></view><view class="bottom-bar data-v-478d0dd0" style="{{'padding-bottom:'+(safeAreaBottom+'px')+';'}}"><button class="bottom-save-btn data-v-478d0dd0" disabled="{{!canSave||saving}}" data-event-opts="{{[['tap',[['saveNews',['$event']]]]]}}" bindtap="__e">{{''+(saving?'保存中...':'发布')+''}}</button></view></view></view>