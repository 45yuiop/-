<view class="container data-v-274e801e"><view class="custom-navbar data-v-274e801e"><view class="navbar-content data-v-274e801e"><view data-event-opts="{{[['tap',[['goBack',['$event']]]]]}}" class="navbar-left data-v-274e801e" bindtap="__e"><text class="back-icon data-v-274e801e">‹</text><text class="back-text data-v-274e801e">返回</text></view><text class="navbar-title data-v-274e801e">班级详情</text><view class="navbar-right data-v-274e801e"></view></view></view><block wx:if="{{classData}}"><view class="form-container data-v-274e801e"><view class="form-item data-v-274e801e"><text class="label data-v-274e801e">班级名称 *</text><input class="input data-v-274e801e" placeholder="请输入班级名称" maxlength="30" data-event-opts="{{[['input',[['__set_model',['$0','className','$event',[]],['classData']]]]]}}" value="{{classData.className}}" bindinput="__e"/></view><view class="form-item data-v-274e801e"><text class="label data-v-274e801e">年级</text><input class="input data-v-274e801e" placeholder="请输入年级" maxlength="20" data-event-opts="{{[['input',[['__set_model',['$0','grade','$event',[]],['classData']]]]]}}" value="{{classData.grade}}" bindinput="__e"/></view><view class="form-item data-v-274e801e"><text class="label data-v-274e801e">教师</text><view data-event-opts="{{[['tap',[['showTeacherModal',['$event']]]]]}}" class="teacher-selector data-v-274e801e" bindtap="__e"><view class="teacher-display data-v-274e801e"><block wx:if="{{!classData.teacherName}}"><text class="placeholder data-v-274e801e">请选择教师（可选）</text></block><block wx:else><view class="selected-teacher data-v-274e801e"><text class="teacher-text data-v-274e801e">{{classData.teacherName}}</text></view></block></view><text class="arrow data-v-274e801e">></text></view></view><view class="form-item data-v-274e801e"><view class="label-container data-v-274e801e"><text class="label data-v-274e801e">班级学生</text><view class="add-student-container data-v-274e801e"><button data-event-opts="{{[['tap',[['showAddStudentModal',['$event']]]]]}}" class="add-student-btn data-v-274e801e" bindtap="__e"><text class="add-btn-text data-v-274e801e">+ 添加学生</text></button></view></view><view class="student-list-container data-v-274e801e"><block wx:for="{{classData.students}}" wx:for-item="student" wx:for-index="index" wx:key="_id"><view class="student-item data-v-274e801e"><view class="student-info data-v-274e801e"><text class="student-name data-v-274e801e">{{student.name}}</text><text class="student-id data-v-274e801e">{{student.studentId}}</text></view><text data-event-opts="{{[['tap',[['removeStudentFromClass',['$0'],[[['classData.students','_id',student._id]]]]]]]}}" class="remove-student-btn data-v-274e801e" bindtap="__e">移除</text></view></block><block wx:if="{{$root.g0}}"><view class="no-students data-v-274e801e"><text class="no-students-text data-v-274e801e">暂无学生</text></view></block></view></view></view></block><view class="delete-button-container data-v-274e801e"><image class="delete-btn data-v-274e801e" src="/static/删除 .png" mode="aspectFit" data-event-opts="{{[['tap',[['deleteClass',['$event']]]]]}}" bindtap="__e"></image></view><block wx:if="{{showTeacherModalFlag}}"><view data-event-opts="{{[['tap',[['closeTeacherModal',['$event']]]]]}}" class="teacher-modal data-v-274e801e" bindtap="__e"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="teacher-modal-content data-v-274e801e" catchtap="__e"><view class="modal-header data-v-274e801e"><text class="modal-title data-v-274e801e">选择班主任</text><view data-event-opts="{{[['tap',[['closeTeacherModal',['$event']]]]]}}" class="close-btn data-v-274e801e" bindtap="__e"><text class="close-icon data-v-274e801e">×</text></view></view><view class="modal-body data-v-274e801e"><view class="search-container data-v-274e801e"><input class="search-input data-v-274e801e" placeholder="搜索老师姓名" data-event-opts="{{[['input',[['__set_model',['','teacherSearchKeyword','$event',[]]],['onTeacherSearchInput',['$event']]]]]}}" value="{{teacherSearchKeyword}}" bindinput="__e"/></view><view class="teacher-list data-v-274e801e"><block wx:for="{{$root.l0}}" wx:for-item="teacher" wx:for-index="__i0__" wx:key="_id"><view data-event-opts="{{[['tap',[['selectTeacher',['$0'],[[['filteredTeachers','_id',teacher.$orig._id]]]]]]]}}" class="{{['teacher-item','data-v-274e801e',(teacher.m0)?'selected':'']}}" bindtap="__e"><text class="teacher-name data-v-274e801e">{{teacher.$orig.teacherName||teacher.$orig.username}}</text><block wx:if="{{teacher.m1}}"><text class="check-icon data-v-274e801e">✓</text></block></view></block><block wx:if="{{$root.g1===0}}"><view class="empty-teacher-tip data-v-274e801e"><text class="empty-text data-v-274e801e">暂无匹配的老师</text></view></block></view></view><view class="modal-footer data-v-274e801e"><button data-event-opts="{{[['tap',[['closeTeacherModal',['$event']]]]]}}" class="cancel-btn data-v-274e801e" bindtap="__e">取消</button><button data-event-opts="{{[['tap',[['confirmTeacher',['$event']]]]]}}" class="confirm-btn data-v-274e801e" bindtap="__e">确定</button></view></view></view></block><block wx:if="{{showAddStudentModalFlag}}"><view data-event-opts="{{[['tap',[['closeAddStudentModal',['$event']]]]]}}" class="add-student-modal data-v-274e801e" bindtap="__e"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="add-student-modal-content data-v-274e801e" catchtap="__e"><view class="modal-header data-v-274e801e"><text class="modal-title data-v-274e801e">添加学生到班级</text><view data-event-opts="{{[['tap',[['closeAddStudentModal',['$event']]]]]}}" class="close-btn data-v-274e801e" bindtap="__e"><text class="close-icon data-v-274e801e">×</text></view></view><view class="modal-body data-v-274e801e"><view class="search-container data-v-274e801e"><input class="search-input data-v-274e801e" placeholder="搜索学生姓名或学号" data-event-opts="{{[['input',[['__set_model',['','studentSearchKeyword','$event',[]]],['onStudentSearchInput',['$event']]]]]}}" value="{{studentSearchKeyword}}" bindinput="__e"/></view><view class="student-selection-list data-v-274e801e"><block wx:for="{{$root.l1}}" wx:for-item="student" wx:for-index="__i1__" wx:key="_id"><view data-event-opts="{{[['tap',[['selectStudent',['$0'],[[['filteredStudents','_id',student.$orig._id]]]]]]]}}" class="{{['student-selection-item','data-v-274e801e',(student.m2)?'selected':'']}}" bindtap="__e"><view class="student-avatar data-v-274e801e"><text class="avatar-text data-v-274e801e">{{student.g2}}</text></view><view class="student-info data-v-274e801e"><text class="student-name data-v-274e801e">{{student.$orig.name}}</text><text class="student-details data-v-274e801e">{{student.$orig.studentId+" · "+student.$orig.grade}}</text></view><block wx:if="{{student.m3}}"><view class="selection-indicator data-v-274e801e"><text class="check-icon data-v-274e801e">✓</text></view></block></view></block><block wx:if="{{$root.g3===0}}"><view class="no-result data-v-274e801e"><text class="no-result-text data-v-274e801e">暂无匹配的学生</text></view></block></view></view><view class="modal-footer data-v-274e801e"><button data-event-opts="{{[['tap',[['closeAddStudentModal',['$event']]]]]}}" class="cancel-btn data-v-274e801e" bindtap="__e">取消</button><button class="confirm-btn data-v-274e801e" disabled="{{$root.g4===0}}" data-event-opts="{{[['tap',[['addSelectedStudentsToClass',['$event']]]]]}}" bindtap="__e">{{'添加 ('+$root.g5+')'}}</button></view></view></view></block></view>