<view class="teacher-schedule-page data-v-d1b561f2"><view class="back-btn-fixed data-v-d1b561f2"><button data-event-opts="{{[['tap',[['goHome',['$event']]]]]}}" class="back-btn data-v-d1b561f2" bindtap="__e"><text class="back-btn-icon data-v-d1b561f2">🏠</text></button></view><view class="main-content data-v-d1b561f2"><view class="title-bar data-v-d1b561f2"><view class="page-title data-v-d1b561f2">教师排课管理</view></view><view class="form-section card-bg data-v-d1b561f2"><view class="form-title data-v-d1b561f2">搜索并选择教师</view><input class="search-input data-v-d1b561f2" placeholder="🔍 输入教师姓名" data-event-opts="{{[['input',[['__set_model',['','searchKeyword','$event',['trim']]]]],['blur',[['$forceUpdate']]]]}}" value="{{searchKeyword}}" bindinput="__e" bindblur="__e"/><scroll-view class="teacher-list-scroll data-v-d1b561f2" scroll-y="{{true}}"><block wx:for="{{filteredTeacherList}}" wx:for-item="teacher" wx:for-index="idx" wx:key="username"><view data-event-opts="{{[['tap',[['selectTeacher',[idx]]]]]}}" class="teacher-item data-v-d1b561f2" bindtap="__e"><text class="{{['data-v-d1b561f2','teacher-name',idx===teacherIndex?'selected':'']}}">{{teacher.teacherName}}</text></view></block></scroll-view></view><block wx:if="{{selectedTeacher}}"><view class="card-bg courses-section data-v-d1b561f2"><view class="results-title data-v-d1b561f2">{{selectedTeacher.teacherName+" "+weekTitle}}</view><view class="week-nav data-v-d1b561f2"><button data-event-opts="{{[['tap',[['changeWeek',[-1]]]]]}}" class="week-btn data-v-d1b561f2" bindtap="__e">上一周</button><text class="week-range data-v-d1b561f2">{{weekRangeText}}</text><button data-event-opts="{{[['tap',[['changeWeek',[1]]]]]}}" class="week-btn data-v-d1b561f2" bindtap="__e">下一周</button></view><block wx:if="{{isLoading}}"><view class="loading-text data-v-d1b561f2">课程加载中...</view></block><block wx:else><view class="data-v-d1b561f2"><block wx:for="{{$root.l1}}" wx:for-item="day" wx:for-index="idx" wx:key="course_date"><view class="day-schedule-block data-v-d1b561f2"><view class="day-date data-v-d1b561f2">{{day.m0}}</view><view class="day-courses data-v-d1b561f2"><block wx:for="{{day.l0}}" wx:for-item="i" wx:for-index="__i0__" wx:key="$orig"><view class="course-row-vertical data-v-d1b561f2"><view class="course-label-row data-v-d1b561f2">{{''+periodTimes[i.$orig-1]+(i.$orig===5||i.$orig===6?'（习惯班）':'')+''}}</view><view class="course-inputs-row data-v-d1b561f2"><block wx:if="{{i.$orig===5||i.$orig===6}}"><input class="{{['data-v-d1b561f2','course-input',day.$orig['course_slot_'+i.$orig]?'has-content':'']}}" placeholder="课程名" data-event-opts="{{[['focus',[['onInputFocus',['$event']]]],['input',[['__set_model',['$0','course_slot_'+i.$orig,'$event',[]],[[['weekSchedule','course_date',day.$orig.course_date]]]],['onInputChange',['$event',idx,'$0',''],[[['periods','',__i0__]]]]]]]}}" value="{{day.$orig['course_slot_'+i.$orig]}}" bindfocus="__e" bindinput="__e"/><picker class="class-picker data-v-d1b561f2" value="{{i.m1}}" range="{{courseOptions}}" data-event-opts="{{[['change',[['onClassOptionChange',['$event',idx,'$0'],[[['periods','',__i0__]]]]]]]}}" bindchange="__e"><view class="class-display data-v-d1b561f2"><text class="data-v-d1b561f2">{{day.$orig['course_slot_'+i.$orig+'_class']||'课程名'}}</text><text class="class-arrow data-v-d1b561f2">▼</text></view></picker><input class="{{['data-v-d1b561f2','course-input','location-input',day.$orig['course_slot_'+i.$orig+'_location']?'has-content':'']}}" placeholder="教室" data-event-opts="{{[['focus',[['onInputFocus',['$event']]]],['input',[['__set_model',['$0','course_slot_'+i.$orig+'_location','$event',[]],[[['weekSchedule','course_date',day.$orig.course_date]]]],['onInputChange',['$event',idx,'$0','location'],[[['periods','',__i0__]]]]]]]}}" value="{{day.$orig['course_slot_'+i.$orig+'_location']}}" bindfocus="__e" bindinput="__e"/><picker class="type-picker data-v-d1b561f2" value="{{i.m2}}" range="{{courseTypes}}" data-event-opts="{{[['change',[['onTypeChange',['$event',idx,'$0'],[[['periods','',__i0__]]]]]]]}}" bindchange="__e"><view class="type-display data-v-d1b561f2"><text class="data-v-d1b561f2">{{day.$orig['course_slot_'+i.$orig+'_type']||'无'}}</text><text class="type-arrow data-v-d1b561f2">▼</text></view></picker></block><block wx:else><input class="{{['data-v-d1b561f2','course-input',day.$orig['course_slot_'+i.$orig]?'has-content':'']}}" placeholder="课程名" data-event-opts="{{[['focus',[['onInputFocus',['$event']]]],['input',[['__set_model',['$0','course_slot_'+i.$orig,'$event',[]],[[['weekSchedule','course_date',day.$orig.course_date]]]],['onInputChange',['$event',idx,'$0',''],[[['periods','',__i0__]]]]]]]}}" value="{{day.$orig['course_slot_'+i.$orig]}}" bindfocus="__e" bindinput="__e"/><input class="{{['data-v-d1b561f2','course-input','class-input',day.$orig['course_slot_'+i.$orig+'_class']?'has-content':'']}}" placeholder="班级" data-event-opts="{{[['focus',[['onInputFocus',['$event']]]],['input',[['__set_model',['$0','course_slot_'+i.$orig+'_class','$event',[]],[[['weekSchedule','course_date',day.$orig.course_date]]]],['onInputChange',['$event',idx,'$0','class'],[[['periods','',__i0__]]]]]]]}}" value="{{day.$orig['course_slot_'+i.$orig+'_class']}}" bindfocus="__e" bindinput="__e"/><input class="{{['data-v-d1b561f2','course-input','location-input',day.$orig['course_slot_'+i.$orig+'_location']?'has-content':'']}}" placeholder="教室" data-event-opts="{{[['focus',[['onInputFocus',['$event']]]],['input',[['__set_model',['$0','course_slot_'+i.$orig+'_location','$event',[]],[[['weekSchedule','course_date',day.$orig.course_date]]]],['onInputChange',['$event',idx,'$0','location'],[[['periods','',__i0__]]]]]]]}}" value="{{day.$orig['course_slot_'+i.$orig+'_location']}}" bindfocus="__e" bindinput="__e"/><picker class="type-picker data-v-d1b561f2" value="{{i.m3}}" range="{{courseTypes}}" data-event-opts="{{[['change',[['onTypeChange',['$event',idx,'$0'],[[['periods','',__i0__]]]]]]]}}" bindchange="__e"><view class="type-display data-v-d1b561f2"><text class="data-v-d1b561f2">{{day.$orig['course_slot_'+i.$orig+'_type']||'无'}}</text><text class="type-arrow data-v-d1b561f2">▼</text></view></picker></block></view><block wx:if="{{i.$orig!==5&&i.$orig!==6}}"><block wx:if="{{day.$orig['course_slot_'+i.$orig+'_remark']}}"><view class="course-remark-show data-v-d1b561f2">{{"备注："+day.$orig['course_slot_'+i.$orig+'_remark']}}</view></block><view class="course-remark-row data-v-d1b561f2"><input class="{{['data-v-d1b561f2','course-remark-input',day.$orig['course_slot_'+i.$orig+'_remark']?'has-content':'']}}" placeholder="备注（可选）" data-event-opts="{{[['focus',[['onInputFocus',['$event']]]],['input',[['__set_model',['$0','course_slot_'+i.$orig+'_remark','$event',[]],[[['weekSchedule','course_date',day.$orig.course_date]]]],['onInputChange',['$event',idx,'$0','remark'],[[['periods','',__i0__]]]]]]]}}" value="{{day.$orig['course_slot_'+i.$orig+'_remark']}}" bindfocus="__e" bindinput="__e"/></view></block></view></block></view></view></block></view></block></view></block><view class="save-btn-fixed data-v-d1b561f2"><button data-event-opts="{{[['tap',[['saveSchedule',['$event']]]]]}}" class="save-btn data-v-d1b561f2" bindtap="__e"><text class="icon data-v-d1b561f2">💾</text>保存排课</button></view></view></view>