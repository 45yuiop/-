<view class="container data-v-0cccd6b3"><view class="page-header animated-card data-v-0cccd6b3"><view data-event-opts="{{[['tap',[['goBack',['$event']]]]]}}" class="back-button data-v-0cccd6b3" bindtap="__e"><text class="back-icon data-v-0cccd6b3">â†</text></view><text class="page-title data-v-0cccd6b3">ç­çº§ç®¡ç†</text></view><view class="search-filter-section animated-card data-v-0cccd6b3"><view class="search-container data-v-0cccd6b3"><input class="search-input data-v-0cccd6b3" placeholder="ğŸ” æœç´¢ç­çº§åç§°" data-event-opts="{{[['input',[['__set_model',['','searchKeyword','$event',[]]],['onSearchInput',['$event']]]]]}}" value="{{searchKeyword}}" bindinput="__e"/><text class="search-icon data-v-0cccd6b3">ğŸ”</text></view><view class="filter-container data-v-0cccd6b3"><view class="filter-group data-v-0cccd6b3"><text class="filter-label data-v-0cccd6b3">å¹´çº§ï¼š</text><picker class="filter-picker data-v-0cccd6b3" value="{{gradeIndex}}" range="{{gradeOptions}}" data-event-opts="{{[['change',[['onGradeChange',['$event']]]]]}}" bindchange="__e"><view class="picker-display data-v-0cccd6b3"><text class="picker-text data-v-0cccd6b3">{{gradeOptions[gradeIndex]}}</text><text class="picker-arrow data-v-0cccd6b3">â–¼</text></view></picker></view><view class="filter-group data-v-0cccd6b3"><text class="filter-label data-v-0cccd6b3">ç§‘ç›®ï¼š</text><picker class="filter-picker data-v-0cccd6b3" value="{{subjectIndex}}" range="{{subjectOptions}}" data-event-opts="{{[['change',[['onSubjectChange',['$event']]]]]}}" bindchange="__e"><view class="picker-display data-v-0cccd6b3"><text class="picker-text data-v-0cccd6b3">{{subjectOptions[subjectIndex]}}</text><text class="picker-arrow data-v-0cccd6b3">â–¼</text></view></picker></view></view></view><view class="class-list data-v-0cccd6b3"><block wx:if="{{$root.g0===0}}"><view class="no-result-tip data-v-0cccd6b3"><text class="no-result-text data-v-0cccd6b3">æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç­çº§</text></view></block><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="index" wx:key="_id"><view data-event-opts="{{[['tap',[['openClassDetail',['$0'],[[['filteredClassList','_id',item.$orig._id]]]]]]]}}" class="class-item animated-card data-v-0cccd6b3" bindtap="__e"><view class="class-header data-v-0cccd6b3"><view class="class-badge data-v-0cccd6b3"><text class="class-badge-text data-v-0cccd6b3">ç­</text></view><view class="class-info-main data-v-0cccd6b3"><text class="class-name data-v-0cccd6b3">{{item.$orig.className||item.$orig.class_name||'æœªå‘½åç­çº§'}}</text><block wx:if="{{item.$orig.grade}}"><text class="class-grade-badge data-v-0cccd6b3">{{item.$orig.grade}}</text></block></view><view class="student-count-badge data-v-0cccd6b3"><text class="count-text data-v-0cccd6b3">{{(item.$orig.students?item.g1:0)+"äºº"}}</text></view></view><view class="class-details data-v-0cccd6b3"><view class="detail-row data-v-0cccd6b3"><text class="detail-label data-v-0cccd6b3">ç­ä¸»ä»»ï¼š</text><block wx:if="{{item.g2}}"><text class="detail-value data-v-0cccd6b3">{{''+item.m0+''}}</text></block><block wx:else><text class="detail-value empty-value data-v-0cccd6b3">æœªè®¾ç½®</text></block></view></view><view class="class-actions data-v-0cccd6b3"><text data-event-opts="{{[['tap',[['deleteClass',['$0'],[[['filteredClassList','_id',item.$orig._id]]]]]]]}}" class="delete-btn data-v-0cccd6b3" catchtap="__e">åˆ é™¤</text></view></view></block></view><block wx:if="{{showAddClassModalFlag}}"><view class="modal data-v-0cccd6b3"><view class="modal-content animated-modal data-v-0cccd6b3"><view class="modal-header data-v-0cccd6b3"><text class="modal-title data-v-0cccd6b3">æ–°å»ºç­çº§</text><text data-event-opts="{{[['tap',[['closeAddClassModal',['$event']]]]]}}" class="close-btn data-v-0cccd6b3" bindtap="__e">Ã—</text></view><view class="modal-body data-v-0cccd6b3"><view class="form-group data-v-0cccd6b3"><label class="form-label data-v-0cccd6b3">ç­çº§åç§°</label><input class="search-input data-v-0cccd6b3" placeholder="è¯·è¾“å…¥ç­çº§åç§°" data-event-opts="{{[['input',[['__set_model',['$0','className','$event',[]],['newClass']]]]]}}" value="{{newClass.className}}" bindinput="__e"/></view><view class="form-group data-v-0cccd6b3"><label class="form-label data-v-0cccd6b3">å¹´çº§</label><input class="search-input data-v-0cccd6b3" placeholder="è¯·è¾“å…¥å¹´çº§" data-event-opts="{{[['input',[['__set_model',['$0','grade','$event',[]],['newClass']]]]]}}" value="{{newClass.grade}}" bindinput="__e"/></view><view class="form-group data-v-0cccd6b3"><label class="form-label data-v-0cccd6b3">é€‰æ‹©è€å¸ˆ</label><view class="search-container data-v-0cccd6b3"><input class="search-input data-v-0cccd6b3" placeholder="æœç´¢è€å¸ˆå§“å" data-event-opts="{{[['input',[['__set_model',['','teacherSearchKeyword','$event',[]]],['onTeacherSearchInput',['$event']]]]]}}" value="{{teacherSearchKeyword}}" bindinput="__e"/></view><view class="teacher-selection data-v-0cccd6b3"><block wx:for="{{$root.l1}}" wx:for-item="teacher" wx:for-index="index" wx:key="_id"><view data-event-opts="{{[['tap',[['toggleTeacherSelection',['$0'],[[['filteredTeachers','_id',teacher.$orig._id]]]]]]]}}" class="{{['teacher-item','data-v-0cccd6b3',(teacher.m1)?'selected':'']}}" bindtap="__e"><view class="teacher-avatar data-v-0cccd6b3"><text class="avatar-text data-v-0cccd6b3">{{teacher.m2}}</text></view><text class="teacher-name data-v-0cccd6b3">{{teacher.$orig.teacherName||teacher.$orig.username}}</text><block wx:if="{{teacher.m3}}"><view class="selection-indicator data-v-0cccd6b3"><text class="check-icon data-v-0cccd6b3">âœ“</text></view></block></view></block><block wx:if="{{$root.g3}}"><view class="no-result data-v-0cccd6b3"><text class="no-result-text data-v-0cccd6b3">æœªæ‰¾åˆ°åŒ¹é…çš„è€å¸ˆ</text></view></block></view></view></view><view class="modal-footer data-v-0cccd6b3"><button data-event-opts="{{[['tap',[['closeAddClassModal',['$event']]]]]}}" class="cancel-btn data-v-0cccd6b3" bindtap="__e">å–æ¶ˆ</button><button data-event-opts="{{[['tap',[['addClass',['$event']]]]]}}" class="confirm-btn data-v-0cccd6b3" bindtap="__e">ç¡®å®š</button></view></view></view></block><block wx:if="{{showClassDetailModal}}"><view class="modal data-v-0cccd6b3"><view class="modal-content class-detail-modal animated-modal data-v-0cccd6b3"><view class="modal-header data-v-0cccd6b3"><text class="modal-title data-v-0cccd6b3">{{currentClass.className+" ç­çº§è¯¦æƒ…"}}</text><text data-event-opts="{{[['tap',[['closeClassDetailModal',['$event']]]]]}}" class="close-btn data-v-0cccd6b3" bindtap="__e">Ã—</text></view><view class="modal-body data-v-0cccd6b3"><view class="detail-section data-v-0cccd6b3"><text class="section-title data-v-0cccd6b3">ç­çº§è€å¸ˆ</text><view class="teacher-list data-v-0cccd6b3"><block wx:for="{{$root.l2}}" wx:for-item="teacher" wx:for-index="index" wx:key="_id"><view class="teacher-item data-v-0cccd6b3"><view class="teacher-avatar data-v-0cccd6b3"><text class="avatar-text data-v-0cccd6b3">{{teacher.m4}}</text></view><view class="teacher-info data-v-0cccd6b3"><text class="teacher-name data-v-0cccd6b3">{{teacher.$orig.teacherName||teacher.$orig.username}}</text></view><text data-event-opts="{{[['tap',[['removeTeacher',['$0'],[[['currentClass.teachers','_id',teacher.$orig._id]]]]]]]}}" class="remove-btn data-v-0cccd6b3" bindtap="__e">ç§»é™¤</text></view></block><block wx:if="{{$root.g4}}"><view data-event-opts="{{[['tap',[['showReplaceTeacherModal',['$event']]]]]}}" class="replace-teacher-btn data-v-0cccd6b3" bindtap="__e"><text class="data-v-0cccd6b3">ğŸ”„ æ›¿æ¢è€å¸ˆ</text></view></block><block wx:else><view data-event-opts="{{[['tap',[['showAddTeacherModal',['$event']]]]]}}" class="add-teacher-btn data-v-0cccd6b3" bindtap="__e"><text class="data-v-0cccd6b3">+ æ·»åŠ è€å¸ˆ</text></view></block></view></view><view class="detail-section data-v-0cccd6b3"><text class="section-title data-v-0cccd6b3">ç­çº§å­¦ç”Ÿ</text><view class="student-list data-v-0cccd6b3"><block wx:for="{{$root.l3}}" wx:for-item="student" wx:for-index="index" wx:key="_id"><view class="student-item data-v-0cccd6b3"><view class="student-avatar data-v-0cccd6b3"><text class="avatar-text data-v-0cccd6b3">{{student.g5}}</text></view><view class="student-info data-v-0cccd6b3"><text class="student-name data-v-0cccd6b3">{{student.$orig.name}}</text><text class="student-id data-v-0cccd6b3">{{student.$orig.studentId}}</text><block wx:if="{{student.$orig.grade}}"><text class="student-grade data-v-0cccd6b3">{{student.$orig.grade}}</text></block></view><text data-event-opts="{{[['tap',[['removeStudent',['$0'],[[['currentClass.students','_id',student.$orig._id]]]]]]]}}" class="remove-btn data-v-0cccd6b3" bindtap="__e">ç§»é™¤</text></view></block><block wx:if="{{$root.g6}}"><view class="no-student-tip data-v-0cccd6b3"><text class="no-student-text data-v-0cccd6b3">æš‚æ— å­¦ç”Ÿ</text></view></block><view data-event-opts="{{[['tap',[['showAddStudentModal',['$event']]]]]}}" class="add-student-btn data-v-0cccd6b3" bindtap="__e"><text class="data-v-0cccd6b3">+ æ·»åŠ å­¦ç”Ÿ</text></view></view></view></view><view class="modal-footer data-v-0cccd6b3"><button data-event-opts="{{[['tap',[['closeClassDetailModal',['$event']]]]]}}" class="cancel-btn data-v-0cccd6b3" bindtap="__e">å…³é—­</button></view></view></view></block><block wx:if="{{showAddTeacherModalFlag}}"><view class="modal data-v-0cccd6b3"><view class="modal-content animated-modal data-v-0cccd6b3"><view class="modal-header data-v-0cccd6b3"><text class="modal-title data-v-0cccd6b3">é€‰æ‹©è€å¸ˆ</text><text data-event-opts="{{[['tap',[['closeAddTeacherModal',['$event']]]]]}}" class="close-btn data-v-0cccd6b3" bindtap="__e">Ã—</text></view><view class="modal-body data-v-0cccd6b3"><view class="search-container data-v-0cccd6b3"><input class="search-input data-v-0cccd6b3" placeholder="ğŸ” æœç´¢è€å¸ˆå§“åæˆ–ç”¨æˆ·å" data-event-opts="{{[['input',[['__set_model',['','teacherSearchKeyword','$event',[]]],['filterTeachers',['$event']]]]]}}" value="{{teacherSearchKeyword}}" bindinput="__e"/><text class="search-icon data-v-0cccd6b3">ğŸ”</text></view><view class="teacher-selection data-v-0cccd6b3"><block wx:for="{{$root.l4}}" wx:for-item="teacher" wx:for-index="index" wx:key="_id"><view data-event-opts="{{[['tap',[['selectTeacherToAdd',['$0'],[[['filteredTeacherList','_id',teacher.$orig._id]]]]]]]}}" class="{{['teacher-item','data-v-0cccd6b3',(teacher.m5)?'selected':'']}}" bindtap="__e"><view class="teacher-avatar data-v-0cccd6b3"><text class="avatar-text data-v-0cccd6b3">{{teacher.m6}}</text></view><view class="teacher-info data-v-0cccd6b3"><text class="teacher-name data-v-0cccd6b3">{{teacher.$orig.teacherName||teacher.$orig.username}}</text><block wx:if="{{teacher.$orig.teacherName&&teacher.$orig.username}}"><text class="teacher-username data-v-0cccd6b3">{{"@"+teacher.$orig.username}}</text></block></view><block wx:if="{{teacher.m7}}"><view class="selection-indicator data-v-0cccd6b3"><text class="check-icon data-v-0cccd6b3">âœ“</text></view></block></view></block><block wx:if="{{$root.g7}}"><view class="no-result data-v-0cccd6b3"><text class="no-result-text data-v-0cccd6b3">æœªæ‰¾åˆ°åŒ¹é…çš„è€å¸ˆ</text></view></block><block wx:if="{{$root.g8}}"><view class="no-result data-v-0cccd6b3"><text class="no-result-text data-v-0cccd6b3">æš‚æ— è€å¸ˆæ•°æ®</text></view></block></view></view><view class="modal-footer data-v-0cccd6b3"><button data-event-opts="{{[['tap',[['closeAddTeacherModal',['$event']]]]]}}" class="cancel-btn data-v-0cccd6b3" bindtap="__e">å–æ¶ˆ</button><button class="confirm-btn data-v-0cccd6b3" disabled="{{!teacherToAdd}}" data-event-opts="{{[['tap',[['addTeacherToClass',['$event']]]]]}}" bindtap="__e">ç¡®å®š</button></view></view></view></block><block wx:if="{{showReplaceTeacherModalFlag}}"><view class="modal data-v-0cccd6b3"><view class="modal-content animated-modal data-v-0cccd6b3"><view class="modal-header data-v-0cccd6b3"><text class="modal-title data-v-0cccd6b3">æ›¿æ¢ç­ä¸»ä»»</text><text data-event-opts="{{[['tap',[['closeReplaceTeacherModal',['$event']]]]]}}" class="close-btn data-v-0cccd6b3" bindtap="__e">Ã—</text></view><view class="modal-body data-v-0cccd6b3"><view class="search-container data-v-0cccd6b3"><input class="search-input data-v-0cccd6b3" placeholder="ğŸ” æœç´¢è€å¸ˆå§“åæˆ–ç”¨æˆ·å" data-event-opts="{{[['input',[['__set_model',['','teacherSearchKeyword','$event',[]]],['filterTeachers',['$event']]]]]}}" value="{{teacherSearchKeyword}}" bindinput="__e"/><text class="search-icon data-v-0cccd6b3">ğŸ”</text></view><view class="teacher-selection data-v-0cccd6b3"><block wx:for="{{$root.l5}}" wx:for-item="teacher" wx:for-index="index" wx:key="_id"><view data-event-opts="{{[['tap',[['selectTeacherToReplace',['$0'],[[['filteredTeacherList','_id',teacher.$orig._id]]]]]]]}}" class="{{['teacher-item','data-v-0cccd6b3',(teacher.m8)?'selected':'']}}" bindtap="__e"><view class="teacher-avatar data-v-0cccd6b3"><text class="avatar-text data-v-0cccd6b3">{{teacher.m9}}</text></view><view class="teacher-info data-v-0cccd6b3"><text class="teacher-name data-v-0cccd6b3">{{teacher.$orig.teacherName||teacher.$orig.username}}</text><block wx:if="{{teacher.$orig.teacherName&&teacher.$orig.username}}"><text class="teacher-username data-v-0cccd6b3">{{"@"+teacher.$orig.username}}</text></block></view><block wx:if="{{teacher.m10}}"><view class="selection-indicator data-v-0cccd6b3"><text class="check-icon data-v-0cccd6b3">âœ“</text></view></block></view></block><block wx:if="{{$root.g9}}"><view class="no-result data-v-0cccd6b3"><text class="no-result-text data-v-0cccd6b3">æœªæ‰¾åˆ°åŒ¹é…çš„è€å¸ˆ</text></view></block><block wx:if="{{$root.g10}}"><view class="no-result data-v-0cccd6b3"><text class="no-result-text data-v-0cccd6b3">æš‚æ— è€å¸ˆæ•°æ®</text></view></block></view></view><view class="modal-footer data-v-0cccd6b3"><button data-event-opts="{{[['tap',[['closeReplaceTeacherModal',['$event']]]]]}}" class="cancel-btn data-v-0cccd6b3" bindtap="__e">å–æ¶ˆ</button><button class="confirm-btn data-v-0cccd6b3" disabled="{{!teacherToReplace}}" data-event-opts="{{[['tap',[['replaceTeacher',['$event']]]]]}}" bindtap="__e">ç¡®å®š</button></view></view></view></block><block wx:if="{{showAddStudentModalFlag}}"><view class="modal data-v-0cccd6b3"><view class="modal-content animated-modal data-v-0cccd6b3"><view class="modal-header data-v-0cccd6b3"><text class="modal-title data-v-0cccd6b3">é€‰æ‹©å­¦ç”Ÿ</text><text data-event-opts="{{[['tap',[['closeAddStudentModal',['$event']]]]]}}" class="close-btn data-v-0cccd6b3" bindtap="__e">Ã—</text></view><view class="modal-body data-v-0cccd6b3"><view class="search-container data-v-0cccd6b3"><input class="search-input data-v-0cccd6b3" placeholder="ğŸ” æœç´¢å­¦ç”Ÿå§“åæˆ–å­¦å·" data-event-opts="{{[['input',[['__set_model',['','studentSearchKeyword','$event',[]]],['filterStudents',['$event']]]]]}}" value="{{studentSearchKeyword}}" bindinput="__e"/><text class="search-icon data-v-0cccd6b3">ğŸ”</text></view><view class="student-selection-list data-v-0cccd6b3"><block wx:for="{{$root.l6}}" wx:for-item="student" wx:for-index="__i0__" wx:key="_id"><view data-event-opts="{{[['tap',[['selectStudent',['$0'],[[['filteredStudentList','_id',student.$orig._id]]]]]]]}}" class="{{['student-selection-item','data-v-0cccd6b3',(student.m11)?'selected':'']}}" bindtap="__e"><view class="student-avatar data-v-0cccd6b3"><text class="avatar-text data-v-0cccd6b3">{{student.g11}}</text></view><view class="student-info data-v-0cccd6b3"><text class="student-name data-v-0cccd6b3">{{student.$orig.name}}</text><text class="student-details data-v-0cccd6b3">{{student.$orig.studentId+" Â· "+student.$orig.grade}}</text></view><block wx:if="{{student.m12}}"><text class="check-icon data-v-0cccd6b3">âœ“</text></block></view></block><block wx:if="{{$root.g12}}"><view class="no-result data-v-0cccd6b3"><text class="no-result-text data-v-0cccd6b3">æœªæ‰¾åˆ°åŒ¹é…çš„å­¦ç”Ÿ</text></view></block><block wx:if="{{$root.g13}}"><view class="no-result data-v-0cccd6b3"><text class="no-result-text data-v-0cccd6b3">æš‚æ— å­¦ç”Ÿæ•°æ®ï¼Œè¯·å…ˆé€šè¿‡å­¦ç”Ÿå½•å…¥åŠŸèƒ½æ·»åŠ å­¦ç”Ÿ</text></view></block></view></view><view class="modal-footer data-v-0cccd6b3"><button data-event-opts="{{[['tap',[['closeAddStudentModal',['$event']]]]]}}" class="cancel-btn data-v-0cccd6b3" bindtap="__e">å–æ¶ˆ</button><button class="confirm-btn data-v-0cccd6b3" disabled="{{$root.g14===0}}" data-event-opts="{{[['tap',[['addSelectedStudentsToClass',['$event']]]]]}}" bindtap="__e">{{'ç¡®å®š ('+$root.g15+')'}}</button></view></view></view></block><view data-event-opts="{{[['tap',[['showAddClassModal',['$event']]]]]}}" class="floating-add-btn data-v-0cccd6b3" bindtap="__e"><image class="add-icon data-v-0cccd6b3" src="/static/745 (1).png" mode="aspectFit"></image></view><block wx:if="{{showToast}}"><view class="toast data-v-0cccd6b3"><text class="toast-text data-v-0cccd6b3">{{toastMessage}}</text></view></block></view>