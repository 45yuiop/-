<view><view class="back-btn-container"><button data-event-opts="{{[['tap',[['goBack',['$event']]]]]}}" class="back-btn" bindtap="__e"><text class="back-btn-icon">‹</text></button></view><view class="main-content"><view class="page-title">课时统计管理</view><view class="form-section"><view class="form-item"><input class="search-input" placeholder="🔍 搜索教师姓名" data-event-opts="{{[['input',[['__set_model',['','searchKeyword','$event',['trim']]]]],['blur',[['$forceUpdate']]]]}}" value="{{searchKeyword}}" bindinput="__e" bindblur="__e"/><picker value="{{teacherIndex}}" range="{{filteredTeacherList}}" range-key="teacherName" data-event-opts="{{[['change',[['onTeacherChange',['$event']]]]]}}" bindchange="__e"><view class="picker-display"><text>{{selectedTeacher?selectedTeacher.teacherName:'请选择教师'}}</text><text class="picker-arrow">▼</text></view></picker></view><view class="form-item"><picker mode="date" fields="month" value="{{selectedMonth}}" data-event-opts="{{[['change',[['onMonthChange',['$event']]]]]}}" bindchange="__e"><view class="picker-display"><text>{{"统计月份："+selectedMonth}}</text><text class="picker-arrow">▼</text></view></picker></view></view><view class="action-buttons"><button class="query-btn" loading="{{isLoading}}" data-event-opts="{{[['tap',[['fetchAndCalculateStatistics',['$event']]]]]}}" bindtap="__e">查询统计</button><block wx:if="{{isAdmin||isSuperAdmin}}"><button class="query-btn all-btn" loading="{{isLoadingAll}}" data-event-opts="{{[['tap',[['fetchAllTeachersStatistics',['$event']]]]]}}" bindtap="__e"><text class="btn-icon">👥</text>查询全员课时</button></block></view><block wx:if="{{statistics}}"><view class="results-section"><view class="results-title">统计结果</view><view class="results-grid"><view class="result-item"><view class="result-value one-to-one-value">{{statistics['一对一']||0}}</view><view class="result-label one-to-one-label">一对一 (小时)</view></view><view class="result-item"><view class="result-value group-class-value">{{statistics['班课']||0}}</view><view class="result-label group-class-label">班课 (小时)</view></view><view class="result-item"><view class="result-value full-time-value">{{statistics['脱产生']||0}}</view><view class="result-label full-time-label">脱产生 (小时)</view></view></view></view></block><block wx:if="{{noData&&!isLoading}}"><view class="empty-state"><text>当月无排课记录</text></view></block><block wx:if="{{$root.g0}}"><view class="results-section card-bg"><view class="results-title">全员课时统计</view><view class="all-table"><view class="all-table-header"><text class="all-th">教师姓名</text><text class="all-th">一对一(小时)</text><text class="all-th">班课(小时)</text><text class="all-th">脱产生(小时)</text></view><block wx:for="{{allStatistics}}" wx:for-item="row" wx:for-index="index" wx:key="index"><view class="all-table-row"><text class="all-td teacher-name">{{row.teacherName}}</text><text class="all-td one-to-one-hours">{{row['一对一']}}</text><text class="all-td group-class-hours">{{row['班课']}}</text><text class="all-td full-time-hours">{{row['脱产生']}}</text></view></block></view></view></block></view></view>