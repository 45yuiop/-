(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/search-page/search-page"],{"53ed":function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r={data:function(){return{searchText:"",featureList:[{text:"注册账号",page:"/pages/register/register",icon:"/static/aaa.png"},{text:"账号管理",page:"/pages/account-manage/account-manage",icon:"/static/c.png"},{text:"教师排课",page:"/pages/teacher-schedule/teacher-schedule",icon:"/static/bb.png"},{text:"课时统计",page:"/pages/salary-statistics/salary-statistics",icon:"/static/b.png"},{text:"教师课程表",page:"/pages/admin-teacher-schedule/admin-teacher-schedule",icon:"/static/bbb.png"},{text:"我的课表",page:"/pages/teacher-courses/teacher-courses",icon:"/static/d.png"},{text:"学生课时",page:"/pages/student-hours-query/student-hours-query",icon:"/static/gg.png"},{text:"学生课时录入",page:"/pages/student-hours/student-hours",icon:"/static/gg.png"},{text:"班级管理",page:"/pages/class-management/class-management",icon:"/static/222.png"},{text:"学生录入",page:"/pages/student-input/student-input",icon:"/static/1234.png"},{text:"学生档案",page:"/pages/archive/archive",icon:"/static/教室.png"},{text:"权限分配",page:"/pages/permission-assign/index",icon:"/static/dd.png"},{text:"系统设置",page:"/pages/system-setting/system-setting",icon:"/static/cc.png"},{text:"成绩",page:"/pages/exam-scores/exam-scores",icon:"/static/1.png"},{text:"进步分析",page:"/pages/student-progress/student-progress",icon:"/static/ii.png"},{text:"教室",page:"/pages/classroom/classroom",icon:"/static/2.png"},{text:"试卷分析",page:"/pages/exam-analysis/exam-analysis",icon:"/static/22.png"}],historyList:[],userId:""}},computed:{filteredList:function(){var e=this.searchText.replace(/\s/g,"").toLowerCase();if(!e)return[];var r=t.getStorageSync("userInfo"),s=r&&(Array.isArray(r.role)?r.role.includes("教务"):"教务"===r.role);return this.featureList.filter((function(t){if(s&&("我的课表"===t.text||"我的班级"===t.text||"进步分析"===t.text))return!1;var r=(t.text||"").replace(/\s/g,"").toLowerCase();return e.split("").every((function(t){return r.includes(t)}))||r.includes(e)}))}},mounted:function(){var e=t.getStorageSync("userInfo");this.userId=e?e.uid||e.username:"anonymous";var r=t.getStorageSync("searchHistory_"+this.userId)||[];if(this.historyList=r,e){var s="superadmin"===e.permission,i="管理员"===e.permission||s||Array.isArray(e.role)&&e.role.includes("管理员"),a=Array.isArray(e.role)?e.role.includes("教师"):"教师"===e.role,n=Array.isArray(e.role)?e.role.includes("家长"):"家长"===e.role,c=Array.isArray(e.role)?e.role.includes("教务"):"教务"===e.role,u=c&&"管理员"===e.permission,o={"注册账号":"register","账号管理":"user_manage","教师排课":"schedule","课时统计":"salary","教师课程表":"admin_teacher_schedule","我的课表":"teacher_courses","权限分配":"permission_assign","系统设置":"system_setting","班级管理":"class_management","学生录入":"student_input","学生档案":"archive","试卷分析":"exam_analysis"};this.featureList=this.featureList.filter((function(t){if(s&&"我的课表"===t.text)return!1;if(u&&"课时统计"===t.text)return!1;if(i)return"师资力量"!==t.text;if(n)return"教师课程表"===t.text||"系统设置"===t.text;if(a){if("我的课表"===t.text||"学生课时"===t.text||"我的班级"===t.text||"成绩"===t.text||"进步分析"===t.text||"试卷分析"===t.text)return!0;if(e.featureList&&Array.isArray(e.featureList)){var r=o[t.text]||t.text;return e.featureList.includes(r)||"系统设置"===t.text}return"系统设置"===t.text}if(c){if("教师课程表"===t.text)return!0;if("学生档案"===t.text)return!0;if("调课审批"===t.text)return!1;if("我的课表"===t.text)return!1;if("学生课时"===t.text)return!0;if("成绩"===t.text)return!0;if("进步分析"===t.text)return!1;if("试卷分析"===t.text)return!1;if(e.featureList&&Array.isArray(e.featureList)){var g=o[t.text]||t.text;return e.featureList.includes(g)||"系统设置"===t.text}return"系统设置"===t.text}return"系统设置"===t.text}))}},methods:{highlightMatch:function(t){if(!this.searchText)return t;var e=this.searchText.replace(/\s/g,""),r=t;return e.split("").forEach((function(t){if(t){var e=new RegExp("(".concat(t,")"),"g");r=r.replace(e,'<span style="color:#FFB300">$1</span>')}})),r},goToFeature:function(e){var r=t.getStorageSync("userInfo"),s=r&&(Array.isArray(r.role)?r.role.includes("教务"):"教务"===r.role);if(!s||"我的课表"!==e.text&&"我的班级"!==e.text&&"进步分析"!==e.text){var i=this.searchText.trim();if(i){var a=this.historyList.filter((function(t){return t!==i}));a.unshift(i),a.length>8&&(a=a.slice(0,8)),this.historyList=a,t.setStorageSync("searchHistory_"+this.userId,a)}t.navigateTo({url:e.page})}else t.showToast({title:"无权限访问",icon:"none"})},goBack:function(){var e=this.searchText.trim();if(e){var r=this.historyList.filter((function(t){return t!==e}));r.unshift(e),r.length>8&&(r=r.slice(0,8)),this.historyList=r,t.setStorageSync("searchHistory_"+this.userId,r)}t.navigateBack()},onSearchConfirm:function(e){var r=e.detail&&e.detail.value?e.detail.value.trim():this.searchText.trim();if(r){var s=this.historyList.filter((function(t){return t!==r}));s.unshift(r),s.length>8&&(s=s.slice(0,8)),this.historyList=s,t.setStorageSync("searchHistory_"+this.userId,s)}},onHistoryClick:function(t){this.searchText=t},clearHistory:function(){this.historyList=[],t.removeStorageSync("searchHistory_"+this.userId)}}};e.default=r}).call(this,r("df3c")["default"])},"6edc":function(t,e,r){"use strict";r.d(e,"b",(function(){return s})),r.d(e,"c",(function(){return i})),r.d(e,"a",(function(){}));var s=function(){var t=this,e=t.$createElement,r=(t._self._c,t.historyList.length),s=t.searchText&&t.filteredList.length>0,i=s?t.__map(t.filteredList,(function(e,r){var s=t.__get_orig(e),i=t.highlightMatch(e.text);return{$orig:s,m0:i}})):null,a=s?null:t.searchText&&0===t.filteredList.length;t.$mp.data=Object.assign({},{$root:{g0:r,g1:s,l0:i,g2:a}})},i=[]},"89aa":function(t,e,r){"use strict";var s=r("9a68"),i=r.n(s);i.a},"90f3":function(t,e,r){"use strict";r.r(e);var s=r("6edc"),i=r("9283");for(var a in i)["default"].indexOf(a)<0&&function(t){r.d(e,t,(function(){return i[t]}))}(a);r("89aa");var n=r("828b"),c=Object(n["a"])(i["default"],s["b"],s["c"],!1,null,"522ee195",null,!1,s["a"],void 0);e["default"]=c.exports},9283:function(t,e,r){"use strict";r.r(e);var s=r("53ed"),i=r.n(s);for(var a in s)["default"].indexOf(a)<0&&function(t){r.d(e,t,(function(){return s[t]}))}(a);e["default"]=i.a},"9a68":function(t,e,r){},c79e:function(t,e,r){"use strict";(function(t,e){var s=r("47a9");r("a226"),r("861b");s(r("3240"));var i=s(r("90f3"));t.__webpack_require_UNI_MP_PLUGIN__=r,e(i.default)}).call(this,r("3223")["default"],r("df3c")["createPage"])}},[["c79e","common/runtime","common/vendor"]]]);