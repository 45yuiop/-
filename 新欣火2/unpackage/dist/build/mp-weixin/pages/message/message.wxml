<view class="message-page data-v-260a27f9"><view class="status-bar data-v-260a27f9"></view><view class="top-bar data-v-260a27f9"><view class="top-nav data-v-260a27f9"><view class="page-title data-v-260a27f9">消息中心</view></view></view><view class="message-tabs data-v-260a27f9"><view data-event-opts="{{[['tap',[['switchTab',['all']]]]]}}" class="{{['tab-item','data-v-260a27f9',(activeTab==='all')?'active':'']}}" bindtap="__e">全部</view><view data-event-opts="{{[['tap',[['switchTab',['notification']]]]]}}" class="{{['tab-item','data-v-260a27f9',(activeTab==='notification')?'active':'']}}" bindtap="__e">通知</view><view data-event-opts="{{[['tap',[['switchTab',['system']]]]]}}" class="{{['tab-item','data-v-260a27f9',(activeTab==='system')?'active':'']}}" bindtap="__e">系统消息</view></view><view class="content data-v-260a27f9"><block wx:if="{{loading}}"><view class="loading-state data-v-260a27f9"><view class="loading-icon data-v-260a27f9">🔄</view><view class="loading-text data-v-260a27f9">加载中...</view></view></block><block wx:else><block wx:if="{{$root.g0===0}}"><view class="empty-state data-v-260a27f9"><view class="empty-icon data-v-260a27f9">📭</view><view class="empty-text data-v-260a27f9">暂无消息</view><view class="empty-desc data-v-260a27f9">您还没有收到任何消息</view></view></block><block wx:else><view class="message-list data-v-260a27f9"><block wx:for="{{$root.l0}}" wx:for-item="message" wx:for-index="__i0__" wx:key="_id"><view data-event-opts="{{[['tap',[['readMessage',['$0'],[[['filteredMessages','_id',message.$orig._id]]]]]]]}}" class="{{['message-item','data-v-260a27f9',(!message.$orig.read)?'unread':'']}}" bindtap="__e"><view class="message-icon data-v-260a27f9"><block wx:if="{{message.$orig.type==='notification'}}"><text class="data-v-260a27f9">🔔</text></block><block wx:else><block wx:if="{{message.$orig.type==='system'}}"><text class="data-v-260a27f9">⚙️</text></block><block wx:else><block wx:if="{{message.$orig.type==='schedule'}}"><text class="data-v-260a27f9">📅</text></block><block wx:else><block wx:if="{{message.$orig.type==='courseChange'}}"><text class="data-v-260a27f9">🔄</text></block><block wx:else><text class="data-v-260a27f9">✉️</text></block></block></block></block></view><view class="message-content data-v-260a27f9"><view class="message-title data-v-260a27f9">{{message.$orig.title}}</view><view class="message-preview data-v-260a27f9">{{message.m0}}</view><view class="message-meta data-v-260a27f9"><text class="message-time data-v-260a27f9">{{message.m1}}</text><block wx:if="{{!message.$orig.read}}"><text class="unread-dot data-v-260a27f9">●</text></block></view></view></view></block></view></block></block></view><block wx:if="{{$root.g1}}"><view class="bottom-actions data-v-260a27f9"><button data-event-opts="{{[['tap',[['markAllRead',['$event']]]]]}}" class="action-btn mark-all-read data-v-260a27f9" bindtap="__e">全部已读</button><button data-event-opts="{{[['tap',[['clearAllMessages',['$event']]]]]}}" class="action-btn clear-all data-v-260a27f9" bindtap="__e">清空消息</button></view></block><block wx:if="{{showSubscriptionPrompt}}"><view class="subscription-prompt data-v-260a27f9"><view class="prompt-content data-v-260a27f9"><view class="prompt-icon data-v-260a27f9">🔔</view><view class="prompt-text data-v-260a27f9"><view class="prompt-title data-v-260a27f9">开启订阅通知</view><view class="prompt-desc data-v-260a27f9">及时接收课程安排和系统通知</view></view><button data-event-opts="{{[['tap',[['goToSubscription',['$event']]]]]}}" class="prompt-btn data-v-260a27f9" bindtap="__e">去设置</button></view></view></block></view>