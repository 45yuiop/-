(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/register/register"],{1096:function(e,n,t){"use strict";(function(e,r){var s=t("47a9");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=s(t("7eb4")),a=s(t("ee10")),i={data:function(){return{newUsername:"",newPassword:"",newTeacherName:"",roleOptions:["教师","家长","教务"],newRoleIndex:0,subjectOptions:["语文","数学","英语","物理","化学"],newSubjectIndex:0,departmentOptions:["小学部","初中部"],newDepartmentIndex:-1,workTypeOptions:["全职","兼职"],newWorkTypeIndex:0,permissionOptions:["普通用户","管理员"],newPermissionIndex:0,showSupervisorPicker:!1,supervisorList:[],selectedSupervisor:null}},computed:{showSubjectSelect:function(){var e=this.roleOptions[this.newRoleIndex];return"教师"===e},showPermissionSelect:function(){var e=this.roleOptions[this.newRoleIndex];return"教师"===e||"教务"===e},showSupervisorSelect:function(){var e=this.roleOptions[this.newRoleIndex];return"教师"===e||"教务"===e}},methods:{goBackToHome:function(){e.navigateBack()},getSupervisorList:function(){var e=this;return(0,a.default)(o.default.mark((function n(){var t,s;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t=e.roleOptions[e.newRoleIndex],"教师"===t||"教务"===t){n.next=3;break}return n.abrupt("return");case 3:return n.prev=3,n.next=6,r.callFunction({name:"user-center",data:{action:"getSupervisors",params:{role:t}}});case 6:s=n.sent,200===s.result.code?e.supervisorList=s.result.data:console.error("获取上级领导列表失败:",s.result.message),n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](3),console.error("获取上级领导列表失败:",n.t0);case 13:case"end":return n.stop()}}),n,null,[[3,10]])})))()},selectSupervisor:function(e){this.selectedSupervisor=e,this.showSupervisorPicker=!1},registerAccount:function(){var n=this;return(0,a.default)(o.default.mark((function t(){var s,a,i,u,c,d,l;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n.newUsername&&n.newPassword){t.next=3;break}return e.showToast({title:"请输入账号和密码",icon:"none"}),t.abrupt("return");case 3:s=n.roleOptions[n.newRoleIndex],a=n.newTeacherName,i="",u="",c="",d="",l="","教师"!==s&&"教务"!==s||(i=n.permissionOptions[n.newPermissionIndex]),"教师"===s&&(u=n.subjectOptions[n.newSubjectIndex],d=n.workTypeOptions[n.newWorkTypeIndex],n.newDepartmentIndex>=0&&(c=n.departmentOptions[n.newDepartmentIndex])),n.selectedSupervisor&&(l=n.selectedSupervisor._id),e.showLoading({title:"注册中..."}),r.callFunction({name:"user-center",data:{action:"register",params:{username:n.newUsername,password:n.newPassword,teacherName:a,role:s,permission:i,subject:u,department:c,workType:d,supervisor:l}},success:function(t){e.hideLoading(),200===t.result.code?(e.showToast({title:"注册成功",icon:"success"}),n.newUsername="",n.newPassword="",n.newTeacherName="",n.newRoleIndex=0,n.newSubjectIndex=0,n.newDepartmentIndex=-1,n.newWorkTypeIndex=0,n.newPermissionIndex=0,n.selectedSupervisor=null):e.showToast({title:t.result.message||"注册失败",icon:"none"})},fail:function(n){e.hideLoading(),e.showToast({title:"注册请求失败，请稍后再试",icon:"none"}),console.error("注册失败",n)}});case 15:case"end":return t.stop()}}),t)})))()}},watch:{newRoleIndex:function(){this.selectedSupervisor=null,this.getSupervisorList()}},mounted:function(){this.getSupervisorList()}};n.default=i}).call(this,t("df3c")["default"],t("861b")["uniCloud"])},2090:function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return s})),t.d(n,"a",(function(){}));var r=function(){var e=this,n=e.$createElement,t=(e._self._c,e.showSupervisorPicker?e.supervisorList.length:null);e._isMounted||(e.e0=function(n,t){var r=arguments[arguments.length-1].currentTarget.dataset,s=r.eventParams||r["event-params"];t=s.idx;e.newRoleIndex=t},e.e1=function(n,t){var r=arguments[arguments.length-1].currentTarget.dataset,s=r.eventParams||r["event-params"];t=s.idx;e.newSubjectIndex=t},e.e2=function(n,t){var r=arguments[arguments.length-1].currentTarget.dataset,s=r.eventParams||r["event-params"];t=s.idx;e.newDepartmentIndex=t},e.e3=function(n,t){var r=arguments[arguments.length-1].currentTarget.dataset,s=r.eventParams||r["event-params"];t=s.idx;e.newWorkTypeIndex=t},e.e4=function(n){e.showSupervisorPicker=!0},e.e5=function(n,t){var r=arguments[arguments.length-1].currentTarget.dataset,s=r.eventParams||r["event-params"];t=s.idx;e.newPermissionIndex=t},e.e6=function(n){e.showSupervisorPicker=!1},e.e7=function(n){e.showSupervisorPicker=!1}),e.$mp.data=Object.assign({},{$root:{g0:t}})},s=[]},b3be:function(e,n,t){"use strict";t.r(n);var r=t("2090"),s=t("d449");for(var o in s)["default"].indexOf(o)<0&&function(e){t.d(n,e,(function(){return s[e]}))}(o);t("faa2");var a=t("828b"),i=Object(a["a"])(s["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],void 0);n["default"]=i.exports},d449:function(e,n,t){"use strict";t.r(n);var r=t("1096"),s=t.n(r);for(var o in r)["default"].indexOf(o)<0&&function(e){t.d(n,e,(function(){return r[e]}))}(o);n["default"]=s.a},d899:function(e,n,t){},f3cb:function(e,n,t){"use strict";(function(e,n){var r=t("47a9");t("a226"),t("861b");r(t("3240"));var s=r(t("b3be"));e.__webpack_require_UNI_MP_PLUGIN__=t,n(s.default)}).call(this,t("3223")["default"],t("df3c")["createPage"])},faa2:function(e,n,t){"use strict";var r=t("d899"),s=t.n(r);s.a}},[["f3cb","common/runtime","common/vendor"]]]);