<view class="container data-v-5f62c136"><view class="custom-navbar data-v-5f62c136"><view class="navbar-content data-v-5f62c136"><view data-event-opts="{{[['tap',[['goBack',['$event']]]]]}}" class="navbar-left data-v-5f62c136" bindtap="__e"><text class="back-icon data-v-5f62c136">‹</text><text class="back-text data-v-5f62c136">返回</text></view><text class="navbar-title data-v-5f62c136">学生详情</text><view class="navbar-right data-v-5f62c136"></view></view></view><block wx:if="{{studentData}}"><view class="form-container data-v-5f62c136"><view class="form-item data-v-5f62c136"><text class="label data-v-5f62c136">学生姓名 *</text><input class="input data-v-5f62c136" placeholder="请输入学生姓名" maxlength="20" data-event-opts="{{[['input',[['__set_model',['$0','name','$event',[]],['studentData']]]]]}}" value="{{studentData.name}}" bindinput="__e"/></view><view class="form-item data-v-5f62c136"><text class="label data-v-5f62c136">年级 *</text><picker mode="selector" value="{{gradeIndex}}" range="{{gradeOptions}}" data-event-opts="{{[['change',[['onGradeChange',['$event']]]]]}}" bindchange="__e" class="data-v-5f62c136"><view class="picker data-v-5f62c136">{{''+(studentData.grade||'请选择年级')+''}}<text class="arrow data-v-5f62c136">></text></view></picker></view><view class="form-item data-v-5f62c136"><text class="label data-v-5f62c136">所学科目 *</text><view data-event-opts="{{[['tap',[['showSubjectModal',['$event']]]]]}}" class="subject-selector data-v-5f62c136" bindtap="__e"><view class="subject-display data-v-5f62c136"><block wx:if="{{$root.g0===0}}"><text class="placeholder data-v-5f62c136">请选择科目</text></block><block wx:else><view class="selected-subjects data-v-5f62c136"><block wx:for="{{studentData.subjects}}" wx:for-item="subject" wx:for-index="index" wx:key="index"><view class="subject-tag data-v-5f62c136"><text class="subject-text data-v-5f62c136">{{subject}}</text><text data-event-opts="{{[['tap',[['removeSubject',[index]]]]]}}" class="remove-btn data-v-5f62c136" catchtap="__e">×</text></view></block></view></block></view><text class="arrow data-v-5f62c136">></text></view></view><view class="form-item data-v-5f62c136"><text class="label data-v-5f62c136">学校</text><input class="input data-v-5f62c136" placeholder="请输入学校名称（可选）" maxlength="50" data-event-opts="{{[['input',[['__set_model',['$0','school','$event',[]],['studentData']]]]]}}" value="{{studentData.school}}" bindinput="__e"/></view><view class="form-item data-v-5f62c136"><text class="label data-v-5f62c136">加入班级</text><view data-event-opts="{{[['tap',[['showClassModal',['$event']]]]]}}" class="class-selector data-v-5f62c136" bindtap="__e"><view class="class-display data-v-5f62c136"><block wx:if="{{$root.g1===0}}"><text class="placeholder data-v-5f62c136">请选择班级（可选）</text></block><block wx:else><view class="selected-classes data-v-5f62c136"><block wx:for="{{studentData.classes}}" wx:for-item="classItem" wx:for-index="index" wx:key="index"><view class="class-tag data-v-5f62c136"><text class="class-text data-v-5f62c136">{{classItem.className}}</text><text data-event-opts="{{[['tap',[['removeClass',[index]]]]]}}" class="remove-btn data-v-5f62c136" catchtap="__e">×</text></view></block></view></block></view><text class="arrow data-v-5f62c136">></text></view></view></view></block><view class="save-button-container data-v-5f62c136"><button data-event-opts="{{[['tap',[['saveStudentInfo',['$event']]]]]}}" class="save-button data-v-5f62c136" bindtap="__e">保存修改</button></view><block wx:if="{{studentData}}"><view class="academic-section data-v-5f62c136"><view class="tabs data-v-5f62c136"><view data-event-opts="{{[['tap',[['switchTab',['courses']]]]]}}" class="{{['tab','data-v-5f62c136',(activeTab==='courses')?'active':'']}}" bindtap="__e">学习课程</view><view data-event-opts="{{[['tap',[['switchTab',['scores']]]]]}}" class="{{['tab','data-v-5f62c136',(activeTab==='scores')?'active':'']}}" bindtap="__e">考试成绩</view></view><block wx:if="{{activeTab==='courses'}}"><view class="content data-v-5f62c136"><block wx:if="{{$root.g2===0}}"><view class="empty-state data-v-5f62c136"><text class="empty-text data-v-5f62c136">暂无课程记录</text></view></block><block wx:else><view class="course-list data-v-5f62c136"><block wx:for="{{$root.l0}}" wx:for-item="course" wx:for-index="index" wx:key="index"><view class="course-item data-v-5f62c136"><view class="course-header data-v-5f62c136"><text class="course-name data-v-5f62c136">{{course.$orig.courseName}}</text><text class="course-year data-v-5f62c136">{{course.$orig.year+" "+course.$orig.semester}}</text></view><view class="course-details data-v-5f62c136"><text class="status data-v-5f62c136">{{"状态："+course.$orig.status}}</text><text class="enroll-date data-v-5f62c136">{{"入学时间："+course.m0}}</text><block wx:if="{{course.$orig.completion_date}}"><text class="completion-date data-v-5f62c136">{{"结业时间："+course.m1}}</text></block><block wx:if="{{course.$orig.className}}"><text class="class-info data-v-5f62c136">{{"班级："+course.$orig.className}}</text></block></view></view></block></view></block></view></block><block wx:if="{{activeTab==='scores'}}"><view class="content data-v-5f62c136"><block wx:if="{{$root.g3===0}}"><view class="empty-state data-v-5f62c136"><text class="empty-text data-v-5f62c136">暂无成绩记录</text></view></block><block wx:else><view class="score-list data-v-5f62c136"><block wx:for="{{$root.l1}}" wx:for-item="score" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['editScore',['$0',index],[[['scores','',index]]]]]]]}}" class="score-item data-v-5f62c136" bindtap="__e"><view class="score-header data-v-5f62c136"><text class="course-name data-v-5f62c136">{{score.$orig.courseName}}</text><text class="exam-name data-v-5f62c136">{{score.$orig.exam_name}}</text></view><view class="score-details data-v-5f62c136"><text class="score-value data-v-5f62c136">{{"成绩："+score.$orig.score+"分"}}</text><text class="exam-date data-v-5f62c136">{{"考试时间："+score.m2}}</text><block wx:if="{{score.$orig.remark}}"><text class="remark data-v-5f62c136">{{"备注："+score.$orig.remark}}</text></block><text class="subject-info data-v-5f62c136">{{"科目："+score.m3}}</text></view></view></block></view></block></view></block></view></block><view class="delete-button-container data-v-5f62c136"><image class="delete-button-image data-v-5f62c136" src="/static/删除 .png" mode="aspectFit" data-event-opts="{{[['tap',[['deleteStudent',['$event']]]]]}}" bindtap="__e"></image></view><block wx:if="{{showSubjectModalFlag}}"><view data-event-opts="{{[['tap',[['closeSubjectModal',['$event']]]]]}}" class="subject-modal data-v-5f62c136" bindtap="__e"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="subject-modal-content data-v-5f62c136" catchtap="__e"><view class="modal-header data-v-5f62c136"><text class="modal-title data-v-5f62c136">选择科目</text><view data-event-opts="{{[['tap',[['closeSubjectModal',['$event']]]]]}}" class="close-btn data-v-5f62c136" bindtap="__e"><text class="close-icon data-v-5f62c136">×</text></view></view><view class="modal-body data-v-5f62c136"><view class="subject-grid data-v-5f62c136"><block wx:for="{{$root.l2}}" wx:for-item="subject" wx:for-index="__i0__" wx:key="$orig"><view data-event-opts="{{[['tap',[['toggleSubject',['$0'],[[['allSubjects','',__i0__]]]]]]]}}" class="{{['subject-item','data-v-5f62c136',(subject.g4)?'selected':'']}}" bindtap="__e"><text class="subject-name data-v-5f62c136">{{subject.$orig}}</text><block wx:if="{{subject.g5}}"><text class="check-icon data-v-5f62c136">✓</text></block></view></block></view></view><view class="modal-footer data-v-5f62c136"><button data-event-opts="{{[['tap',[['closeSubjectModal',['$event']]]]]}}" class="cancel-btn data-v-5f62c136" bindtap="__e">取消</button><button data-event-opts="{{[['tap',[['confirmSubjects',['$event']]]]]}}" class="confirm-btn data-v-5f62c136" bindtap="__e">确定</button></view></view></view></block><block wx:if="{{showClassModalFlag}}"><view data-event-opts="{{[['tap',[['closeClassModal',['$event']]]]]}}" class="class-modal data-v-5f62c136" bindtap="__e"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="class-modal-content data-v-5f62c136" catchtap="__e"><view class="modal-header data-v-5f62c136"><text class="modal-title data-v-5f62c136">选择班级</text><view data-event-opts="{{[['tap',[['closeClassModal',['$event']]]]]}}" class="close-btn data-v-5f62c136" bindtap="__e"><text class="close-icon data-v-5f62c136">×</text></view></view><view class="modal-body data-v-5f62c136"><view class="search-container data-v-5f62c136"><input class="search-input data-v-5f62c136" placeholder="搜索班级名称或年级" data-event-opts="{{[['input',[['__set_model',['','classSearchKeyword','$event',[]]],['onClassSearchInput',['$event']]]]]}}" value="{{classSearchKeyword}}" bindinput="__e"/></view><block wx:if="{{!classSearchKeyword}}"><view class="search-tip data-v-5f62c136"><text class="tip-text data-v-5f62c136">输入关键字搜索班级，或滑动查看所有班级</text></view></block><view class="class-grid data-v-5f62c136"><block wx:for="{{$root.l3}}" wx:for-item="classItem" wx:for-index="__i1__" wx:key="_id"><view data-event-opts="{{[['tap',[['toggleClass',['$0'],[[['filteredClasses','_id',classItem.$orig._id]]]]]]]}}" class="{{['class-item','data-v-5f62c136',(classItem.m4)?'selected':'']}}" bindtap="__e"><view class="class-info data-v-5f62c136"><text class="class-name data-v-5f62c136">{{classItem.$orig.className}}</text><text class="class-grade data-v-5f62c136">{{classItem.$orig.grade}}</text><text class="class-teacher data-v-5f62c136">{{"班主任："+classItem.$orig.teacherName}}</text></view><block wx:if="{{classItem.m5}}"><text class="check-icon data-v-5f62c136">✓</text></block></view></block><block wx:if="{{$root.g6}}"><view data-event-opts="{{[['tap',[['createNewClass',['$event']]]]]}}" class="create-class-item data-v-5f62c136" bindtap="__e"><text class="create-text data-v-5f62c136">{{"创建新班级 \""+classSearchKeyword+"\""}}</text></view></block><block wx:if="{{$root.g7}}"><view class="empty-class-tip data-v-5f62c136"><text class="empty-text data-v-5f62c136">暂无班级信息</text></view></block></view></view><view class="modal-footer data-v-5f62c136"><button data-event-opts="{{[['tap',[['closeClassModal',['$event']]]]]}}" class="cancel-btn data-v-5f62c136" bindtap="__e">取消</button><button data-event-opts="{{[['tap',[['confirmClasses',['$event']]]]]}}" class="confirm-btn data-v-5f62c136" bindtap="__e">确定</button></view></view></view></block><block wx:if="{{showScoreEditModal}}"><view data-event-opts="{{[['tap',[['closeScoreEditModal',['$event']]]]]}}" class="score-edit-modal data-v-5f62c136" bindtap="__e"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="score-edit-modal-content data-v-5f62c136" catchtap="__e"><view class="modal-header data-v-5f62c136"><text class="modal-title data-v-5f62c136">编辑成绩</text><view data-event-opts="{{[['tap',[['closeScoreEditModal',['$event']]]]]}}" class="close-btn data-v-5f62c136" bindtap="__e"><text class="close-icon data-v-5f62c136">×</text></view></view><view class="modal-body data-v-5f62c136"><view class="form-item data-v-5f62c136"><text class="label data-v-5f62c136">科目</text><picker class="picker data-v-5f62c136" value="{{editScoreData.subjectIndex}}" range="{{allSubjects}}" data-event-opts="{{[['change',[['onEditSubjectChange',['$event']]]]]}}" bindchange="__e"><view class="picker-text data-v-5f62c136">{{allSubjects[editScoreData.subjectIndex]||'请选择科目'}}</view></picker></view><view class="form-item data-v-5f62c136"><text class="label data-v-5f62c136">考试类型</text><picker class="picker data-v-5f62c136" value="{{editScoreData.examTypeIndex}}" range="{{examTypeOptions}}" data-event-opts="{{[['change',[['onEditExamTypeChange',['$event']]]]]}}" bindchange="__e"><view class="picker-text data-v-5f62c136">{{examTypeOptions[editScoreData.examTypeIndex]||'请选择考试类型'}}</view></picker></view><view class="form-item data-v-5f62c136"><text class="label data-v-5f62c136">考试成绩</text><input class="input data-v-5f62c136" type="number" placeholder="请输入成绩" data-event-opts="{{[['input',[['__set_model',['$0','score','$event',[]],['editScoreData']]]]]}}" value="{{editScoreData.score}}" bindinput="__e"/></view><view class="form-item data-v-5f62c136"><text class="label data-v-5f62c136">考试日期</text><input class="input data-v-5f62c136" type="date" placeholder="请选择考试日期" data-event-opts="{{[['input',[['__set_model',['$0','examDate','$event',[]],['editScoreData']]]]]}}" value="{{editScoreData.examDate}}" bindinput="__e"/></view><view class="form-item data-v-5f62c136"><text class="label data-v-5f62c136">备注</text><textarea class="textarea data-v-5f62c136" placeholder="备注信息（可选）" data-event-opts="{{[['input',[['__set_model',['$0','remark','$event',[]],['editScoreData']]]]]}}" value="{{editScoreData.remark}}" bindinput="__e"></textarea></view></view><view class="modal-footer data-v-5f62c136"><button data-event-opts="{{[['tap',[['closeScoreEditModal',['$event']]]]]}}" class="cancel-btn data-v-5f62c136" bindtap="__e">取消</button><button data-event-opts="{{[['tap',[['saveScore',['$event']]]]]}}" class="confirm-btn data-v-5f62c136" bindtap="__e">保存</button></view></view></view></block></view>