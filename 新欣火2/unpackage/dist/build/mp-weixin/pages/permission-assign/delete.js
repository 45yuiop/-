(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/permission-assign/delete"],{"3ade":function(e,t,n){},"6c23":function(e,t,n){"use strict";(function(e,r){var a=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=a(n("7eb4")),i=a(n("ee10")),c=a(n("5fe4")),s={data:function(){return{memberList:[],selectedMember:null,selectedMemberFeatures:[],featuresToDelete:[],deleteLoading:!1}},onShow:function(){this.initData()},methods:{goBack:function(){getCurrentPages().length>1?e.navigateBack():e.reLaunch({url:"/pages/home/home"})},initData:function(){var t=this;return(0,i.default)(u.default.mark((function n(){var a,i;return u.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.getStorageSync("userInfo"),n.next=3,r.callFunction({name:"user-center",data:{action:"get-accounts"}});case 3:i=n.sent,i.result&&200===i.result.code&&(t.memberList=i.result.data.filter((function(e){var t=e.role&&(Array.isArray(e.role)?e.role.includes("家长"):"家长"===e.role),n=e._id===a._id,r="普通用户"===e.permission;return!t&&!n&&r}))),t.selectedMember=null,t.selectedMemberFeatures=[],t.featuresToDelete=[];case 8:case"end":return n.stop()}}),n)})))()},onMemberChange:function(e){var t=this,n=e.detail.value;this.selectedMember=this.memberList[n],this.selectedMemberFeatures=c.default.filter((function(e){return Array.isArray(t.selectedMember.featureList)&&t.selectedMember.featureList.includes(e.key)})),this.featuresToDelete=this.selectedMemberFeatures.map((function(e){return String(e.key)}))},deleteFeatures:function(){var t=this;return(0,i.default)(u.default.mark((function n(){var a;return u.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.selectedMember){n.next=2;break}return n.abrupt("return");case 2:if(t.featuresToDelete.length){n.next=5;break}return e.showToast({title:"请选择要删除的功能",icon:"none"}),n.abrupt("return");case 5:return t.deleteLoading=!0,a=(t.selectedMember.featureList||[]).filter((function(e){return!t.featuresToDelete.includes(e)})),n.next=9,r.callFunction({name:"user-center",data:{action:"update-account",params:{id:t.selectedMember._id,featureList:a}}});case 9:n.sent,t.deleteLoading=!1,e.showToast({title:"删除成功",icon:"success"}),t.initData();case 13:case"end":return n.stop()}}),n)})))()},goToIndex:function(){e.reLaunch({url:"/pages/permission-assign/index"})}}};t.default=s}).call(this,n("df3c")["default"],n("861b")["uniCloud"])},"722c":function(e,t,n){"use strict";(function(e,t){var r=n("47a9");n("a226"),n("861b");r(n("3240"));var a=r(n("d3a0"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"76db":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var r=function(){var e=this,t=e.$createElement,n=(e._self._c,e.selectedMember?e.__map(e.selectedMemberFeatures,(function(t,n){var r=e.__get_orig(t),a=String(t.key);return{$orig:r,m0:a}})):null);e.$mp.data=Object.assign({},{$root:{l0:n}})},a=[]},"83c9":function(e,t,n){"use strict";var r=n("3ade"),a=n.n(r);a.a},c82d:function(e,t,n){"use strict";n.r(t);var r=n("6c23"),a=n.n(r);for(var u in r)["default"].indexOf(u)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(u);t["default"]=a.a},d3a0:function(e,t,n){"use strict";n.r(t);var r=n("76db"),a=n("c82d");for(var u in a)["default"].indexOf(u)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(u);n("83c9");var i=n("828b"),c=Object(i["a"])(a["default"],r["b"],r["c"],!1,null,"db1c047a",null,!1,r["a"],void 0);t["default"]=c.exports}},[["722c","common/runtime","common/vendor"]]]);